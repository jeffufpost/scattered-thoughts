<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>scattered-thoughts - “Epidemic modeling - Part 1”</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">scattered-thoughts</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.linkedin.com/in/jeffrey-post-6591ab42" rel="" target="">
 <span class="menu-text"><i class="fa-brands fa-linkedin-in" aria-label="linkedin-in"></i></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https:/github.com/jeffufpost" rel="" target="">
 <span class="menu-text"><i class="fa-brands fa-github" aria-label="github"></i></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://renkulab.io/gitlab/jeffrey.post" rel="" target="">
 <span class="menu-text"><i class="fa-brands fa-gitlab" aria-label="gitlab"></i></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="mailto:contact@jeffreypost.dev" rel="" target="">
 <span class="menu-text"><i class="fa-solid fa-envelope" aria-label="envelope"></i></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">“Epidemic modeling - Part 1”</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<blockquote class="blockquote">
<p>“Compartmentalization models and disease dynamics”</p>
</blockquote>
<ul>
<li>toc: true</li>
<li>badges: true</li>
<li>comments: true</li>
<li>categories: [modeling, compartmentalization, SEIR, epidemiology, disease dynamics]</li>
<li>image: images/compartmentalization.jpg</li>
</ul>
<p><img src="https://github.com/jeffufpost/scattered-thoughts/blob/master/_notebooks/my_icons/compartmentalization.jpg?raw=1" class="img-fluid"></p>
<section id="motivation-for-write-up" class="level2">
<h2 class="anchored" data-anchor-id="motivation-for-write-up">Motivation for write-up</h2>
<p>This is the 1st part of a multi-part series blog post on modeling in epidemiology.</p>
<p>The COVID-19 pandemic has brought a lot of attention to the study of epidemiology and more specifically to the various mathematical models that are used to inform public health policies. Everyone has been trying to understand the growth or slowing of new cases and trying to predict the necessary sanitary resources. This blog post attempts to explain the foundations for some of the most used models and enlighten the reader on a few important points.</p>
<p>In this first post I want to introduce the concept of compartmentalization and how it forms the basis for studying disease dynamics on the population level.</p>
</section>
<section id="how-to-model-infectious-diseases-on-population-level" class="level2">
<h2 class="anchored" data-anchor-id="how-to-model-infectious-diseases-on-population-level">How to model infectious diseases on population level ?</h2>
<section id="compartments" class="level3">
<h3 class="anchored" data-anchor-id="compartments">Compartments</h3>
<p>When modelling infectious diseases, and pandemics in particular, a key ask is to predict the number of infected people at any given time in order to estimate the sanitary resources that will be necessary.</p>
<p>From this simple qestion results the idea of compartmentalization of the population i.e.&nbsp;the division of the population into the two most basic categories:</p>
<ul>
<li>those that are infected</li>
<li>those that are not</li>
</ul>
<p>This is ultimately the foundation for all compartmental models in epidemiology.</p>
<p>The nuances between the models then come from how the above two groups are further compartmentalized. That is to say, how we decide the composition of the infected and the not-infected groups.</p>
<p>For example, the non-infected group could be further sub-categorized into: * Susceptible * Immune</p>
<p>And the infected group into: * Asymptomatic * Symptomatic</p>
<p>Or, another option, into: * No treatment necessary * Require treatment: * Local Doctor visit * Hospitalization * Admitted to intensive care unit</p>
<p>As you can see there are many ways to do this, but the more categories you have, the more difficult it might become to model. Usually we determine these subcategories in order to match available data.</p>
</section>
<section id="dynamics" class="level3">
<h3 class="anchored" data-anchor-id="dynamics">Dynamics</h3>
<p>While the compartments describe the state any individual can be in at a certain point in time, the dynamics describe the ways in which the compartments interact with each other.</p>
<p>I want to underline the separation between disease dynamics on the individual level, and that on the population level below.</p>
<ul>
<li><strong>Individual level disease dynamics:</strong></li>
</ul>
<p>This describes, on the individual level, the progression of the disease i.e.&nbsp;how one person can go from one state to another (one compartment to another)</p>
<p>For example: how does a healthy person become ill and what is the clinical course of the disease for this person?</p>
<ul>
<li><strong>Population-level dynamics:</strong></li>
</ul>
<p>On the other hand, the population level dynamics describe, on a population level, how the total number of individuals in each compartment vary over time.</p>
<p>We will see more on this in the next blog posts.</p>
</section>
<section id="two-simple-examples---the-sir-and-seir-models" class="level3">
<h3 class="anchored" data-anchor-id="two-simple-examples---the-sir-and-seir-models">Two simple examples - the SIR and SEIR models</h3>
<p>Let’s have a look at a basic compartmental model, first the SIR model.</p>
<ul>
<li><strong>S –&gt; Susceptible state:</strong></li>
</ul>
<p>An S individual is simply someone susceptible to the disease, that is anyone in the population who is healthy and not immune to the disease.</p>
<ul>
<li><strong>I –&gt; Infectious state:</strong></li>
</ul>
<p>Once an individual is exposed to the disease he will develop this disease and become infectious.</p>
<ul>
<li><strong>R –&gt; Recovered state:</strong></li>
</ul>
<p>An individual will either fight off the infection (with the help or not of treatment) or die. These are all included in the R state.</p>
<p>In the basic SIR model, anyone R has aquired full and infinite immunity and cannot catch the disease again (of course many variations can be included to reflect more closely a disease).</p>
<p>In this write-up and in the following blog posts we will focus on the SEIR models, which are similar to the SIR compartments above with the additional E state between S and I.</p>
<ul>
<li><strong>E –&gt; Exposed state:</strong></li>
</ul>
<p>The exposed state is the state when an individual has been exposed to the disease, but has not become infectious yet.</p>
</section>
<section id="some-important-vocabulary" class="level3">
<h3 class="anchored" data-anchor-id="some-important-vocabulary">Some important vocabulary</h3>
<ul>
<li><span class="math inline">\(\underline{Infectious\ period:}\)</span></li>
</ul>
<p>Also called the period of communicability, the infectious period is the time during which an individual can transmit the disease to another: <span class="math inline">\(T_{Infectious}\)</span></p>
<ul>
<li><span class="math inline">\(\underline{Clinical\ infection\ period:}\)</span></li>
</ul>
<p>This period corresponds to the period where the infected indvidual shows symptoms: <span class="math inline">\(T_{Clinical}\)</span></p>
<ul>
<li><span class="math inline">\(\underline{Latent\ period:}\)</span></li>
</ul>
<p>The latent period is the time between exposure of an individual and the start of the period of communicability of that individual: <span class="math inline">\(T_{Latent}\)</span></p>
<ul>
<li><span class="math inline">\(\underline{Incubation\ period:}\)</span></li>
</ul>
<p>The incubation period on the other hand, is the time from exposure of an individual to development of the infection (appearance of disease): <span class="math inline">\(T_{Incubation}\)</span></p>
<p><em>It should be noted the latent period and incubation period are not necessarily the same.</em></p>
<ul>
<li><span class="math inline">\(\underline{T_{Latent} &lt; T_{Incubation}}\)</span>:</li>
</ul>
<p>In this case, an individual who has been exposed becomes infectious before the development of disease.</p>
<p>We call this a <strong>subclinical infection</strong> and during that time the individual is called an <strong>asymptomatic carrier</strong>.</p>
<ul>
<li><span class="math inline">\(\underline{T_{Latent} &gt; T_{Incubation}:}\)</span></li>
</ul>
<p>In other cases, the latent period can be longer than the incubation period, eg: smallpox.</p>
<ul>
<li><span class="math inline">\(\underline{T_{Latent} + T_{Infectious} &gt; T_{Incubation} + T_{Clinical}:}\)</span></li>
</ul>
<p>Another case of <strong>subclinical infection</strong> resulting in <strong>asymptomatic carriers</strong> occurs when the end of clinical infection (of disease) happens earlier than the end of the period of communicability (see Wikipedia figure below)</p>
<p>Overall, these asymptomatic carriers can be a significant difficutly to overcome epidemics.</p>
<p><img src="my_icons/Concept_of_incubation_period.svg" title="Wikipedia" class="img-fluid"></p>
<ul>
<li><span class="math inline">\(\underline{Basic\ reproduction\ number:}\)</span></li>
</ul>
<p>The basic reproduction number <span class="math inline">\(R_0\)</span> is the measure of secondary infections in a susceptible population.</p>
<p>In other words, it is the number of people that each infectious individual will infect over the time of their infectious period.</p>
<p>Example:</p>
<p>If an infectious individual infects 3 other individuals over the course of his infection, his <span class="math inline">\(R_0\)</span> is 3.</p>
<p>This number is a very important element in the spreading dynamics (see derivation below).</p>
</section>
</section>
<section id="a-closer-look-at-the-seir-model" class="level2">
<h2 class="anchored" data-anchor-id="a-closer-look-at-the-seir-model">A closer look at the SEIR model</h2>
<section id="individual-level-disease-dynamic" class="level3">
<h3 class="anchored" data-anchor-id="individual-level-disease-dynamic">Individual-level disease dynamic</h3>
<p>As explained above, the individual-level disease dynamic describes the progression of disease within an individual i.e.&nbsp;the progression of an individual from one state to another.</p>
<ul>
<li><p>In the models used here (SEIR model), an individual starts at S (although an initial exposed or infectious person is injected into the population at time t=0).</p></li>
<li><p>If exposed to the disease he will move into the state E.</p></li>
<li><p>After which he will move to the I state with probability 1, but in a time unique to himself.</p></li>
<li><p>Again after which he will move into the state R with probability 1, and again in a time unique to him.</p></li>
<li><p>From state R he will stay in state R (either dead or has aquired full and inifite immunity).</p></li>
</ul>
<p>Let’s have a closer look:</p>
<section id="s-e" class="level4">
<h4 class="anchored" data-anchor-id="s-e">S → E</h4>
<p>The chances of an individual going from S → E depends on three things: 1. the number of contacts the person has per unit time (given by <span class="math inline">\(r\)</span>) 2. the chance a given contact is with an I - infectious individual (the higher the number of I in the population, the higher the chance) 3. the chance of an S contracting the disease from a contact with an I (given by <span class="math inline">\(\rho\)</span>)</p>
</section>
<section id="e-i" class="level4">
<h4 class="anchored" data-anchor-id="e-i">E → I</h4>
<p><em>The latent period</em></p>
<p>All people exposed will eventually develop disease.</p>
<p>However, individually, a person might go from E to I on the first day, or after 10 days, this is unique to the individual.</p>
<p>Every additional day following exposure the probability of this individual to go from E → I increases (we will have a look at the probability distribution and its importance later).</p>
</section>
<section id="i-r" class="level4">
<h4 class="anchored" data-anchor-id="i-r">I → R</h4>
<p><em>The period of communicability</em></p>
<p>Similarly, all infectious people will recover (or die).</p>
<p>Again, individually, a person might go from I to R in 5 days or in 15 days, this time is the recovery time and is proper to the individual.</p>
</section>
</section>
<section id="population-level-dynamics" class="level3">
<h3 class="anchored" data-anchor-id="population-level-dynamics">Population level dynamics</h3>
<p>Most basic models tend to disregard the notion of individual dynamics above in favor of poopulation level dynamics.</p>
<p>That is to say the models tend to model disease on a population level without looking at the specific pogression of disease within the individuals and using averages instead (although the S → E uses the same logic as above).</p>
<p>Below is an explanation for such an SEIR model with its mathematical formulation.</p>
<p>Note no births or deaths are included.</p>
<section id="s-e-1" class="level4">
<h4 class="anchored" data-anchor-id="s-e-1">S → E</h4>
<p>As stated above, going from S to E on a particular day depends on these three characteristics: * the proportion of infectious people in the population on that day: <span class="math inline">\(i(t) = \frac{I(t)}{N}\)</span> * the number of contacts an individual has per day: <span class="math inline">\(r\)</span> * the chance for an S to contract the disease after contact with an I: <span class="math inline">\(\rho\)</span></p>
<p>We can combine the last two into <span class="math inline">\(\beta = r \rho\)</span></p>
<p>On a population-level however, the number of S that will become E also depends on the proportion of S in the population (of course if there are no S, no one will become E of course).</p>
<p>So we add the following requirement: * the proportion of susceptible people in the population on that day: <span class="math inline">\(s(t) = \frac{S(t)}{N}\)</span></p>
<p>So the change in the number of S in a population on a given day is equal to:</p>
<p><span class="math inline">\(- \beta i(t) s(t)\)</span></p>
<p>(note the negative sign to indicate the number of S is diminishing as they become exposed)</p>
<p>Hence we can formulate this mathematically as follows:</p>
<ul>
<li>Discrete-time: <span class="math display">\[\Delta S = -\beta I S\Delta T\]</span></li>
<li>Continuous-time: <span class="math display">\[\frac{ds(t)}{dt}=-\beta i(t) s(t)\]</span></li>
</ul>
</section>
<section id="e-i-1" class="level4">
<h4 class="anchored" data-anchor-id="e-i-1">E → I</h4>
<p>We have seen above how each individual goes from E to I.</p>
<p>On a population level, the number of E changes in two ways: * new additions following S → E * reduction following E → I</p>
<p>We already know the number from S → E is:</p>
<p><span class="math display">\[\beta i(t) s(t)\]</span></p>
<p>So how can we model the number of E → I?</p>
<p>While individually this is a bit more complicated to model and pertains to the specific probability distribution of the latent period, on a population level we can use the average time it takes - this is what most models do (part 3 of this blog post will show why this is wrong for COVID-19).</p>
<p>Let’s say average latent period is</p>
<p><span class="math display">\[\frac{1}{\sigma}\]</span></p>
<p>then we know that every unit time that goes by, we have</p>
<p><span class="math display">\[\sigma E\]</span></p>
<p>individuals that transition from E → I.</p>
<p>Mathematically, we write this as : * Discrete-time: <span class="math display">\[\Delta E = (\beta I S-\sigma E) \Delta T\]</span> * Continuous-time: <span class="math display">\[\frac{de(t)}{dt}=\beta i(t) s(t) - \sigma e(t)\]</span></p>
</section>
<section id="i-r-1" class="level4">
<h4 class="anchored" data-anchor-id="i-r-1">I → R</h4>
<p>Similarly as above, we have seen above how each individual goes from I to R but this does not tell us about the population level dynamics.</p>
<p>On a population level, the number of I changes in two ways: * new additions following E → I * reduction following I → R</p>
<p>We know the number from E → I is:</p>
<p><span class="math display">\[\sigma e(t)\]</span></p>
<p>How can we model the number of I → R?</p>
<p>Again, while individually this is complicated, on a population level, how about averaging out the period of infectiousness, this is what most models do.</p>
<p>Let’s say average time of infectiousness is</p>
<p><span class="math display">\[\frac{1}{\gamma}\]</span></p>
<p>Then we have: * Discrete-time: <span class="math display">\[\Delta I = (\sigma E - \gamma I) \Delta T\]</span> * Continuous-time: <span class="math display">\[\frac{di(t)}{dt}=\sigma e(t) - \gamma i(t)\]</span></p>
</section>
<section id="r-r" class="level4">
<h4 class="anchored" data-anchor-id="r-r">R → R</h4>
<p>Finally, it is simple to model the number of individuals in R state with the following equation: * Discrete-time: <span class="math display">\[\Delta R = \gamma I \Delta T\]</span> * Continuous-time: <span class="math display">\[\frac{dr(t)}{dt}=\gamma i(t)\]</span></p>
</section>
</section>
</section>
<section id="effective-and-basic-reproduction-numbers-r-and-r_0-respectively" class="level2">
<h2 class="anchored" data-anchor-id="effective-and-basic-reproduction-numbers-r-and-r_0-respectively">Effective and Basic Reproduction Numbers: <span class="math inline">\(R\)</span> and <span class="math inline">\(R_0\)</span> respectively</h2>
<p><em>As stated above, <span class="math inline">\(R_0\)</span> is the measure of secondary infections. Let’s have a look how we can characterize it.</em></p>
<section id="understanding-how-the-infection-spreads" class="level3">
<h3 class="anchored" data-anchor-id="understanding-how-the-infection-spreads">Understanding how the infection spreads</h3>
<p>Any individual in state I (infectious) will contaminate others according to the following: * Number of contacts the individual has per day given by: <span class="math inline">\(r_i\)</span> * Probability to infect an S after contact given by: <span class="math inline">\(\rho_i\)</span> * Probability of a contact being with an S given by: <span class="math inline">\(\frac{S(t)}{N} = s(t)\)</span> * The period of infectiousness of the individual given by [<span class="math inline">\(j_i, j_i+\frac{1}{\tau_i}\)</span>] (where <span class="math inline">\(j_i\)</span> is the first day of infectiousness for that individual and <span class="math inline">\(\frac{1}{\tau_i}\)</span> is that individuals’ time of infectiousness)</p>
<p>Remember <span class="math inline">\(r_i\rho_i=\beta_i\)</span></p>
</section>
<section id="derivation-of-r-for-each-individual" class="level3">
<h3 class="anchored" data-anchor-id="derivation-of-r-for-each-individual">Derivation of <span class="math inline">\(R\)</span> for each individual</h3>
<p>Let’s call the measure of <span class="math inline">\(R\)</span> for any individual <span class="math inline">\(R_i\)</span>.</p>
<p>From the parameters above we can write <span class="math inline">\(R_i\)</span> for each infectious individual as the sum of secondary infections per day of infectiousness as below: * Discrete-time: <span class="math display">\[R_i = \sum_{Day=j_i}^{j_i+\frac{1}{\tau_i}} \beta_i \frac{S(Day)}{N}\]</span> *Continuous-time: <span class="math display">\[R_i = \int_{j_i}^{j_i+\frac{1}{\tau_i}} \beta_i s(t) dt\]</span></p>
</section>
<section id="finding-r_0-of-each-individual-by-making-assumptions" class="level3">
<h3 class="anchored" data-anchor-id="finding-r_0-of-each-individual-by-making-assumptions">Finding <span class="math inline">\(R_0\)</span> of each individual by making assumptions</h3>
<p><span class="math inline">\(R_{0,i}\)</span> is the measure of <span class="math inline">\(R_i\)</span> in a susceptible population, i.e.&nbsp;when: <span class="math display">\[S = N\]</span></p>
<p>In other words: <span class="math display">\[R_{0,i} = R_i ~ \frac{N}{S}\]</span></p>
<p>If we make the following assumptions: * s(t) is constant over the course of infectiousness of an individual: <span class="math display">\[s(t) = s(t+\frac{1}{\tau_i})\]</span> * <span class="math inline">\(\beta_i\)</span> is a constant and does not vary over the course of time (no control measures)</p>
<p>Then the equation for <span class="math inline">\(R_{0,i}\)</span> reduces to the following: <span class="math display">\[R_{0,i} = [\beta_i]_{j_i}^{j_i+\frac{1}{\tau_i}} = \frac{\beta_i}{\tau_i}\]</span></p>
<p>We can see the basic reproduction number of an individual is fully characterized by the <span class="math inline">\(\beta_i\)</span> and the <span class="math inline">\(\tau_i\)</span> of that individual.</p>
</section>
<section id="r_0-for-a-population" class="level3">
<h3 class="anchored" data-anchor-id="r_0-for-a-population"><span class="math inline">\(R_0\)</span> for a population</h3>
<p>To a generalize to a population-level, we can simply find the expected value for the equation above: <span class="math display">\[R_0 = E[R_{0,i}] = \frac{E[\beta_i]}{E[\tau_i]}\]</span></p>
<p>Assuming: * <span class="math inline">\(E[\beta_i] = \beta\)</span> * <span class="math inline">\(E[\tau_i] = \gamma\)</span></p>
<p>We can write: <span class="math display">\[R_0 = \frac{\beta}{\gamma}\]</span></p>
</section>
</section>
<section id="herd-immunity" class="level2">
<h2 class="anchored" data-anchor-id="herd-immunity">Herd Immunity</h2>
<p><em>As just described, <span class="math inline">\(R\)</span> is the measure of secondary infections, and <span class="math inline">\(R_0\)</span> is the measure of secondary infections in a susceptible population where <span class="math inline">\(R=R_0~s(t)\)</span>.</em></p>
<p>It is easy to understand that if each infectious individual contaminates less than 1 other individual on average (<span class="math inline">\(R &lt; 1\)</span>) then the number of exposed, and eventually infectious, individuals will diminish and tend to 0.</p>
<p>On the other hand, if each infectious individual contaminates more than 1 other individual (<span class="math inline">\(R &gt; 1\)</span>) then the number of infectious individuals will rise (chance of epidemic).</p>
<p><strong>Mathematical formulation:</strong></p>
<p><span class="math display">\[\frac{d~e(t)}{dt} = \beta~i(t)~s(t) - \gamma~i(t)\]</span> <span class="math display">\[\leftrightarrow\frac{d~e(t)}{dt} = R_0~\gamma~i(t)~s(t) - \gamma~i(t)\]</span> <span class="math display">\[\leftrightarrow\frac{d~e(t)}{dt} = \gamma~i(t)~(R_0~s(t) - 1)=\gamma~i(t)~(R - 1)\]</span></p>
<p>And so we find that in a population where <span class="math inline">\(\gammaĩ(t)&gt;0\)</span>: <span class="math display">\[\frac{d~e(t)}{dt} = 0\]</span> <span class="math display">\[\leftrightarrow R-1 = 0\]</span> <span class="math display">\[\leftrightarrow R = 1\]</span></p>
<p>If <span class="math inline">\(R&lt;1\)</span> then <span class="math inline">\(\frac{d~e(t)}{dt} &lt; 0\)</span></p>
<p><strong>Herd immunity threshold:</strong></p>
<p>The herd immunity threshold is the point at which enough of the population is immune to the disease (not susceptible) in order to have <span class="math inline">\(R &lt; 1\)</span> and can be calculated as follows: <span class="math display">\[R = R_0 ~ s(t)\]</span></p>
<p>We know the proportion of the population immune to the disease is: <span class="math display">\[Immune(t) = 1-s(t)\]</span> <span class="math display">\[\leftrightarrow\ s(t)=1-Immune(t)\]</span></p>
<p>The threshold of <span class="math inline">\(R = 1\)</span> is achieved when: <span class="math display">\[R_0 ~s(t) = 1\]</span> <span class="math display">\[\leftrightarrow\ R_0 ~(1-Immune(t)) = 1\]</span> <span class="math display">\[\leftrightarrow\ 1-Immune(t) = \frac{1}{R_0}\]</span> <span class="math display">\[\leftrightarrow\ Immune(t) = 1-\frac{1}{R_0}\]</span></p>
<p>When the proportion of immune individuals in a population reaches <span class="math inline">\(1-\frac{1}{R_0}\)</span> then <span class="math inline">\(R\)</span> will become smaller than 1 and the number of infectious individuals will diminish and tend to 0.</p>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>This was a brief introduction to compartmentalization models and the dynamics associated with them.</p>
<p>Of course these sort of derivations can be done for many different types of comprtaments and their relevant dynamics, but the SEIR is simple enough to understand and model quickly.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>