<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jeffrey Post">
<meta name="dcterms.date" content="2020-04-02">
<meta name="description" content="Convolution, deconvolution, and daily data">

<title>Scattered Thoughts - Epidemic modeling - Part 7</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script type="text/javascript">

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-166290391-2', 'auto');

ga('send', {
  hitType: 'pageview',
  'anonymizeIp': true,
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Scattered Thoughts</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.linkedin.com/in/jeffrey-post-6591ab42" rel="" target="">
 <span class="menu-text"><i class="fa-brands fa-linkedin-in" aria-label="linkedin-in"></i></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https:/github.com/jeffufpost" rel="" target="">
 <span class="menu-text"><i class="fa-brands fa-github" aria-label="github"></i></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://renkulab.io/gitlab/jeffrey.post" rel="" target="">
 <span class="menu-text"><i class="fa-brands fa-gitlab" aria-label="gitlab"></i></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="mailto:contact@jeffreypost.dev" rel="" target="">
 <span class="menu-text"><i class="fa-solid fa-envelope" aria-label="envelope"></i></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Epidemic modeling - Part 7</h1>
                  <div>
        <div class="description">
          Convolution, deconvolution, and daily data
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">modeling</div>
                <div class="quarto-category">SEIR</div>
                <div class="quarto-category">epidemiology</div>
                <div class="quarto-category">stochastic</div>
                <div class="quarto-category">COVID-19</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Jeffrey Post </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">April 2, 2020</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#motivation-for-write-up" id="toc-motivation-for-write-up" class="nav-link active" data-scroll-target="#motivation-for-write-up">Motivation for write-up</a></li>
  <li><a href="#available-data" id="toc-available-data" class="nav-link" data-scroll-target="#available-data">Available data</a></li>
  <li><a href="#convolution" id="toc-convolution" class="nav-link" data-scroll-target="#convolution">Convolution</a>
  <ul>
  <li><a href="#convolution-to-get-i_pd" id="toc-convolution-to-get-i_pd" class="nav-link" data-scroll-target="#convolution-to-get-i_pd">Convolution to get <span class="math inline">\(I_{pd}\)</span></a></li>
  <li><a href="#convolution-to-get-r_pd" id="toc-convolution-to-get-r_pd" class="nav-link" data-scroll-target="#convolution-to-get-r_pd">Convolution to get <span class="math inline">\(R_{pd}\)</span></a></li>
  </ul></li>
  <li><a href="#finding-h_lj-and-h_ij" id="toc-finding-h_lj-and-h_ij" class="nav-link" data-scroll-target="#finding-h_lj-and-h_ij">Finding <span class="math inline">\(h_L[j]\)</span> and <span class="math inline">\(h_I[j]\)</span></a></li>
  <li><a href="#convolution-in-practice" id="toc-convolution-in-practice" class="nav-link" data-scroll-target="#convolution-in-practice">Convolution in practice</a>
  <ul>
  <li><a href="#comparing-i_pd-from-the-model-to-i_pd-obtained-by-convolving-r_pd" id="toc-comparing-i_pd-from-the-model-to-i_pd-obtained-by-convolving-r_pd" class="nav-link" data-scroll-target="#comparing-i_pd-from-the-model-to-i_pd-obtained-by-convolving-r_pd">Comparing <span class="math inline">\(I_{pd}\)</span> from the model to <span class="math inline">\(I_{pd}\)</span> obtained by convolving <span class="math inline">\(R_{pd}\)</span></a></li>
  <li><a href="#comparing-r_pd-from-the-model-to-r_pd-obtained-by-convolving-i_pd" id="toc-comparing-r_pd-from-the-model-to-r_pd-obtained-by-convolving-i_pd" class="nav-link" data-scroll-target="#comparing-r_pd-from-the-model-to-r_pd-obtained-by-convolving-i_pd">Comparing <span class="math inline">\(R_{pd}\)</span> from the model to <span class="math inline">\(R_{pd}\)</span> obtained by convolving <span class="math inline">\(I_{pd}\)</span></a></li>
  </ul></li>
  <li><a href="#de-convolution" id="toc-de-convolution" class="nav-link" data-scroll-target="#de-convolution">De-convolution</a>
  <ul>
  <li><a href="#problems-with-de-convolution" id="toc-problems-with-de-convolution" class="nav-link" data-scroll-target="#problems-with-de-convolution">Problems with de-convolution</a></li>
  <li><a href="#solutions-to-these-problems" id="toc-solutions-to-these-problems" class="nav-link" data-scroll-target="#solutions-to-these-problems">Solutions to these problems</a>
  <ul>
  <li><a href="#iterative-deconvoluton" id="toc-iterative-deconvoluton" class="nav-link" data-scroll-target="#iterative-deconvoluton">Iterative deconvoluton</a></li>
  <li><a href="#low-pass-filter" id="toc-low-pass-filter" class="nav-link" data-scroll-target="#low-pass-filter">Low-pass filter</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#deconvolution-in-practice" id="toc-deconvolution-in-practice" class="nav-link" data-scroll-target="#deconvolution-in-practice">Deconvolution in practice</a>
  <ul>
  <li><a href="#coding-the-iterative-deconvolution" id="toc-coding-the-iterative-deconvolution" class="nav-link" data-scroll-target="#coding-the-iterative-deconvolution">Coding the iterative deconvolution</a></li>
  <li><a href="#comparing-e_pd-from-the-model-to-e_pd-obtained-by-de-convolving-i_pd" id="toc-comparing-e_pd-from-the-model-to-e_pd-obtained-by-de-convolving-i_pd" class="nav-link" data-scroll-target="#comparing-e_pd-from-the-model-to-e_pd-obtained-by-de-convolving-i_pd">Comparing <span class="math inline">\(E_{pd}\)</span> from the model to <span class="math inline">\(E_{pd}\)</span> obtained by de-convolving <span class="math inline">\(I_{pd}\)</span></a></li>
  <li><a href="#comparing-i_pd-from-the-model-to-i_pd-obtained-by-de-convolving-r_pd" id="toc-comparing-i_pd-from-the-model-to-i_pd-obtained-by-de-convolving-r_pd" class="nav-link" data-scroll-target="#comparing-i_pd-from-the-model-to-i_pd-obtained-by-de-convolving-r_pd">Comparing <span class="math inline">\(I_{pd}\)</span> from the model to <span class="math inline">\(I_{pd}\)</span> obtained by de-convolving <span class="math inline">\(R_{pd}\)</span></a></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion">Discussion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p><img src="../images/kalman_filter.jpg" class="img-fluid"></p>
<div class="cell" data-outputid="563f3343-0fad-4458-f487-eee3d488f648" data-execution_count="41">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> signal</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> expon</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> gamma</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> weibull_min</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy.random <span class="im">import</span> default_rng</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> default_rng()</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's build a numerical solution</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> seir_model(init, parms, days):</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    S_0, E_0, I_0, R_0 <span class="op">=</span> init</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    Epd, Ipd, Rpd <span class="op">=</span> [<span class="dv">0</span>], [<span class="dv">0</span>], [<span class="dv">0</span>]</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    S, E, I, R <span class="op">=</span> [S_0], [E_0], [I_0], [R_0]</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    dt<span class="op">=</span><span class="fl">0.1</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> np.linspace(<span class="dv">0</span>,days,<span class="bu">int</span>(days<span class="op">/</span>dt))</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    sigma, beta, gam <span class="op">=</span> parms</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> t[<span class="dv">1</span>:]:</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>        next_S <span class="op">=</span> S[<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> beta<span class="op">*</span>S[<span class="op">-</span><span class="dv">1</span>]<span class="op">*</span>I[<span class="op">-</span><span class="dv">1</span>]<span class="op">*</span>dt</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>        Epd.append(beta<span class="op">*</span>S[<span class="op">-</span><span class="dv">1</span>]<span class="op">*</span>I[<span class="op">-</span><span class="dv">1</span>]<span class="op">*</span>dt)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>        next_E <span class="op">=</span> E[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> (beta<span class="op">*</span>S[<span class="op">-</span><span class="dv">1</span>]<span class="op">*</span>I[<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> sigma<span class="op">*</span>E[<span class="op">-</span><span class="dv">1</span>])<span class="op">*</span>dt</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>        Ipd.append(sigma<span class="op">*</span>E[<span class="op">-</span><span class="dv">1</span>]<span class="op">*</span>dt)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>        next_I <span class="op">=</span> I[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> (sigma<span class="op">*</span>E[<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> gam<span class="op">*</span>I[<span class="op">-</span><span class="dv">1</span>])<span class="op">*</span>dt</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>        Rpd.append(gam<span class="op">*</span>I[<span class="op">-</span><span class="dv">1</span>]<span class="op">*</span>dt)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        next_R <span class="op">=</span> R[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> (gam<span class="op">*</span>I[<span class="op">-</span><span class="dv">1</span>])<span class="op">*</span>dt</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>        S.append(next_S)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>        E.append(next_E)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>        I.append(next_I)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>        R.append(next_R)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.stack([S, E, I, R, Epd, Ipd, Rpd]).T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="42">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Need this new function for model below:</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> make_df(p,num_E, num_I, num_R):</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  df <span class="op">=</span> pd.DataFrame(np.full((p,<span class="dv">1</span>), <span class="st">'S'</span>).T[<span class="dv">0</span>], columns<span class="op">=</span>[<span class="st">'State'</span>])</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">'Day'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  tochange<span class="op">=</span>df.loc[rng.choice(p, size<span class="op">=</span>num_E<span class="op">+</span>num_I<span class="op">+</span>num_R, replace<span class="op">=</span><span class="va">False</span>),<span class="st">'State'</span>].index</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  df.loc[tochange[<span class="dv">0</span>:num_E],<span class="st">'State'</span>] <span class="op">=</span> <span class="st">'E'</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  df.loc[tochange[num_E:num_I<span class="op">+</span>num_E],<span class="st">'State'</span>] <span class="op">=</span> <span class="st">'I'</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  df.loc[tochange[num_E<span class="op">+</span>num_I:num_E<span class="op">+</span>num_I<span class="op">+</span>num_R],<span class="st">'State'</span>] <span class="op">=</span> <span class="st">'R'</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="55">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> seir_model_stoch(beta, p, num_E, num_I, num_R, days):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize population dataframe with data given by user</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> make_df(p,num_E, num_I, num_R)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This variable is used to track daily value of beta if it varies over time</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    xxbeta<span class="op">=</span>np.array([],dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize the arrays to return</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Below are numbers of S, E, I, R total</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    S<span class="op">=</span>np.array([],dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    E<span class="op">=</span>np.array([],dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    I<span class="op">=</span>np.array([],dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    R<span class="op">=</span>np.array([],dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Below are the daily additions in S, E, I, R</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    Spd<span class="op">=</span>np.array([],dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    Epd<span class="op">=</span>np.array([],dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    Ipd<span class="op">=</span>np.array([],dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    Rpd<span class="op">=</span>np.array([],dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    b<span class="op">=</span>beta</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Stochastic model so use random values to decide on progression</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    rand <span class="op">=</span> np.random.random(size<span class="op">=</span>(p,days))</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Depending if you want exponential or gamma distribution for T_Latent</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    EtoI <span class="op">=</span> gamma.rvs(<span class="fl">1.8</span>,loc<span class="op">=</span><span class="fl">0.9</span>,scale<span class="op">=</span>(<span class="fl">5.2</span><span class="op">-</span><span class="fl">1.8</span>)<span class="op">/</span><span class="fl">0.9</span>,size<span class="op">=</span>p)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Depending if you want exponential, gamma, or Weibull distribution for T_Infectious</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Uses distributions found on blog part 3</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    ItoR <span class="op">=</span> weibull_min.rvs(<span class="fl">2.3</span>, loc<span class="op">=</span><span class="dv">2</span>, scale<span class="op">=</span><span class="fl">20.11</span>, size<span class="op">=</span>p)</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Iterate over every day the simulation is run</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,days<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Record daily beta values</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>        xxbeta<span class="op">=</span>np.append(beta, b)</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>        <span class="co"># First we get the index of the individuals that will change state today:</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Random number tells you which 'S' have been exposed on this day </span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>        StoE_index <span class="op">=</span> df.loc[(df.State <span class="op">==</span> <span class="st">'S'</span>) <span class="op">&amp;</span> (rand[:,j] <span class="op">&lt;</span> b[j]<span class="op">*</span><span class="bu">len</span>(np.where(df.State<span class="op">==</span><span class="st">'I'</span>)[<span class="dv">0</span>])<span class="op">/</span>p)].index</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>        <span class="co"># For each row, if a person has been a certain number of days in E, they will go to I</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>        <span class="co"># This follows EtoI variable which is either exponential or gamma distributed according to above</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>        EtoI_index <span class="op">=</span> df.loc[(df.State <span class="op">==</span> <span class="st">'E'</span>) <span class="op">&amp;</span> (j<span class="op">-</span>df.Day <span class="op">&gt;=</span> EtoI)].index</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Similaraly as above</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>        <span class="co"># For each row, if a person has been a certain number of days in I, they will go to R</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>        <span class="co"># This follows EtoI variable which is either exponential or gamma distributed according to above</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>        ItoR_index <span class="op">=</span> df.loc[(df.State <span class="op">==</span> <span class="st">'I'</span>) <span class="op">&amp;</span> (j<span class="op">-</span>df.Day <span class="op">&gt;=</span> ItoR)].index</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Use indexes collected above to populate per day values</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>        Epd <span class="op">=</span> np.append(Epd,<span class="bu">len</span>(StoE_index))</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>        Ipd <span class="op">=</span> np.append(Ipd,<span class="bu">len</span>(EtoI_index))</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>        Rpd <span class="op">=</span> np.append(Rpd,<span class="bu">len</span>(ItoR_index))</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Now we use the indexes collected above randomly to change the actual population dataframe to the new states</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>        df.loc[ItoR_index, <span class="st">'State'</span>] <span class="op">=</span> <span class="st">'R'</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>        df.loc[EtoI_index, <span class="st">'State'</span>] <span class="op">=</span> <span class="st">'I'</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>        df.loc[StoE_index, <span class="st">'State'</span>] <span class="op">=</span> <span class="st">'E'</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>        df.loc[ItoR_index, <span class="st">'Day'</span>] <span class="op">=</span> j</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>        df.loc[EtoI_index, <span class="st">'Day'</span>] <span class="op">=</span> j</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>        df.loc[StoE_index, <span class="st">'Day'</span>] <span class="op">=</span> j</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>        df.loc[ItoR_index, <span class="st">'DayR'</span>] <span class="op">=</span> j</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>        df.loc[EtoI_index, <span class="st">'DayI'</span>] <span class="op">=</span> j</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>        df.loc[StoE_index, <span class="st">'DayE'</span>] <span class="op">=</span> j</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Append the S, E, I, and R arrays</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>        S<span class="op">=</span>np.append(S,<span class="bu">len</span>(np.where(df.State<span class="op">==</span><span class="st">'S'</span>)[<span class="dv">0</span>]))</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>        E<span class="op">=</span>np.append(E,<span class="bu">len</span>(np.where(df.State<span class="op">==</span><span class="st">'E'</span>)[<span class="dv">0</span>]))</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>        I<span class="op">=</span>np.append(I,<span class="bu">len</span>(np.where(df.State<span class="op">==</span><span class="st">'I'</span>)[<span class="dv">0</span>]))</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>        R<span class="op">=</span>np.append(R,<span class="bu">len</span>(np.where(df.State<span class="op">==</span><span class="st">'R'</span>)[<span class="dv">0</span>]))</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Code below for control measures to reduce beta values</span></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a><span class="co">#        if ((I[-1] &gt; 1000) &amp; (Ipd[-1] &gt; 399)): </span></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a><span class="co">#            b = beta2</span></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a><span class="co">#        elif ((I[-1] &gt; 1000) &amp; (Ipd[-1] &lt; 400)): </span></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a><span class="co">#            b = beta3</span></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>    Epd[<span class="dv">0</span>]<span class="op">+=</span>num_E</span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>    Ipd[<span class="dv">0</span>]<span class="op">+=</span>num_I</span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>    Rpd[<span class="dv">0</span>]<span class="op">+=</span>num_R</span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> S,E,I,R, Epd, Ipd, Rpd, xxbeta, df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="motivation-for-write-up" class="level2">
<h2 class="anchored" data-anchor-id="motivation-for-write-up">Motivation for write-up</h2>
<p>This is the 7th part of a multi-part series blog post on modeling in epidemiology.</p>
<p>The goal of this 7th installment is to expand on the notions seen in part 5.</p>
<p>Most notably, the idea is to expand on the notion of convolution and deconvolution and to see how it can be useful to describe an epidemic.</p>
</section>
<section id="available-data" class="level2">
<h2 class="anchored" data-anchor-id="available-data">Available data</h2>
<p>If you look at the the COVID-19 trackers around the web, or even <a href="https://sars-cov-2-world-tracker.herokuapp.com/">mine</a>, you can get a sense of what data is available for study.</p>
<p>Generally speaking we have the following:</p>
<ul>
<li>Total number of positive individuals</li>
<li>Daily number of newly diagnosed individuals</li>
<li>Daily number of recovered individuals</li>
<li>Daily number of deaths</li>
</ul>
<p>Research has also shown some vague numbers on both <span class="math inline">\(T_{Latent}\)</span> and <span class="math inline">\(T_{Infectious}\)</span>.</p>
<p><strong>About the data:</strong></p>
<ul>
<li>We don’t have data for exposure - how can we get it using deconvolution ??</li>
<li>The data for some regions can be very sparse</li>
</ul>
</section>
<section id="convolution" class="level2">
<h2 class="anchored" data-anchor-id="convolution">Convolution</h2>
<section id="convolution-to-get-i_pd" class="level3">
<h3 class="anchored" data-anchor-id="convolution-to-get-i_pd">Convolution to get <span class="math inline">\(I_{pd}\)</span></h3>
<p>We have seen that daily new infectious individuals is given by:</p>
<p><span class="math display">\[I_{pd}[j] = \sum_{n_L=0}^{M_L-1}h_L[n_L]~E_{pd}[j-n_L]= h_L[j]\circledast E_{pd}[j]\]</span></p>
<p>Where <span class="math inline">\(h_L[j]\)</span> describes the distribution of <span class="math inline">\(T_{Latent}\)</span>.</p>
</section>
<section id="convolution-to-get-r_pd" class="level3">
<h3 class="anchored" data-anchor-id="convolution-to-get-r_pd">Convolution to get <span class="math inline">\(R_{pd}\)</span></h3>
<p>Similarly, we have seen that daily new recovered individuals (deaths + recoveries in fact) is given by:</p>
<p><span class="math display">\[R_{pd}[j] = \sum_{n_I=0}^{M_I-1}h_I[n_I]~I_{pd}[j-n_I]= h_I[j]\circledast I_{pd}[j]\]</span></p>
<p>Where <span class="math inline">\(h_I[j]\)</span> describes the distribution of <span class="math inline">\(T_{Infectious}\)</span>.</p>
</section>
</section>
<section id="finding-h_lj-and-h_ij" class="level2">
<h2 class="anchored" data-anchor-id="finding-h_lj-and-h_ij">Finding <span class="math inline">\(h_L[j]\)</span> and <span class="math inline">\(h_I[j]\)</span></h2>
<ul>
<li><span class="math inline">\(h_L[j]\)</span> is simply the probability of an individual having a latent period of j days</li>
<li><span class="math inline">\(h_I[j]\)</span> is similarly the probability of an individual having an infectious period of j days</li>
</ul>
<div class="cell" data-execution_count="44">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>days <span class="op">=</span> np.arange(<span class="dv">100</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>cdf <span class="op">=</span> pd.DataFrame({</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'T_Latent'</span>: gamma.cdf(days, <span class="fl">1.8</span>,loc<span class="op">=</span><span class="fl">0.9</span>,scale<span class="op">=</span>(<span class="fl">5.2</span><span class="op">-</span><span class="fl">1.8</span>)<span class="op">/</span><span class="fl">0.9</span>), </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'T_Infectious'</span>: weibull_min.cdf(days, <span class="fl">2.3</span>,loc<span class="op">=</span><span class="dv">2</span>,scale<span class="op">=</span><span class="fl">20.11</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>h_L <span class="op">=</span> cdf.diff().T_Latent</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>h_I <span class="op">=</span> cdf.diff().T_Infectious</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>h_L[<span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>h_I[<span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="convolution-in-practice" class="level2">
<h2 class="anchored" data-anchor-id="convolution-in-practice">Convolution in practice</h2>
<section id="comparing-i_pd-from-the-model-to-i_pd-obtained-by-convolving-r_pd" class="level3">
<h3 class="anchored" data-anchor-id="comparing-i_pd-from-the-model-to-i_pd-obtained-by-convolving-r_pd">Comparing <span class="math inline">\(I_{pd}\)</span> from the model to <span class="math inline">\(I_{pd}\)</span> obtained by convolving <span class="math inline">\(R_{pd}\)</span></h3>
<p>First run the SEIR model to obtain the actual <span class="math inline">\(I_{pd}\)</span>:</p>
<div class="cell" data-execution_count="63">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define parameters for stochastic model</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>days <span class="op">=</span> <span class="dv">300</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>num_E <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>num_I <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>num_R <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>beta_stoch <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span>np.ones(days)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Run 2 stochastic simulations</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>results_stoch0 <span class="op">=</span> seir_model_stoch(beta_stoch, p, num_E, num_I, num_R, days)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now obtain <span class="math inline">\(h_L[j]\circledast E_{pd}[j]\)</span>:</p>
<div class="cell" data-execution_count="64">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>Ipd<span class="op">=</span>signal.fftconvolve(h_L, results_stoch0[<span class="dv">4</span>], mode<span class="op">=</span><span class="st">'full'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-outputid="4d3b9e7c-32a3-43a2-dca3-590e770d9fcc" data-execution_count="65">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure(data<span class="op">=</span>[    </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'Ipd_Actual'</span>, x<span class="op">=</span>np.arange(<span class="bu">len</span>(results_stoch0[<span class="dv">5</span>])), y<span class="op">=</span>results_stoch0[<span class="dv">5</span>]),</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'Ipd_convolved'</span>, x<span class="op">=</span>np.arange(<span class="bu">len</span>(Ipd)), y<span class="op">=</span>Ipd)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">500</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">'ggplot2'</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    xaxis_title <span class="op">=</span> <span class="st">'Day'</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    yaxis_title <span class="op">=</span> <span class="st">'Count'</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span>{</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">'text'</span>:<span class="vs">r'$\text{Actual } I_</span><span class="sc">{pd}</span><span class="vs"> \text{ vs. } h_L[j]\circledast E_</span><span class="sc">{pd}</span><span class="vs">[j]$'</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">'x'</span>:<span class="fl">0.5</span>,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">'xanchor'</span>:<span class="st">'center'</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="e4daeda0-0708-4adc-9ea1-860f1b293d8e" class="plotly-graph-div" style="height:500px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("e4daeda0-0708-4adc-9ea1-860f1b293d8e")) {                    Plotly.newPlot(                        "e4daeda0-0708-4adc-9ea1-860f1b293d8e",                        [{"name":"Ipd_Actual","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299],"y":[0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,1,2,0,0,3,1,0,1,1,0,2,3,4,6,6,5,6,3,3,8,11,16,7,14,19,32,22,29,32,45,49,60,50,74,78,91,88,119,123,148,169,202,206,270,268,308,351,321,352,398,422,449,405,444,433,425,418,369,351,317,307,268,225,177,147,139,121,104,89,71,58,49,36,38,24,22,20,14,9,12,3,4,4,3,3,3,2,0,3,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"type":"scatter"},{"name":"Ipd_convolved","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398],"y":[-1.8189894035458565e-14,0.0008495563537326234,0.052966466707002835,0.09257352340366197,0.10539096045267797,0.10518156295283916,0.09833228653293191,0.08839412186487607,0.07740726398849802,0.06652833485099109,0.056379692296532086,0.047258651318779814,0.0392671858013,0.032393495305250326,0.027412934592239254,0.07463876781666841,0.11102810147589026,0.17430372279530956,0.3151797779808135,0.39811253363909943,0.41177141726620675,0.3920359939990772,0.35632558453053664,0.3160515360386995,0.3800888630652463,0.5759876357745225,0.7366246627673868,0.8356241044286671,0.9541425354290692,1.2430809302708115,1.4407639740215117,1.5095881532250925,1.567174219266506,1.7347882237507066,1.9791516668182996,2.2952088492048164,2.6445020537301094,3.0366593100177077,3.3388081382077655,3.59239783791267,3.8207760586492885,3.8732210408624095,4.3494704730266065,5.09349374991844,5.983507796922315,7.139662452910947,8.829533992943844,10.55382879631498,12.412544279999288,15.101585864853385,18.386899000124803,22.233996513761895,26.058770449359628,29.857745251245376,33.82940949231741,39.1094007885439,45.03474349698084,50.6969548227775,57.47735581614405,66.07528698183971,77.01441130943871,89.65497206941349,103.12010107510342,118.31999656934524,135.34658539308043,154.1124961381561,174.64767426541658,196.02177122958773,218.94100619257347,242.38669452560882,266.359290614251,290.5642892156919,317.0053574703481,344.4312778592207,369.0254610380637,391.3824039227337,411.06891430948394,425.6193525339703,435.1223669334852,438.8831756920949,435.8837570955095,424.8378815099531,407.23787203498773,384.90473073521076,357.1671226189672,326.31773453248576,293.3605339209308,260.4401727677837,228.27343494931543,197.62590127651123,169.25198222893525,143.43678352529056,120.77104060530863,100.93745579281527,83.78894701418946,69.22221142646367,57.048304915817475,46.81992643877993,38.26313969578823,31.176072974587214,25.29734315635633,20.443053011071722,16.464396212517354,13.221512577983617,10.590315739834974,8.463597912905252,6.750301709210892,5.374033709122349,4.271305358865937,3.389748791984022,2.6864346593951827,2.1263522303813063,1.6810738806248446,1.3276044891250502,1.0474045734908226,0.8255702871695101,0.650151288497421,0.5115874729914255,0.40224670316044425,0.3160473895196152,0.24815171317314857,0.19471722526675847,0.1526963898975239,0.11967529615666506,0.0937442269752195,0.07339403705566028,0.05743336950430805,0.04492264683710921,0.03512152938180307,0.02744715920141449,0.02144102494682695,0.016742702224382323,0.013069068925757737,0.010197872627905408,0.007954752940435055,0.0062030022307810176,0.004835494687123163,0.003768329607775626,0.0029358294711913737,0.002286606542344419,0.0017804718347929197,0.0013860090447377876,0.001078669144510657,0.0008392771817936125,0.0006528614720961408,0.0005077368136222179,0.0003947855812904561,0.0003068963160950278,0.00023852445808232627,0.0001853477751721709,0.00014399853702637492,0.0001118527861834065,8.686714045538736e-05,6.74502415861263e-05,5.23642697398753e-05,4.0645437131562645e-05,3.154324959733169e-05,2.4474748459012656e-05,1.8986224807694952e-05,1.4725421027548102e-05,1.1418243111620541e-05,8.851115053403191e-06,6.858835677121533e-06,5.3127218779991385e-06,4.112874607926642e-06,3.1820525236980757e-06,2.4594377646280918e-06,1.8989810496350402e-06,1.46389809287939e-06,1.1263051146670478e-06,8.634542928120937e-07,6.595612535420514e-07,5.021284459871823e-07,3.796703845182492e-07,2.8496558115875817e-07,2.1237747091618075e-07,1.5638898616998632e-07,1.138168590841815e-07,8.179895644389035e-08,5.8349888263364844e-08,4.085638209971876e-08,2.797505061380434e-08,1.9327866027651906e-08,1.2955797785707545e-08,8.828910438296588e-09,5.74163038891129e-09,3.8353961429038465e-09,2.556809377551872e-09,1.7103554483810513e-09,1.1984215575466805e-09,7.30507228041688e-10,5.116227086432445e-10,3.422223526783341e-10,2.1109663350671325e-10,9.169795589514251e-11,5.305221151274964e-11,2.3139712368447363e-11,3.0375701953744282e-15,2.6201263381153694e-14,1.6555645743210335e-14,-1.1883827255587676e-14,8.704148513061227e-16,-1.0014211682118912e-14,-3.672617765460018e-15,2.4424906541753446e-16,1.155742168634788e-14,1.6207035713478034e-14,4.618527782440651e-16,2.9387603461827892e-15,-5.1214588125958474e-15,-8.568701304056959e-15,1.2041478925084449e-14,-9.310885396018875e-15,1.3244960683778117e-15,4.740652315149419e-16,1.3852807789760391e-14,-1.8390983180793797e-14,-2.150085665064694e-15,-2.463543258279799e-14,1.5681900222830336e-15,-3.3796576648370547e-15,-2.1364021662861888e-14,-1.9993347255553575e-14,-2.1423592067026932e-14,-1.6692619508873462e-14,6.0897641096513415e-15,-8.654413991004973e-15,8.131577008962942e-15,-1.7600703880460422e-14,3.328170204708325e-14,-2.175493726136457e-14,-2.0548276621901173e-14,-1.3216452671854785e-14,1.5071518252168792e-14,-1.6856652792357484e-14,3.5559395055242974e-14,-3.168293427092961e-14,-2.8647494532824115e-15,-2.2295478180681115e-14,-3.059817590272962e-14,-4.5474735088646414e-14,-3.637978807091713e-14,-5.456968210637569e-14,-3.637978807091713e-14,-4.547473508864641e-15,-9.094947017729283e-15,-1.8189894035458565e-14,-1.3642420526593923e-14,-4.547473508864641e-15,-9.094947017729283e-15,-2.2737367544323207e-14,-1.1368683772161604e-14,1.3642420526593923e-14,2.2737367544323206e-15,-1.3642420526593923e-14,-5.684341886080802e-15,-1.0231815394945442e-14,-1.3642420526593923e-14,-1.7053025658242404e-14,-1.7053025658242404e-15,-2.842170943040401e-16,2.927436071331613e-14,-1.1652900866465644e-14,-9.947598300641404e-15,-4.263256414560601e-15,-1.7053025658242404e-14,-1.8616219676914626e-14,-9.023892744153272e-15,2.5082158572331538e-14,1.1652900866465644e-14,1.3020695632803836e-14,3.0908609005564358e-15,2.866595849582154e-14,8.668621376273222e-15,1.1368683772161603e-15,2.8030910925735954e-14,2.3483437416871312e-14,2.879474436667806e-14,1.3677947663381929e-15,-2.6290081223123707e-15,1.813660333027656e-14,2.6982860390489804e-14,2.7666757773658903e-15,8.304468224196171e-16,2.4482638139033953e-14,3.221201083647429e-14,3.3530955789728976e-14,2.05702122002549e-14,3.685163285638282e-14,2.2174484470838254e-14,1.538991156735392e-14,2.3201440768616523e-14,2.750077943147744e-14,-8.145706331674774e-15,-6.158407117595743e-15,-1.612654454419271e-14,-2.072647609097089e-15,2.150085665064694e-15,1.8980650384747834e-15,-1.5681900222830336e-15,-1.481023637062151e-14,-1.9563239916919884e-14,-1.1838967306498915e-14,3.2336980315683663e-15,-3.332958908863759e-14,-1.5184711127380622e-14,-1.8630427062182877e-14,9.6337000876634e-16,-9.684137172727426e-15,-1.5091808011624687e-14,-2.3719797827281843e-14,-2.4926458466745238e-14,-3.225828241679163e-14,3.118375783289773e-15,-1.9523135278559646e-14,8.20393015674159e-16,-2.2886747835446085e-14,2.8647494532824115e-15,4.105584145222552e-15,-5.781612168187511e-15,0.0,7.275957614183426e-14,0.0,3.637978807091713e-14,0.0,3.637978807091713e-14,5.456968210637569e-14,1.8189894035458565e-14,0.0,1.8189894035458565e-14,-1.8189894035458565e-14,1.8189894035458565e-14,0.0,9.094947017729283e-15,0.0,1.3642420526593923e-14,-9.094947017729283e-15,0.0,-1.1368683772161604e-14,2.0463630789890885e-14,-1.1368683772161604e-14,-7.958078640513123e-15,1.1368683772161603e-15,1.9326762412674726e-14,-2.2737367544323206e-15,0.0,7.389644451905042e-15,-1.4779288903810084e-14,-5.4001247917767615e-15,1.1652900866465644e-14,1.1084466677857563e-14,-3.268496584496461e-15,1.1226575225009583e-14,2.0605739337042905e-14,3.694822225952521e-15,-2.2026824808563106e-15,4.0500935938325715e-15,8.704148513061228e-15,2.2026824808563106e-14,5.293543381412746e-15,2.0676793610618916e-14,1.962874307537277e-14,5.4356519285647665e-15,5.986322548778844e-15,3.845812557301542e-15,-1.0089706847793422e-14,5.933031843596836e-15,5.608846720406291e-15,1.9191315203670457e-14,2.113420549676448e-14,-5.935252289646087e-15,-4.0589753780295726e-15,-1.4810375148499588e-15,2.220001960040463e-14,-7.88424880937555e-15,-3.815836535636663e-15,8.195943923539062e-15,7.390754674929668e-15,-2.0354551377721464e-14,-5.7870375158586285e-15,6.835365606860933e-15,7.363692988704429e-15,-2.0607057726884648e-14,-8.320705235931315e-15,3.0346558599347875e-15,-6.8798092223154584e-15,-2.4705307244410334e-14,1.08213438210214e-14,8.652176197720963e-15,-3.832351103127963e-15,-3.931934638989887e-14,-7.092373563444276e-15,-2.136745641534432e-15,-3.6603680156344075e-14,-5.365275931867863e-14,-2.0183065288503778e-14,-2.7381989904651238e-14,2.2035671898290587e-15,-5.787091942807687e-14],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(237,237,237)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(51,51,51)"},"error_y":{"color":"rgb(51,51,51)"},"marker":{"line":{"color":"rgb(237,237,237)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(51,51,51)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(51,51,51)"},"baxis":{"endlinecolor":"rgb(51,51,51)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(51,51,51)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"colorscale":{"sequential":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"sequentialminus":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]]},"colorway":["#F8766D","#A3A500","#00BF7D","#00B0F6","#E76BF3"],"font":{"color":"rgb(51,51,51)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"rgb(237,237,237)","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","paper_bgcolor":"white","plot_bgcolor":"rgb(237,237,237)","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"},"bgcolor":"rgb(237,237,237)","radialaxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"rgb(237,237,237)","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"rgb(237,237,237)","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"rgb(237,237,237)","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","zerolinecolor":"white"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"},"baxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"},"bgcolor":"rgb(237,237,237)","caxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"}},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","title":{"standoff":15},"zerolinecolor":"white"},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","title":{"standoff":15},"zerolinecolor":"white"}}},"title":{"text":"$\\text{Actual } I_{pd} \\text{ vs. } h_L[j]\\circledast E_{pd}[j]$","x":0.5,"xanchor":"center"},"height":500,"xaxis":{"title":{"text":"Day"}},"yaxis":{"title":{"text":"Count"}}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('e4daeda0-0708-4adc-9ea1-860f1b293d8e');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="comparing-r_pd-from-the-model-to-r_pd-obtained-by-convolving-i_pd" class="level3">
<h3 class="anchored" data-anchor-id="comparing-r_pd-from-the-model-to-r_pd-obtained-by-convolving-i_pd">Comparing <span class="math inline">\(R_{pd}\)</span> from the model to <span class="math inline">\(R_{pd}\)</span> obtained by convolving <span class="math inline">\(I_{pd}\)</span></h3>
<p>We can use the actual <span class="math inline">\(R_{pd}\)</span> from the SEIR model above.</p>
<p>Now obtain <span class="math inline">\(h_I[j]\circledast I_{pd}[j]\)</span>:</p>
<div class="cell" data-execution_count="66">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>Rpd<span class="op">=</span>signal.fftconvolve(h_I, results_stoch0[<span class="dv">5</span>], mode<span class="op">=</span><span class="st">'full'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-outputid="b256b295-afa5-4826-c3b5-6cae0869bddd" data-execution_count="67">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure(data<span class="op">=</span>[    </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'Rpd_Actual'</span>, x<span class="op">=</span>np.arange(<span class="bu">len</span>(results_stoch0[<span class="dv">6</span>])), y<span class="op">=</span>results_stoch0[<span class="dv">6</span>]),</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'Rpd_convolved'</span>, x<span class="op">=</span>np.arange(<span class="bu">len</span>(Rpd)), y<span class="op">=</span>Rpd)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">'ggplot2'</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">500</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    xaxis_title <span class="op">=</span> <span class="st">'Day'</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    yaxis_title <span class="op">=</span> <span class="st">'Count'</span>,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span>{</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">'text'</span>:<span class="vs">r'$\text{Actual } R_</span><span class="sc">{pd}</span><span class="vs"> \text{ vs. } h_I[j]\circledast I_</span><span class="sc">{pd}</span><span class="vs">[j]$'</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">'x'</span>:<span class="fl">0.5</span>,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">'xanchor'</span>:<span class="st">'center'</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="fc50c5ee-f699-48df-8236-e3541a556ae4" class="plotly-graph-div" style="height:500px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("fc50c5ee-f699-48df-8236-e3541a556ae4")) {                    Plotly.newPlot(                        "fc50c5ee-f699-48df-8236-e3541a556ae4",                        [{"name":"Rpd_Actual","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299],"y":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,2,1,0,2,0,1,0,0,1,2,1,1,2,3,1,2,2,4,4,9,10,11,10,13,14,17,17,19,26,29,34,31,35,44,43,68,68,77,111,98,115,117,149,170,176,178,218,249,257,248,278,276,281,271,288,289,305,315,317,342,274,325,297,284,268,234,272,228,235,197,182,177,160,149,136,103,88,100,81,81,68,54,53,51,50,30,27,21,20,18,12,15,12,7,5,4,8,4,3,3,1,0,1,0,0,2,0,1,0,1,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"type":"scatter"},{"name":"Rpd_convolved","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398],"y":[1.3642420526593923e-14,-9.094947017729283e-15,9.094947017729283e-15,0.0,-9.094947017729283e-15,-2.7284841053187846e-14,-1.8189894035458565e-14,-1.8189894035458565e-14,9.094947017729283e-15,0.0,0.0,0.0010044631988785112,0.003932353470645467,0.007560109764708614,0.0115804224231033,0.015822524023515142,0.020151316677693102,0.02444717776566904,0.028600303155726578,0.03250975759461653,0.036084385898466284,0.039244453156115924,0.04192344776434766,0.04507417600218105,0.04958004267447905,0.05419873964163344,0.058621125527606635,0.06369544241245421,0.07023531931054094,0.07794528865663779,0.08939067076536049,0.10497741371024859,0.12179409227715042,0.14194175348766294,0.16860158741433226,0.1985500733813251,0.2302366123671891,0.2644059217020822,0.2998682434876082,0.33635220306044633,0.37758489041760185,0.42704089704937814,0.48943921680559244,0.5695998341300947,0.668277311531574,0.7852892601759982,0.9189057129128128,1.0631600504126413,1.2201427083888405,1.3999910674855631,1.614605399138547,1.8662908167858496,2.1482951936791856,2.4737245388629465,2.865843058921605,3.341709097666144,3.897616790932296,4.5457982783501425,5.3051922158730545,6.203661897616423,7.2645927023629415,8.500069926236488,9.918139837208749,11.557643115236356,13.442539074006422,15.590771783666135,18.025087054252833,20.794625848747042,23.933366835333395,27.499852189788864,31.56381467997951,36.18787337329652,41.445000638140584,47.43779512457032,54.21228934208319,61.86421032741182,70.42872616631118,79.86274970682037,90.20057734256716,101.49010797505143,113.74844337989907,126.91300924579154,140.8590532776744,155.5128624721515,170.7296059924356,186.34555969061367,202.14475026443543,217.85607221383722,233.22186738434948,247.9867679837918,261.9119416311299,274.72402563164354,286.1412770776769,295.9024377152934,303.81916792016534,309.7712555798788,313.6710250687458,315.4723964754642,315.1679610459504,312.78659906568424,308.40223691400865,302.1243688339095,294.0990857348309,284.50516843669385,273.5282460545357,261.38154284300003,248.28434966760898,234.451467615736,220.1009145193577,205.44398337918207,190.67042378195973,175.9656372430442,161.49645752991577,147.4088057110246,133.8283505357865,120.85796375800732,108.57577165678522,97.04117575661614,86.29717527263303,76.3627551968846,67.24160064275645,58.924814303057396,51.39196396185451,44.61306610108054,38.5506279637681,33.161592161732976,28.399121935996856,24.215196490939967,20.5608988350639,17.385517165400216,14.640546044340185,12.279643937064066,10.259080735796184,8.538097046140958,7.079131066579942,5.847925904254359,4.813536780547988,3.948258102849452,3.227489173321187,2.629555398295249,2.1354996528417587,1.7288561612318856,1.395417013462112,1.1229993415094905,0.9012192836700952,0.7212772026263011,0.5757572045675577,0.458442829799836,0.364149836381989,0.2885762569931871,0.2281693509834012,0.18000867213957064,0.14170420190335326,0.11130833271832531,0.08724040420996271,0.06822247609682397,0.05322504918263963,0.04142150554167355,0.03215011995544924,0.02488258815808013,0.019198117013797856,0.014762222648869283,0.011309481440866876,0.008629573324030844,0.006556045578397516,0.004957307161339486,0.003729438156483411,0.0027904657921089893,0.002075817687491508,0.0015347146756766962,0.0011273100337439246,0.0008224196629407743,0.0005957192536834555,0.0004283103599482274,0.00030557827338725476,0.0002162813117593032,0.00015182430040567852,0.00010567926404291938,7.292423876151588e-05,4.9877164806275686e-05,3.380646147888911e-05,2.270345789838757e-05,1.5104637391232245e-05,9.953854428204068e-06,6.496451978819096e-06,4.1986591986642455e-06,2.6868522945733274e-06,1.7022702377289533e-06,1.0676298916223459e-06,6.627950278925709e-07,4.072540673405456e-07,2.4765262423898094e-07,1.4903134342603153e-07,8.874359082255978e-08,5.22866230312502e-08,3.047959125979105e-08,1.757782683853293e-08,1.0028379620052874e-08,5.65957407161477e-09,3.1593469884683145e-09,1.7444165223423626e-09,9.526024769002106e-10,5.144937631484936e-10,2.7480439257487887e-10,1.451581965739024e-10,7.581661520816851e-11,3.916511559509672e-11,1.9994956801383523e-11,1.0116707471752306e-11,5.0425796871422795e-12,2.5121948965534102e-12,1.2342127320152941e-12,6.269829100347124e-13,2.9814373192493804e-13,1.6918022538447985e-13,7.94386778579792e-14,5.375200284873927e-14,3.8014036363165364e-14,3.4745539778668897e-14,2.7498003873915878e-14,2.6432189770275728e-14,1.9966250874858816e-14,3.4212632726848827e-14,1.730171561575844e-14,2.2026824808563106e-14,2.4407142973359442e-14,2.1316282072803006e-14,2.9753977059954195e-14,4.574118861455645e-14,2.4300561562995426e-14,2.965627743378718e-14,2.2923885012460234e-14,1.610267474916327e-14,2.3856472353145363e-14,2.5570656703166605e-14,1.0380585280245214e-14,5.027089855502709e-15,8.925082894961633e-15,2.701838752727781e-14,-1.6131540547803526e-15,4.547473508864641e-15,9.094947017729283e-15,0.0,-1.1368683772161604e-14,6.8212102632969615e-15,-9.094947017729283e-15,4.547473508864641e-15,-4.547473508864641e-15,-3.637978807091713e-14,-1.3642420526593923e-14,-9.094947017729283e-15,-2.2737367544323207e-14,-2.2737367544323207e-14,-3.637978807091713e-14,-1.3642420526593923e-14,-2.7284841053187846e-14,-2.2737367544323207e-14,-9.094947017729283e-15,-1.3642420526593923e-14,-1.3642420526593923e-14,-9.094947017729283e-15,-2.7284841053187846e-14,-3.183231456205249e-14,-1.3642420526593923e-14,-2.7284841053187846e-14,-4.5474735088646414e-14,-1.8189894035458565e-14,-1.8189894035458565e-14,-1.8189894035458565e-14,0.0,-1.5916157281026246e-14,-1.8189894035458565e-14,-3.183231456205249e-14,-2.7284841053187846e-14,-1.8189894035458565e-14,-4.547473508864641e-15,-1.3642420526593923e-14,-9.094947017729283e-15,-2.5011104298755527e-14,-5.684341886080802e-15,-1.7053025658242404e-14,-6.8212102632969615e-15,-7.389644451905042e-15,-1.7053025658242404e-15,2.842170943040401e-15,5.684341886080802e-15,-6.8212102632969615e-15,3.154809746774845e-14,-7.105427357601002e-15,6.252776074688882e-15,-4.831690603168682e-15,1.4352963262354024e-14,-1.7053025658242404e-15,6.536993168992922e-15,2.6290081223123707e-15,2.3163693185779268e-14,-1.3607448501318231e-14,9.876544027065393e-15,3.481659405224491e-15,1.2576606422953773e-14,-3.126388037344441e-15,5.044853423896711e-15,-4.6540549192286564e-15,3.7836400679225336e-14,2.1742607714259066e-14,3.0162539133016254e-14,1.3926637620897963e-14,1.9131363160340697e-14,-1.2772005675287802e-14,2.9842794901924207e-15,-2.510880392492254e-14,2.368771845340234e-14,-7.0077277314339886e-15,1.7070789226636406e-14,3.9879211044535625e-15,1.0083045509645673e-14,-4.796163466380677e-16,1.6086021403793895e-14,-3.156586103614245e-14,1.9803048090238918e-14,0.0,9.094947017729283e-15,0.0,1.8189894035458565e-14,1.8189894035458565e-14,1.8189894035458565e-14,1.8189894035458565e-14,3.637978807091713e-14,0.0,1.8189894035458565e-14,3.637978807091713e-14,5.456968210637569e-14,1.8189894035458565e-14,3.637978807091713e-14,3.637978807091713e-14,5.456968210637569e-14,3.637978807091713e-14,5.456968210637569e-14,3.637978807091713e-14,3.637978807091713e-14,3.637978807091713e-14,0.0,1.8189894035458565e-14,1.8189894035458565e-14,1.8189894035458565e-14,3.637978807091713e-14,1.8189894035458565e-14,3.637978807091713e-14,3.637978807091713e-14,3.637978807091713e-14,3.637978807091713e-14,0.0,1.8189894035458565e-14,1.8189894035458565e-14,2.7284841053187846e-14,9.094947017729283e-15,4.5474735088646414e-14,9.094947017729283e-15,9.094947017729283e-15,1.8189894035458565e-14,9.094947017729283e-15,1.8189894035458565e-14,2.2737367544323207e-14,9.094947017729283e-15,2.5011104298755527e-14,4.547473508864641e-15,2.0463630789890885e-14,2.2737367544323207e-14,9.094947017729283e-15,1.5916157281026246e-14,9.094947017729283e-15,4.547473508864641e-15,3.9790393202565614e-14,2.1032064978498965e-14,2.5579538487363607e-14,6.8212102632969615e-15,8.526512829121202e-15,2.7569058147491886e-14,3.751665644813329e-14,2.7284841053187846e-14,1.8332002582610585e-14,-1.4210854715202005e-15,2.6147972675971688e-14,2.1742607714259066e-14,1.1795009413617664e-14,1.7834622667578516e-14,1.3749001936957939e-14,2.1884716261411086e-14,3.204547738278052e-14,9.592326932761353e-15,1.781685909918451e-14,-5.506706202140776e-16,2.284394895468722e-14,1.959321593858476e-14,2.0650148258027912e-14,2.439826118916244e-14,7.500666754367558e-15,-1.6453505224944822e-14,3.1530333899354444e-16],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(237,237,237)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(51,51,51)"},"error_y":{"color":"rgb(51,51,51)"},"marker":{"line":{"color":"rgb(237,237,237)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(51,51,51)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(51,51,51)"},"baxis":{"endlinecolor":"rgb(51,51,51)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(51,51,51)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"colorscale":{"sequential":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"sequentialminus":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]]},"colorway":["#F8766D","#A3A500","#00BF7D","#00B0F6","#E76BF3"],"font":{"color":"rgb(51,51,51)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"rgb(237,237,237)","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","paper_bgcolor":"white","plot_bgcolor":"rgb(237,237,237)","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"},"bgcolor":"rgb(237,237,237)","radialaxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"rgb(237,237,237)","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"rgb(237,237,237)","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"rgb(237,237,237)","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","zerolinecolor":"white"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"},"baxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"},"bgcolor":"rgb(237,237,237)","caxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"}},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","title":{"standoff":15},"zerolinecolor":"white"},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","title":{"standoff":15},"zerolinecolor":"white"}}},"title":{"text":"$\\text{Actual } R_{pd} \\text{ vs. } h_I[j]\\circledast I_{pd}[j]$","x":0.5,"xanchor":"center"},"height":500,"xaxis":{"title":{"text":"Day"}},"yaxis":{"title":{"text":"Count"}}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('fc50c5ee-f699-48df-8236-e3541a556ae4');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
</section>
<section id="de-convolution" class="level2">
<h2 class="anchored" data-anchor-id="de-convolution">De-convolution</h2>
<p>We get very close matches when convlving, can we obtain similar results by deconvolving?</p>
<section id="problems-with-de-convolution" class="level3">
<h3 class="anchored" data-anchor-id="problems-with-de-convolution">Problems with de-convolution</h3>
<p><strong>Illl-posed</strong></p>
<p>Unfortunately de-convolution is not as straightforward as the convolution.</p>
<p>A quick recap of the math, in the frequency domain we have (Fourier or z transform) <span class="math display">\[F \{ f ∗ g \} = F \{ f \} ~ F \{ g \}\]</span> And so if we have: <span class="math display">\[y=\ f ∗ g\]</span> Then: <span class="math display">\[F \{ y \} = F \{ f \} ~ F \{ g \}\]</span> And: <span class="math display">\[g = F^{-1} \left(\frac{F\{y\}}{F\{f\}} \right) \]</span></p>
<p>But this last equation is often ill-posed.</p>
<p><strong>Noise in data</strong></p>
<p>We can see above that daily new data varies a lot from day to day due to the stochasticity of the model. This results in high-frequency decomposition in the frequency domain.</p>
<p><strong>Initial conditions and boundary-value problems</strong></p>
<p>Boundary values refer to the values on day 0 and the last day we have data for. Due to the way data is reported on JHU, we someimes have crayz values here, most commonly a value of 0 for the latest day if the data isn0t reported on time for example. These gaps can create issues for deconvolution.</p>
<p>In the next blog post I go around this by simplz averaging the last 3 days instead of using only the last day.</p>
</section>
<section id="solutions-to-these-problems" class="level3">
<h3 class="anchored" data-anchor-id="solutions-to-these-problems">Solutions to these problems</h3>
<section id="iterative-deconvoluton" class="level4">
<h4 class="anchored" data-anchor-id="iterative-deconvoluton">Iterative deconvoluton</h4>
<p>Multiple iterative deconvolution algorithms exist: Lucy_Richardson, Gold, or Van Cittert among others.</p>
<p>LR has already been used to get daily incidence of the Spanish flu based on death records in Philadelphia at the time for example <a href="https://doi.org/10.1073/pnas.0902958106">1</a>.</p>
<p>An adaptation of those above is used here with the basics below (see code for details):</p>
<p>Let’s use the equation for <span class="math inline">\(I_{pd}\)</span> as an example: <span class="math display">\[I_{pd}[j] = \sum_{n_L=0}^{M_L-1}h_L[n_L]~E_{pd}[j-n_L]= h_L[j]\circledast E_{pd}[j]\]</span></p>
<p>The idea is that after an initial guess for <span class="math inline">\(E_{pd}\)</span> we can iteraively find a better one.</p>
<p>With the <span class="math inline">\(n^{th}\)</span> guess for <span class="math inline">\(E_{pd}\)</span> written as <span class="math inline">\(E_{pd, n}\)</span> we have: <span class="math display">\[I_{pd}[j]= h_L[j]\circledast E_{pd, n}[j]\]</span> <span class="math display">\[\leftrightarrow 0 = I_{pd}[j] - h_L[j]\circledast E_{pd, n}[j]\]</span> <span class="math display">\[\leftrightarrow E_{pd,n+1} = E_{pd,n} + I_{pd}[j] - h_L[j]\circledast E_{pd, n}[j]\]</span></p>
<p>Where <span class="math inline">\(O[j] = I_{pd}[j] - h_L[j]\circledast E_{pd, n}[j]\)</span> is the error term.</p>
<p>Hence we want to minimze <span class="math inline">\(O[j]\)</span>.</p>
<p><strong>Initial guess</strong></p>
<p>We know our <span class="math inline">\(h_L\)</span> and <span class="math inline">\(h_I\)</span> are in part simply delay functions, so an initial first guess is to simply use the same signal delayed by the time difference caused by the impulse response.</p>
</section>
<section id="low-pass-filter" class="level4">
<h4 class="anchored" data-anchor-id="low-pass-filter">Low-pass filter</h4>
<p>To go around those high-frequency notes in the data, we can siply use a lowpass filter implemented as a butterworth filter below:</p>
<p>The basic effect is that it smoothes the daily values as we have when convolving from the previous state daily values.</p>
<div class="cell" data-execution_count="68">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> lowpass(x, fc<span class="op">=</span><span class="fl">0.05</span>):</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  fs <span class="op">=</span> <span class="dv">1</span>  <span class="co"># Sampling frequency</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  t <span class="op">=</span> np.arange(<span class="bu">len</span>(x)) <span class="co">#select number of days done in SEIR model</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  signala <span class="op">=</span> x</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#fc = 0.05  # Cut-off frequency of the filter</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  w <span class="op">=</span> fc <span class="op">/</span> (fs <span class="op">/</span> <span class="dv">2</span>) <span class="co"># Normalize the frequency</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  b, a <span class="op">=</span> signal.butter(<span class="dv">5</span>, w, <span class="st">'low'</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> signal.filtfilt(b, a, signala)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="deconvolution-in-practice" class="level2">
<h2 class="anchored" data-anchor-id="deconvolution-in-practice">Deconvolution in practice</h2>
<section id="coding-the-iterative-deconvolution" class="level3">
<h3 class="anchored" data-anchor-id="coding-the-iterative-deconvolution">Coding the iterative deconvolution</h3>
<div class="cell" data-execution_count="69">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's define an iteration function:</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> iter_deconv(alpha, impulse_response, input_signal, delay, comparator):</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  conv<span class="op">=</span>signal.fftconvolve(impulse_response, input_signal, mode<span class="op">=</span><span class="st">'full'</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  correction<span class="op">=</span>np.roll(comparator<span class="op">-</span>conv[:<span class="bu">len</span>(comparator)], delay)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  input_signal<span class="op">=</span>np.floor(lowpass(alpha<span class="op">*</span>correction<span class="op">+</span>input_signal))</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  input_signal[input_signal<span class="op">&lt;</span><span class="dv">0</span>]<span class="op">=</span><span class="dv">0</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> input_signal</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function to return MSE between two signals as a measure of goodness of fit</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> msecalc(A, B):</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> ((A <span class="op">-</span> B)<span class="op">**</span><span class="dv">2</span>).mean(axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="comparing-e_pd-from-the-model-to-e_pd-obtained-by-de-convolving-i_pd" class="level3">
<h3 class="anchored" data-anchor-id="comparing-e_pd-from-the-model-to-e_pd-obtained-by-de-convolving-i_pd">Comparing <span class="math inline">\(E_{pd}\)</span> from the model to <span class="math inline">\(E_{pd}\)</span> obtained by de-convolving <span class="math inline">\(I_{pd}\)</span></h3>
<div class="cell" data-outputid="f6346e4f-cdb0-45d3-a5a8-5b9eef448d6d" data-execution_count="70">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#regularization parameter</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>alpha<span class="op">=</span><span class="dv">2</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup up the resultant Ipd we want to compare our guess with</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>Ipd<span class="op">=</span>np.floor(lowpass(results_stoch0[<span class="dv">5</span>]))</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>Ipd[Ipd<span class="op">&lt;</span><span class="dv">0</span>]<span class="op">=</span><span class="dv">0</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Find delay caused by h_L</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>delay<span class="op">=</span>Ipd.argmax()<span class="op">-</span>signal.fftconvolve(Ipd, h_L, mode<span class="op">=</span><span class="st">'full'</span>).argmax()</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co"># We want initial guess to simply be the result of the convolution delayed</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>initial_guess<span class="op">=</span>np.roll(Ipd,delay)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>Enext <span class="op">=</span> initial_guess</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co"># AN array to record MSE between result we want and our iterated guess</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>mse<span class="op">=</span>np.array([])</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>mse<span class="op">=</span>np.append(mse, <span class="dv">100000</span>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>mse<span class="op">=</span>np.append(mse, msecalc(Ipd, signal.fftconvolve(h_L, Enext, mode<span class="op">=</span><span class="st">'full'</span>)[:<span class="bu">len</span>(Ipd)]))</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>itercount<span class="op">=</span><span class="dv">0</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> mse[<span class="op">-</span><span class="dv">1</span>] <span class="op">&lt;</span> mse[<span class="op">-</span><span class="dv">2</span>]:</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  itercount<span class="op">=</span>itercount<span class="op">+</span><span class="dv">1</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  Enext<span class="op">=</span>iter_deconv(alpha, h_L, Enext, delay, Ipd)</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  mse<span class="op">=</span>np.append(mse, msecalc(Ipd, signal.fftconvolve(h_L, Enext, mode<span class="op">=</span><span class="st">'full'</span>)[:<span class="bu">len</span>(Ipd)]))</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">"Iteration #"</span> <span class="op">+</span> <span class="bu">str</span>(itercount) <span class="op">+</span><span class="st">": MSE= "</span><span class="op">+</span><span class="bu">str</span>(mse[itercount]))</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Iteration #"</span> <span class="op">+</span> <span class="bu">str</span>(itercount<span class="op">+</span><span class="dv">1</span>) <span class="op">+</span><span class="st">": MSE= "</span><span class="op">+</span><span class="bu">str</span>(mse[<span class="op">-</span><span class="dv">1</span>])<span class="op">+</span><span class="st">" so we use the result of the previous iteration."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Iteration #1: MSE= 109.26874893216016
Iteration #2: MSE= 29.59324829604124
Iteration #3: MSE= 16.082645173109015
Iteration #4: MSE= 10.416739793292933
Iteration #5: MSE= 7.510012038124945
Iteration #6: MSE= 5.750403522116447
Iteration #7: MSE= 4.83783679994662
Iteration #8: MSE= 3.9549140311656297
Iteration #9: MSE= 3.6454272545505275
Iteration #10: MSE= 3.120021247493611
Iteration #11: MSE= 2.9694849143827104
Iteration #12: MSE= 2.5128234859930174
Iteration #13: MSE= 2.5233462832653677 so we use the result of the previous iteration.</code></pre>
</div>
</div>
<div class="cell" data-outputid="3974bf33-4516-4519-d805-27bfab4c3fcb" data-execution_count="71">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure(data<span class="op">=</span>[    </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'E_pd'</span>, x<span class="op">=</span>np.arange(<span class="dv">150</span>), y<span class="op">=</span>results_stoch0[<span class="dv">4</span>]),</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'Epd=lowpass(E_pd)'</span>, x<span class="op">=</span>np.arange(<span class="dv">150</span>), y<span class="op">=</span>lowpass(results_stoch0[<span class="dv">4</span>])),</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'Epd=deconv(I_pd)'</span>, x<span class="op">=</span>np.arange(<span class="dv">150</span>), y<span class="op">=</span>Enext),</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'I_pd'</span>, x<span class="op">=</span>np.arange(<span class="dv">150</span>), y<span class="op">=</span>results_stoch0[<span class="dv">5</span>]),</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'Ipd=lowpass(I_pd)'</span>, x<span class="op">=</span>np.arange(<span class="dv">150</span>), y<span class="op">=</span>lowpass(results_stoch0[<span class="dv">5</span>])),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'Ipd=conv(E_pd)'</span>, x<span class="op">=</span>np.arange(<span class="dv">150</span>), y<span class="op">=</span>signal.fftconvolve(h_L, lowpass(results_stoch0[<span class="dv">4</span>]), mode<span class="op">=</span><span class="st">'full'</span>)),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'Ipd=conv(deconv(Ipd))'</span>, x<span class="op">=</span>np.arange(<span class="dv">150</span>), y<span class="op">=</span>signal.fftconvolve(h_L, Enext, mode<span class="op">=</span><span class="st">'full'</span>)[:<span class="bu">len</span>(Ipd)])</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">'ggplot2'</span>,</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">500</span>,</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    xaxis_title <span class="op">=</span> <span class="st">'Day'</span>,</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    yaxis_title <span class="op">=</span> <span class="st">'Count'</span>,</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span>{</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">'text'</span>:<span class="vs">r'$\text{Actual } E_</span><span class="sc">{pd}</span><span class="vs"> \text{ vs. deconvolution of } I_</span><span class="sc">{pd}</span><span class="vs">$'</span>,</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">'x'</span>:<span class="fl">0.5</span>,</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">'xanchor'</span>:<span class="st">'center'</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="f7529f7c-e6ba-4eb4-a676-688e95b7b742" class="plotly-graph-div" style="height:500px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("f7529f7c-e6ba-4eb4-a676-688e95b7b742")) {                    Plotly.newPlot(                        "f7529f7c-e6ba-4eb4-a676-688e95b7b742",                        [{"name":"E_pd","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149],"y":[1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,2,0,0,0,0,0,2,3,1,1,2,5,1,1,2,4,4,5,5,6,4,5,5,2,13,11,13,17,25,20,26,41,43,52,48,54,60,87,85,82,114,136,168,182,193,232,257,287,319,334,379,389,422,441,508,519,488,515,506,463,450,406,353,278,241,204,130,112,67,61,34,23,15,7,11,3,3,3,4,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"type":"scatter"},{"name":"Epd=lowpass(E_pd)","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149],"y":[1.0949286478285194,0.9013082717579386,0.7096845077858969,0.5269102132552694,0.35881173816785994,0.20994896313078232,0.08357004632515048,-0.018250685012615907,-0.0943306866377552,-0.14401311201924274,-0.16678924314894047,-0.1619845714306505,-0.12857625120955624,-0.06519287994594176,0.0296773453157805,0.15727528469720287,0.3179964954807628,0.5107290891670184,0.7322093321941837,0.9765201947708905,1.234861258949328,1.4957012210331597,1.7453867255540125,1.969228099676393,2.1530216179310426,2.2849077550640997,2.3574122120669005,2.3694756043039913,2.328251757558539,2.2504468763596366,2.1629851988037827,2.102822263812259,2.1157848202686944,2.254397385327342,2.5747595149767686,3.132660755336081,3.9792508425199182,5.156703295543808,6.694399790934883,8.606200052411955,10.889332430905128,13.525338646548425,16.48333862220814,19.725663718919634,23.215659345897176,26.92720194928973,30.855231805926632,35.026393534915385,39.50872369893727,44.41925280144174,49.928416763986,56.260306859299746,63.688014823391825,72.5236267239921,83.10276149107197,95.76392313859655,110.82332908793332,128.5462763959298,149.1164974190214,172.60532670806003,198.94284203231564,227.89342508182682,259.03835214265496,291.76799699118993,325.28594449186136,358.626740027855,390.68813396000184,420.27754918628284,446.1711674348501,467.18260489252026,482.2367859767016,490.44351884784044,491.1646302893347,484.06849337566473,469.16645008444135,446.8269535642214,417.7651024906428,383.0074257856976,343.8340734851395,301.7027275695624,258.1603130192681,214.74974558603907,172.91935350361842,133.9422142395558,98.85152114376928,68.39639294728184,43.02047652740044,22.863517910672485,7.784034558367662,-2.6004776991671257,-8.860581320205947,-11.694604215386363,-11.86652291601007,-10.147088528525208,-7.2624074176778315,-3.853050460721346,-0.4454883836604234,2.563624165351331,4.910945461660328,6.459291315354562,7.182058501560513,7.141827406402185,6.465829319094082,5.320800863500947,3.8893911472200373,2.3497995236235605,0.8597681222814771,-0.454506588695949,-1.504494526052255,-2.2408695220263932,-2.6511746696378395,-2.7545355093997728,-2.5944341431626965,-2.23054600558898,-1.7305441010987819,-1.1626162433020042,-0.5892439880879009,-0.06258138308765189,0.37843167027541136,0.709266024115939,0.9194981781538079,1.0112933638374146,0.9970245219448104,0.8963914276844203,0.7333852785226256,0.533397543424932,0.3207067628962298,0.11650235864650718,-0.062471305240517395,-0.2046373872582613,-0.30372131346102915,-0.35838814646261313,-0.3715016522706711,-0.3491372087698853,-0.29947967446661045,-0.23172476681688586,-0.15508152361993832,-0.07794737994002882,-0.0072994979334081705,0.051680945521501306,0.09575853899936075,0.12359347600109563,0.13553078215013006,0.13327575596226035,0.11950445497942368,0.09745535160644773,0.07054192579240295,0.04201715911044437,0.014710859723028673,-0.009149408238710964,-0.02803236560241534,-0.041118450116228944,-0.04824896472030349,-0.04982504133272225,-0.046674196867650855,-0.039902054869998344,-0.030745068024980664,-0.020437226751584693,-0.010100225622006881,-0.000662812061645648,0.007188563726336981,0.013028844951195832,0.016686778586854724,0.018215970376473725,0.017850893867442586,0.015954407320667694,0.012962948572785403,0.009334709747171908,0.005504903135897038,0.0018508791968018102,-0.0013315040509546503,-0.0038401102561479174,-0.005568247521719578,-0.006497562458101179,-0.006684279614896711,-0.006241175996637028,-0.0053176448463617965,-0.0040799631949805055,-0.0026934908346973865,-0.0013080546012120148,-4.7268631330494375e-05,0.0009979413020042359,0.0017717636678031298,0.002252366526763447,0.00244792446492821,0.002390656958737477,0.002129757547734108,0.0017240389959341529,0.0012350011422262509,0.0007208671681161785,0.00023195233899991205,-0.0001924532551074972,-0.0005256733623586359,-0.0007538301699291707,-0.0008748531258008064,-0.000896605527553557,-0.0008344500801487444,-0.0007085687583742765,-0.000541319289394562,-0.00035485808109199694,-0.00016919554702378537,-7.822111739424066e-07,0.00013834060349650996,0.00024084803997107254,0.0003039639680289114,0.00032891603930206383,0.00032012799009960584,0.0002842671703102978,0.00022925764507761585,0.00016335305482420448,9.43416596473704e-05,2.8931556431228094e-05,-2.7660408270667958e-05,-7.191480854045898e-05,-0.00010202819463335026,-0.00011777508363381448,-0.00012025301177967197,-0.00011155381564338933,-9.440337556355272e-05,-7.180750997812898e-05,-4.673458923309247e-05,-2.1856827207918993e-05,6.368621380298105e-07,1.9152197512686313e-05,3.272832075640249e-05,4.1013225618168633e-05,4.418906657805014e-05,4.286275938490235e-05,3.7937699515797256e-05,3.048135289150657e-05,2.1601269811134737e-05,1.2339132339846428e-05,3.5891586112098878e-06,-3.9560912949195e-06,-9.832442481415966e-06,-1.3805765653381785e-05,-1.5852792478037613e-05,-1.612643414975044e-05,-1.4911403740091469e-05,-1.2575798066216767e-05,-9.523669851583515e-06,-6.152655424476779e-06,-2.819562749431589e-06,1.843931125842338e-07,2.648176180228853e-06,4.445808471939263e-06,5.532798034199734e-06,5.935908538936871e-06,5.7383453834500995e-06,5.062481049573696e-06,4.052092287198715e-06,2.8557814219171652e-06,1.6128567403399146e-06,4.4250490857832674e-07,-5.633509919127729e-07,-1.3435121698398149e-06,-1.8676161087597006e-06,-2.1334736221983487e-06,-2.1623526951846683e-06,-1.9929884767508828e-06,-1.6750767470936781e-06,-1.2629223143855544e-06,-8.097828992060118e-07,-3.632926847623591e-07,3.781373644147379e-08,3.6561096775756897e-07,6.035935318448822e-07,7.461595688026193e-07,7.972101210041447e-07,7.681433613287151e-07,6.755285002500177e-07,5.387231062862421e-07,3.776566673912459e-07,2.1094953158438353e-07,5.447691730173962e-08,-7.957120837303821e-08,-1.8313675826633173e-07,-2.522927351668744e-07,-2.868730719748972e-07,-2.8983058456544245e-07,-2.664278616298022e-07,-2.2336261392839916e-07,-1.679172064277676e-07,-1.0720433137942613e-07,-4.755967078759038e-08,5.889593026993886e-09,4.947231605570724e-08,8.104676347976261e-08,9.992351467559901e-08,1.0667100251017175e-07,1.0284160877280442e-07,9.065684228581998e-08,7.268718479891032e-08,5.155657062787652e-08,2.9694124004979413e-08,9.147655428929485e-09,-8.534636005990498e-09,-2.235509518936275e-08,-3.18570279630771e-08,-3.706586555302556e-08],"type":"scatter"},{"name":"Epd=deconv(I_pd)","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149],"y":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,2.0,2.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,3.0,5.0,7.0,10.0,14.0,17.0,20.0,23.0,26.0,29.0,32.0,34.0,37.0,40.0,43.0,48.0,54.0,62.0,72.0,85.0,101.0,121.0,144.0,170.0,199.0,231.0,265.0,299.0,334.0,367.0,398.0,426.0,449.0,467.0,479.0,483.0,481.0,471.0,454.0,431.0,402.0,368.0,330.0,291.0,250.0,209.0,169.0,132.0,99.0,69.0,44.0,23.0,7.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,3.0,5.0,6.0,6.0,5.0,4.0,3.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],"type":"scatter"},{"name":"I_pd","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149],"y":[0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,1,2,0,0,3,1,0,1,1,0,2,3,4,6,6,5,6,3,3,8,11,16,7,14,19,32,22,29,32,45,49,60,50,74,78,91,88,119,123,148,169,202,206,270,268,308,351,321,352,398,422,449,405,444,433,425,418,369,351,317,307,268,225,177,147,139,121,104,89,71,58,49,36,38,24,22,20,14,9,12,3,4,4,3,3,3,2,0,3,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"type":"scatter"},{"name":"Ipd=lowpass(I_pd)","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149],"y":[-0.004665732293375797,0.023881154914322186,0.05214023281057586,0.07866820227036907,0.10201573513950934,0.12081372154529332,0.13387226097945978,0.14028696306819313,0.1395440849059319,0.1316141068296061,0.11702324831965039,0.09689423804364633,0.07295062985489657,0.04748192804870102,0.023268922093694345,0.003469865060882497,-0.00853104528081242,-0.009310381831997798,0.004376851314451437,0.035355617684152345,0.08577619170070613,0.15686229507595498,0.2486835608400104,0.3599793358351321,0.48806460413699115,0.6288494062083128,0.77699984952767,0.9262619210680373,1.0699595080852546,1.20166574099434,1.3160318794856292,1.4097402104699688,1.4825271870052887,1.5382015527891244,1.5855610825844397,1.6390928330244356,1.7193289114075903,1.8527284380699696,2.070973823352238,2.409612431460446,2.906046610868183,3.59697312181867,4.5154861707955485,5.688167882470327,7.132573282340605,8.85555259277652,10.852828674151343,13.110160505053111,15.606284266048565,18.317646298860293,21.224740637163258,24.319651635153917,27.614198422077383,31.147907450399785,34.994925898613744,39.26894754582699,44.12526306797323,49.75917685835501,56.40025817371097,64.30220934709666,73.72851369878452,84.93443291482947,98.14631640002855,113.53952297116605,131.2165003190115,151.18668936836767,173.34990383417735,197.48468397676822,223.24285786476133,250.15119273127902,277.620615281316,304.96305210206214,331.4155105589166,356.170594952934,378.41222696377486,397.3549038405006,412.2843912561289,422.5973624522381,427.8372549276189,427.7236133918512,422.1724662029968,411.30582525948705,395.44915610764696,375.11657388822766,350.98450456888213,323.85551043436544,294.6148060479269,264.18259719562894,233.46570870136713,203.31200486724026,174.47083780700706,147.56218444052837,123.05628773774876,101.26459517358367,82.34172949949772,66.29728311934879,53.015508502732935,42.28053519323453,33.80457928503736,27.256691562764644,22.289868471095378,18.564772901866135,15.768824868870496,13.629970827515235,11.92497287988408,10.482530429378688,9.181922290620957,7.9481146249156005,6.744411133461438,5.563732660586929,4.419522448360827,3.3371087172726592,2.346149678012027,1.4745668314624176,0.7441636213900142,0.16794424710992628,-0.2509983501289588,-0.5192609383078414,-0.6518740873505459,-0.6703378476037544,-0.6002711814053145,-0.4689696016999831,-0.3031199726877094,-0.12686409366335483,0.03966063823955047,0.18123907422181645,0.2879499354866724,0.3550378323420448,0.3823718646779449,0.3736023721394861,0.33513795540332986,0.27506187392684495,0.20209302320649472,0.12467525463041455,0.050253247079638505,-0.015233389870566067,-0.06763097331916844,-0.10464197868932552,-0.12571533330487333,-0.13179817207014752,-0.12499560660339278,-0.10818515219678326,-0.08462836303539807,-0.05761504071159487,-0.030166285988913716,-0.004812805746928788,0.01654471892995644,0.03269493613637577,0.04310342425025364,0.047842136059787356,0.04747708019448093,0.0429315193431715,0.035341149533245894,0.02591557860080421,0.01581736893357105,0.006066380777188928,-0.002526453639862498,-0.009395142276595096,-0.014226483351282656,-0.016943962500911378,-0.017673311958808002,-0.01669600593554395,-0.014396950294466535,-0.011212052276895191,-0.007580375515241025,-0.0039043556119017254,-0.0005202255213836184,0.002320486926545974,0.004458666627786962,0.005825717356673321,0.006433909713917551,0.006361185952177891,0.0057327458594886044,0.004701620292809095,0.0034301447050242417,0.0020738311879844873,0.0007686619824411454,-0.000377656658473616,-0.0012903891895267414,-0.0019287009022138778,-0.0022833966651024844,-0.002372226712169946,-0.002233603086491035,-0.0019195652891585945,-0.0014887545795531467,-0.0010000232002505118,-0.0005071388837328291,-5.4866872300439766e-05,0.00032346060795364616,0.0006069295559470594,0.0007867480239314024,0.0008649184193477865,0.0008521767474221746,0.0007655107304734757,0.000625551987689463,0.0004540972514134642,0.0002719576146504696,9.7270801633387e-05,-5.565345373003378e-05,-0.00017694469052427625,-0.0002612797669608847,-0.00030756574748261144,-0.0003183000865023847,-0.00029872153776273793,-0.0002558641432028824,-0.00019761572823500723,-0.00013186424536621932,-6.579292901868212e-05,-5.361299484700082e-06,4.501400950451826e-05,8.258491647916939e-05,0.00010622655750029869,0.00011625481329026725,0.00011414691101208017,0.00010220696367610219,8.321593201609272e-05,6.010000198973638e-05,3.5643799330341165e-05,1.226624999824307e-05,-8.131807018721642e-06,-2.424714707004164e-05,-3.538642330655547e-05,-4.1421796932281067e-05,-4.270377205254462e-05,-3.9946484463283285e-05,-3.410049658614471e-05,-2.6226643001814312e-05,-1.738201588023932e-05,-8.526161595498853e-06,-4.52346743438815e-07,6.254335240654637e-06,1.123295277505663e-05,1.433990758142822e-05,1.5623876907344026e-05,1.5287943545318826e-05,1.3644531119733126e-05,1.1068425669779638e-05,7.952414884142923e-06,4.6690524685428955e-06,1.5408963413256453e-06,-1.179597282612997e-06,-3.320410730845605e-06,-4.791312090106996e-06,-5.577659631912005e-06,-5.7285320268417e-06,-5.341234184221141e-06,-4.5441950493516015e-06,-3.4800658585672118e-06,-2.2904941551626765e-06,-1.1036419348311525e-06,-2.508483395885026e-08,8.6768387480859e-07,1.5272818326415662e-06,1.9354219323320294e-06,2.099473916262167e-06,2.047332847548439e-06,1.8213481609054537e-06,1.4720195454507589e-06,1.0520636227328138e-06,6.113169589743731e-07,1.9278505911354396e-07,-1.7000939374439513e-07,-4.5436860693561527e-07,-6.485604622834987e-07,-7.509548708589885e-07,-7.684079927328432e-07,-7.141698462910047e-07,-6.055853918173555e-07,-4.6183054740236386e-07,-3.0187938109593636e-07,-1.4284385265924913e-07,1.2304629130151503e-09,1.2008453736465165e-07,2.0750198072456748e-07,2.6115909694703084e-07,2.82153122259272e-07,2.7430695947078875e-07,2.433515727439642e-07,1.9608051809052555e-07,1.3955711357226422e-07,8.043601539791664e-08,2.44399651812446e-08,-2.3988520532685673e-08,-6.185986014251134e-08,-8.764970837677086e-08,-1.0117777930178901e-07,-1.0338741076752345e-07,-9.606305040540066e-08,-8.15219582128185e-08,-6.231243304354062e-08,-4.094467058210435e-08,-1.9672882482461793e-08,-3.3943724647907555e-10,1.5715707140228974e-08,2.7683515913482307e-08,3.526068113698756e-08,3.858254990657042e-08,3.8127836811843244e-08,3.460905514844742e-08,2.8861553601352653e-08],"type":"scatter"},{"name":"Ipd=conv(E_pd)","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149],"y":[0.0,0.0009302035896325833,0.058760213940768156,0.14970343435668837,0.23686998498496906,0.3040674493756524,0.3452234705689443,0.35999797781263626,0.3512940582863848,0.32371247438323736,0.2825696059386792,0.2332872351455444,0.1810412658396899,0.13059258499144108,0.08624038211903098,0.05184685591830203,0.03088790441411902,0.026490313789095127,0.04142395629804014,0.07802841171345336,0.1380672154416118,0.2225187697690285,0.3313292321430214,0.46316723683500244,0.6152307284276537,0.7831604033737222,0.9611109670078714,1.1420203722780091,1.3180992093521298,1.4815390683122514,1.6254121513370903,1.7447071817019053,1.8374214811196916,1.9056087366002263,1.956269089076143,2.0019651776008183,2.0610568327957366,2.1574698892904336,2.3199516999851437,2.5808163164444875,2.974242684524977,3.5342540073853423,4.292568144956115,5.2765590613822315,6.50759973036883,8.000061031211631,9.761215074248598,11.79223415811804,14.090390303672649,16.65245005189501,19.479132688171386,22.58036747623569,25.980959044064157,29.726162776898555,33.886595949524384,38.56187456650393,43.88237599247121,50.008585574451,57.127591044198184,65.44643873071837,75.18225565203392,86.54926502194714,99.74307219338448,114.92286438560997,132.19243761186306,151.58121893200635,173.02666614665756,196.35957074916575,221.29383295796404,247.42219260084488,274.2191663629078,301.05205210324925,327.2003228251683,351.88307528399196,374.29347229408216,393.6383944119061,409.18087826047594,420.28244717389254,426.44220376019433,427.32959890478236,422.808133404657,412.94786948059584,398.0254794482774,378.51155834860145,355.04597615554036,328.4030347286428,299.4490221917974,269.0953391237098,238.2506521043185,207.77549098642152,178.44236307674655,150.90385886169284,125.6704429915107,103.09874786674936,83.39030527479204,66.59984698942979,52.65164573252626,41.36190018661338,32.46491506630861,25.640789525177635,20.54248372880079,16.82044755824812,14.143420040920851,12.214491830529319,10.782015810572279,9.645408668733717,8.656274497624727,7.715576848733884,6.767776705116944,5.792940065934452,4.797809108913083,3.806741125286559,2.8532700103089788,1.9728583892232152,1.1972064477382676,0.5502859438920613,0.046090796456731545,-0.31204929032681256,-0.530851600463672,-0.6254835282642217,-0.6173347910798915,-0.5314973757615256,-0.3942539117888495,-0.23081761744585158,-0.06349835581106486,0.08960232210232161,0.21533210218929466,0.30568842989756584,0.35754819454388215,0.3720275098519416,0.35358912397567943,0.3090179607277687,0.24637678613249153,0.17403680853817818,0.09985523590013941,0.030546468049224226,-0.028731573047506825,-0.0745772393546682,-0.10535107525296612,-0.12102156993053279,-0.12289279491966663,-0.11325912766384352,-0.09503083996916024,-0.07136925676427797,-0.04536255276495387,-0.019764179749070694,0.003193535070167915,0.021906999522538433,0.035434241020044145,0.04346310981052952,0.04622888289754062,0.044397424003645346,0.03893032196174854,0.030947181836463958,0.021597855788497808,0.011954286279957094,0.0029281978775815964,-0.004782521075076971,-0.010718963031426238,-0.01466059355361535,-0.01660343853410268,-0.016722714784782513,-0.015325957194495459,-0.012802489085165689,-0.009574389517106284,-0.006053078778595591,-0.0026044225954456124,0.0004760114200325916,0.0029771036128795458,0.004776320610540097,0.0058352174675519565,0.006188210935463304,0.005926799950598252,0.00518143690672332,0.004103079057426839,0.002846124208161882,0.0015540140850373518,0.00034832667074340405,-0.0006782761281709782,-0.0014652874708957597,-0.0019841566328270234,-0.0022352692627234205,-0.002242868451388631,-0.0020487294350941456,-0.0017053704201146047,-0.0012694870473208652,-0.0007961581732003253,-0.00033420624103804643,7.707446855349077e-05,0.0004097678308406216,0.0006478466689215168,0.0007865321722387009,0.0008307599041862624,0.0007930452197889882,0.0006910435317428032,0.0005450766233009752,0.00037585196189147133,0.00020254515575714117,4.135358502789899e-05,-9.543169526153861e-05,-0.0001998432046430487,-0.0002681952145411515,-0.00030066662344536255,-0.0003006112302186281,-0.0002737045598182375,-0.00022703197121668684,-0.00016820976547218258,-0.00010461207386888382,-4.275416569382351e-05,1.2139989429957865e-05,5.637938700378875e-05,8.786854465326676e-05,0.00010601658683898841,0.00011152773564251817,0.000106112604207107,9.215989612539666e-05,7.240474929326112e-05,4.9623943312491205e-05,2.6380522683671083e-05,4.832038978799247e-06,-1.3391543888632285e-05,-2.7241517134140027e-05,-3.624280010256165e-05,-4.043638738608468e-05,-4.028571535060532e-05,-3.6561605680586195e-05,-3.0219800709146427e-05,-2.2283325610323314e-05,-1.373934668671417e-05,-5.457215383233294e-06,1.8686729493277988e-06,7.750425140697903e-06,1.1914245162871762e-05,1.4287573885374273e-05,1.4970490069455834e-05,1.4196671117692184e-05,1.2289221763035624e-05,9.616212781491385e-06,6.549953514150275e-06,3.4329848900743755e-06,5.526621771423379e-07,-1.8749011087493273e-06,-3.7117237161510277e-06,-4.896664663647244e-06,-5.437490449367033e-06,-5.398168223109679e-06,-4.883351916760148e-06,-4.021938129881164e-06,-2.951322062472173e-06,-1.803639138415747e-06,-6.948751024538069e-07,2.8268239702811117e-07,1.0645586417012964e-06,1.6150041392393178e-06,1.9251811272624765e-06,2.0092615193334496e-06,1.899149239079634e-06,1.638537973462917e-06,1.2769516621347066e-06,8.643027018706561e-07,4.46364595347859e-07,6.140313558944399e-08,-2.619336430598196e-07,-5.054985369667975e-07,-6.614361507217837e-07,-7.310902370250005e-07,-7.232798317602374e-07,-6.522079312532014e-07,-5.352536096836502e-07,-3.908655227746749e-07,-2.3672663573393038e-07,-8.830785635183247e-08,4.212862569019649e-08,1.4606542351636164e-07,2.1883816883061514e-07,2.593799569261535e-07,2.696894630238589e-07,2.541173660919327e-07,2.1856731127201102e-07,1.6969747520079182e-07,1.14193704678911e-07,5.816738948283273e-08,6.709804960536303e-09,-3.638494593616315e-08,-6.873187019085237e-08,-8.932223696245246e-08,-9.837258493128332e-08,-9.709088410581046e-08,-8.739490797715632e-08,-7.16162656466679e-08,-5.221912663166961e-08,-3.155692367862173e-08,-1.1681372908967091e-08,5.787667554102427e-09,1.973021716672463e-08,2.9537410908275775e-08,3.507460710650001e-08,3.66080501579269e-08,3.4708593825705236e-08,3.0144742089177614e-08,2.377740377035309e-08,1.6497863040143557e-08,1.1052321431392897e-08,7.506160959458442e-09,5.111165832794029e-09,3.473470283621438e-09,2.348205070945575e-09,1.574248080227214e-09,1.0428539898299504e-09,6.795009022120269e-10,4.326227132089855e-10,2.6629786153975487e-10,1.556120410306505e-10,8.312810884092415e-11,3.666639547539319e-11,7.849290106776152e-12,-9.172049925121328e-12,-1.8488588438003716e-11,-2.2728454951437272e-11,-2.3942098859031092e-11,-2.3210304789245128e-11,-2.1500454749912024e-11,-1.9354047253727914e-11,-1.6952981241047383e-11,-1.4551915228366852e-11,-1.2369127944111824e-11,-1.0440999176353217e-11,-8.676579454913736e-12,-7.2213879320770506e-12,-5.893525667488575e-12,-4.8385118134319785e-12,-3.92901711165905e-12,-3.183231456205249e-12,-2.582964953035116e-12,-2.0827428670600057e-12,-1.6643753042444587e-12,-1.3278622645884752e-12,-1.0868461686186493e-12,-8.276401786133647e-13,-6.752998160663993e-13,-5.184119800105692e-13,-4.1382008930668236e-13,-3.149125404888764e-13,-2.6261659513693303e-13,-1.8758328224066646e-13,-1.5290879673557356e-13,-8.01492205937393e-14,-9.947598300641403e-14,-7.332801033044234e-14,-4.6611603465862576e-14,-3.154809746774845e-14,-3.410605131648481e-14,-1.3073986337985844e-14,-2.842170943040401e-14,-9.379164112033323e-15,3.161915174132446e-15,-1.6830981053317373e-14,1.7568169141668478e-14,-1.3855583347321954e-15,-1.5631940186722204e-15,1.1688428003253648e-14,1.6555645743210335e-14,1.9895196601282807e-15,-1.3571366253017915e-14,-2.3492319201068312e-14,-5.080380560684716e-15,-2.806643806252396e-15,-6.608047442568932e-15,1.1723955140041654e-15,4.405364961712621e-15,-1.4921397450962103e-15,-1.4992451724538113e-14,-1.3820056210533949e-14,2.415845301584341e-15,-1.7061907442439406e-14,-4.640732242933155e-15,3.892441924335799e-15,1.0551559626037488e-14,5.133671265866724e-15,-2.637889906509372e-15,-4.7339909770016676e-15,-6.927791673660977e-15,-3.4621194799910885e-14,-4.947153797729698e-15,8.29114554790067e-15,1.6530110613643957e-14,-1.8250401190300635e-14,-1.2991829834163581e-14,-1.4417356197782284e-14,-3.851585717029593e-14,-1.9069190670961688e-14,9.690026558928366e-15,-5.3623772089395066e-15,-9.410250356722827e-15,-2.298161660974074e-15,2.1894708268632713e-14,-2.7257085477572217e-14,9.919287613513461e-15,-5.2469140143784896e-15],"type":"scatter"},{"name":"Ipd=conv(deconv(Ipd))","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149],"y":[0.0,-1.8189894035458565e-14,0.0,-1.8189894035458565e-14,1.8189894035458565e-14,-1.8189894035458565e-14,0.0,0.0,0.0,0.0,1.8189894035458565e-14,3.637978807091713e-14,-9.094947017729283e-15,0.0,1.3642420526593923e-14,1.8189894035458565e-14,2.0463630789890885e-14,2.955857780762017e-14,2.0463630789890885e-14,3.069544618483633e-14,0.0008495563537894668,0.05381602306081163,0.14638954646448724,0.25263006327093307,0.4107780929308132,0.6008343465136864,0.741652962124212,0.8316682656618931,0.8902883702394115,0.8769141547409066,0.8106742601116017,0.7226846984463132,0.6288690591067334,0.5378304672800343,0.4539961400295407,0.379328741745968,0.31519333861397897,0.31424978974655277,0.4674805912791622,0.8263721522209835,1.4033908441202396,2.243483083236076,3.4198489066180002,4.911078959913335,6.667617454569761,8.647967985344264,10.815781019789084,13.139447867437799,15.590976890164184,18.0960680273019,20.64788281394526,23.257095745109105,25.925106780462468,28.75268666838332,31.86699958986524,35.43298053294236,39.64300774144625,44.74141719849104,51.0003964200463,58.73798734698525,68.23942896989493,79.73648646462487,93.41949197562217,109.44372737654354,127.88218569553123,148.64120637385707,171.56508770390377,196.33983994077892,222.53867998556285,249.65520792056742,277.0550682957467,304.0473960125945,329.9070949479187,353.82108833187317,375.0554623997275,392.8987900296201,406.7157333805477,416.0239312046417,420.4684341656775,419.83567148336357,414.07107957190294,403.37629627112955,388.07034065485743,368.5966798247886,345.5225827751788,319.56043025548837,291.5329455702334,262.2291519236059,232.45385291014856,202.950060007633,174.415282699502,147.69968448381078,123.62900970262646,102.56010512663141,84.47321261761212,69.16542546766999,56.35050919265298,45.71527707472634,36.95127497197134,29.7716864165243,23.921839297835177,19.332210763074407,15.875322346921338,13.333211719450679,11.46249993767016,10.024143886259848,8.84875422994216,7.8294207936729565,6.847151648641934,5.872261672121461,4.956757001166533,4.136956574458485,3.4229056952813615,2.8125191365767854,2.297840826630459,1.868390465528283,1.5130216800635417,1.2209384663368281,0.9822167529247221,0.7880325035812223,0.6307180876091508,0.5037218048960753,0.4015167774945118,0.31948745957030095,0.2538106462211385,0.2013406493176962,0.15950376199053581,0.1262043094514599,0.099742875467513,0.07874630433656632,0.06210854714720961,0.04894117875508032,0.038532345037589455,0.03031293616529707,0.023828873638519103,0.018718516927722802,0.014694321523812228,0.011528002958625843,0.009038575253281294,0.007082734404549374,0.00554714684990622,0.0043422796272181196,0.0033974740524871315,0.0026570197606946245,0.0020770312000383145,0.001622966429297732,0.0012676589424368801,0.000989758508290536,0.0007724974358389834,0.0006027156031796055,0.0004700906222792778,0.0003665306092760907,0.00028569575184445115,0.0002226215158608574,0.00017342225821709848,0.00013505818521832374,0.00010515231030362811,8.184671591558723e-05,6.368983172244063e-05,4.9547993744746626e-05,3.8536153433597064e-05,2.9963604233671504e-05,2.329151169760735e-05,1.8099680737577728e-05,1.4060492467251607e-05,1.0918653852058925e-05,8.475247400383523e-06,6.575343554686697e-06,5.098328315398248e-06,3.950299187636119e-06,3.0581860914935532e-06,2.3651653123124563e-06,1.8269940278514696e-06,1.4092966193857137e-06,1.0853240030428424e-06,8.342621219981084e-07,6.399326559858309e-07,4.89744977016926e-07,3.7389858732694846e-07,2.8472651536048943e-07,2.1629206315765258e-07,1.639493888205834e-07,1.2407367790956414e-07,9.381533800478793e-08,7.094500503512791e-08,5.3750746928926675e-08,4.086850196927117e-08,3.1258126398370224e-08,2.4095028621218262e-08,1.86680511404802e-08,1.4461789064057485e-08,1.1202019791767271e-08,8.676150393682747e-09,6.719090919204973e-09,5.202945914106749e-09,4.02852798231379e-09,3.11889525761444e-09,2.414426170105344e-09,1.868903378721143e-09,1.3927663466972717e-09,9.88356809727975e-10,6.57439596096765e-10,4.0128172784648086e-10,2.209712679501763e-10,9.933217803848038e-11,2.3141399907444794e-11,-1.660449555629384e-14,-1.4517276269998546e-14,-5.293543381412746e-15,-4.596323321948148e-15,-7.904787935331115e-16,1.8696155734687636e-15,-8.700817843987352e-15,9.404699241599702e-15,1.3500311979441904e-15,1.0007550343971161e-14,-4.667932707036471e-15,1.1494694085456558e-14,2.291888900884942e-14,-1.1177725411926077e-14,-1.2718437414349638e-14,-6.9373673472483686e-15,-1.4201001485858457e-14,-2.6203761382959102e-14,-1.4170678519498381e-14,2.000483112496454e-15,5.186025220371704e-15,1.8258623779576768e-14,-1.0615397449953435e-14,-5.851742701512564e-15,1.3750684618729637e-14,-3.804640630322709e-14,1.6946895275982142e-14,2.7173055472395903e-14,5.852302149833566e-15,1.3915912693007737e-14,-5.245821138588625e-15,-3.0190682853009634e-14,-1.1924578078442717e-14,-3.173433954853366e-14,-4.5474735088646414e-14,-5.0022208597511053e-14,-5.456968210637569e-14,-4.5474735088646414e-14,-3.637978807091713e-14,-9.094947017729283e-15,-1.3642420526593923e-14,-4.092726157978177e-14,-1.3642420526593923e-14,-2.7284841053187846e-14,-2.0463630789890885e-14,-6.8212102632969615e-15,-2.2737367544323206e-15,-9.094947017729283e-15,-3.069544618483633e-14,-2.842170943040401e-14,1.1368683772161603e-15,-1.4210854715202004e-14,-1.1937117960769683e-14,-7.389644451905042e-15,-1.0516032489249483e-14,1.7053025658242404e-15,-1.7905676941154525e-14,3.4106051316484808e-15,1.5631940186722204e-15,-1.8189894035458565e-14,-1.3073986337985844e-14,1.2789769243681804e-14,9.237055564881303e-16,9.592326932761353e-15,-1.3997691894473973e-14,1.7124079931818415e-14,8.633094239485218e-15,1.5347723092418165e-14,1.5631940186722205e-14,1.3855583347321953e-14,1.666222715357435e-14,5.943689984633238e-14,1.1350920203767601e-14,4.652278562389256e-14,2.4229507289419417e-14,3.128164394183841e-14,1.8314239014216583e-14,2.7844393457598927e-14,2.3296919948734285e-14,4.304112621866807e-14,2.854161351706352e-14,1.4517276269998546e-14,2.8030910925735954e-14,3.642863788400064e-14,2.5233148903680558e-14,6.088463067044359e-15,9.837686221203512e-15,3.720690422426287e-14,-2.486899575160351e-15,-1.2281287098403482e-14,2.5131563496927357e-14,8.968936704434327e-15,-2.455258218958534e-15,-2.4646951146678474e-15],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(237,237,237)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(51,51,51)"},"error_y":{"color":"rgb(51,51,51)"},"marker":{"line":{"color":"rgb(237,237,237)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(51,51,51)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(51,51,51)"},"baxis":{"endlinecolor":"rgb(51,51,51)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(51,51,51)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"colorscale":{"sequential":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"sequentialminus":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]]},"colorway":["#F8766D","#A3A500","#00BF7D","#00B0F6","#E76BF3"],"font":{"color":"rgb(51,51,51)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"rgb(237,237,237)","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","paper_bgcolor":"white","plot_bgcolor":"rgb(237,237,237)","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"},"bgcolor":"rgb(237,237,237)","radialaxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"rgb(237,237,237)","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"rgb(237,237,237)","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"rgb(237,237,237)","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","zerolinecolor":"white"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"},"baxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"},"bgcolor":"rgb(237,237,237)","caxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"}},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","title":{"standoff":15},"zerolinecolor":"white"},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","title":{"standoff":15},"zerolinecolor":"white"}}},"title":{"text":"$\\text{Actual } E_{pd} \\text{ vs. deconvolution of } I_{pd}$","x":0.5,"xanchor":"center"},"height":500,"xaxis":{"title":{"text":"Day"}},"yaxis":{"title":{"text":"Count"}}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('f7529f7c-e6ba-4eb4-a676-688e95b7b742');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>The iterative deconvolution seems to work nicely and we get close results.</p>
</section>
<section id="comparing-i_pd-from-the-model-to-i_pd-obtained-by-de-convolving-r_pd" class="level3">
<h3 class="anchored" data-anchor-id="comparing-i_pd-from-the-model-to-i_pd-obtained-by-de-convolving-r_pd">Comparing <span class="math inline">\(I_{pd}\)</span> from the model to <span class="math inline">\(I_{pd}\)</span> obtained by de-convolving <span class="math inline">\(R_{pd}\)</span></h3>
<p>Let’s try the same thing but using <span class="math inline">\(R_{pd}\)</span> to get <span class="math inline">\(I_{pd}\)</span>:</p>
<div class="cell" data-outputid="d4e785ff-ad76-4c90-b22e-6dcc5b140e73" data-execution_count="72">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#regularization parameter</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>alpha<span class="op">=</span><span class="dv">2</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup up the resultant Ipd we want to compare our guess with</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>Rpd<span class="op">=</span>np.floor(lowpass(results_stoch0[<span class="dv">6</span>]))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>Rpd[Rpd<span class="op">&lt;</span><span class="dv">0</span>]<span class="op">=</span><span class="dv">0</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Find delay caused by h_I</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>delay<span class="op">=</span>Rpd.argmax()<span class="op">-</span>signal.fftconvolve(Rpd, h_I, mode<span class="op">=</span><span class="st">'full'</span>).argmax()</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co"># We want initial guess to simply be the result of the convolution delayed</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>initial_guess<span class="op">=</span>np.roll(Rpd,delay)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>Inext <span class="op">=</span> initial_guess</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co"># AN array to record MSE between result we want and our iterated guess</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>mse<span class="op">=</span>np.array([])</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>mse<span class="op">=</span>np.append(mse, <span class="dv">100000</span>)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>mse<span class="op">=</span>np.append(mse, msecalc(Rpd, signal.fftconvolve(h_I, Inext, mode<span class="op">=</span><span class="st">'full'</span>)[:<span class="bu">len</span>(Rpd)]))</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>itercount<span class="op">=</span><span class="dv">0</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> mse[<span class="op">-</span><span class="dv">1</span>] <span class="op">&lt;</span> mse[<span class="op">-</span><span class="dv">2</span>]:</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  itercount<span class="op">=</span>itercount<span class="op">+</span><span class="dv">1</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>  Inext<span class="op">=</span>iter_deconv(alpha, h_I, Inext, delay, Rpd)</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>  mse<span class="op">=</span>np.append(mse, msecalc(Rpd, signal.fftconvolve(h_I, Inext, mode<span class="op">=</span><span class="st">'full'</span>)[:<span class="bu">len</span>(Rpd)]))</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">"Iteration #"</span> <span class="op">+</span> <span class="bu">str</span>(itercount) <span class="op">+</span><span class="st">": MSE= "</span><span class="op">+</span><span class="bu">str</span>(mse[itercount]))</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Iteration #"</span> <span class="op">+</span> <span class="bu">str</span>(itercount<span class="op">+</span><span class="dv">1</span>) <span class="op">+</span><span class="st">": MSE= "</span><span class="op">+</span><span class="bu">str</span>(mse[<span class="op">-</span><span class="dv">1</span>])<span class="op">+</span><span class="st">" so we use the result of the previous iteration."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Iteration #1: MSE= 158.36329203883318
Iteration #2: MSE= 24.083634517524207
Iteration #3: MSE= 14.352400928616078
Iteration #4: MSE= 9.37969578473627
Iteration #5: MSE= 8.787177629318526
Iteration #6: MSE= 6.4946509987201235
Iteration #7: MSE= 6.2581997082461465
Iteration #8: MSE= 4.676152649019021
Iteration #9: MSE= 4.7242422458595845 so we use the result of the previous iteration.</code></pre>
</div>
</div>
<div class="cell" data-outputid="7cb8ce23-05c4-4a92-c04b-d01472fbc4bf" data-execution_count="73">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure(data<span class="op">=</span>[    </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'Ipd'</span>, x<span class="op">=</span>np.arange(<span class="dv">150</span>), y<span class="op">=</span>results_stoch0[<span class="dv">5</span>]),</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'Ipd=lowpass(Ipd)'</span>, x<span class="op">=</span>np.arange(<span class="dv">150</span>), y<span class="op">=</span>lowpass(results_stoch0[<span class="dv">5</span>])),</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'Ipd=deconv(Rpd)'</span>, x<span class="op">=</span>np.arange(<span class="dv">150</span>), y<span class="op">=</span>Inext),</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'Rpd'</span>, x<span class="op">=</span>np.arange(<span class="dv">150</span>), y<span class="op">=</span>results_stoch0[<span class="dv">6</span>]),</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'Rpd=conv(Inext)'</span>, x<span class="op">=</span>np.arange(<span class="dv">150</span>), y<span class="op">=</span>signal.fftconvolve(h_I, Inext, mode<span class="op">=</span><span class="st">'full'</span>)),</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'Rpd=lowpass(Rpd)'</span>, x<span class="op">=</span>np.arange(<span class="dv">150</span>), y<span class="op">=</span>lowpass(results_stoch0[<span class="dv">6</span>])),</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'Rpd=conv(deconv(Rpd))'</span>, x<span class="op">=</span>np.arange(<span class="dv">150</span>), y<span class="op">=</span>signal.fftconvolve(h_I, Inext, mode<span class="op">=</span><span class="st">'full'</span>)[:<span class="bu">len</span>(Rpd)])    </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">'ggplot2'</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">500</span>,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    xaxis_title <span class="op">=</span> <span class="st">'Day'</span>,</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    yaxis_title <span class="op">=</span> <span class="st">'Count'</span>,</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span>{</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">'text'</span>:<span class="vs">r'$\text{Actual } I_</span><span class="sc">{pd}</span><span class="vs"> \text{ vs. deconvolution of } R_</span><span class="sc">{pd}</span><span class="vs">$'</span>,</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">'x'</span>:<span class="fl">0.5</span>,</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">'xanchor'</span>:<span class="st">'center'</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="20155d4d-1e40-413c-8688-1b827dd6c8d5" class="plotly-graph-div" style="height:500px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("20155d4d-1e40-413c-8688-1b827dd6c8d5")) {                    Plotly.newPlot(                        "20155d4d-1e40-413c-8688-1b827dd6c8d5",                        [{"name":"Ipd","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149],"y":[0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,1,2,0,0,3,1,0,1,1,0,2,3,4,6,6,5,6,3,3,8,11,16,7,14,19,32,22,29,32,45,49,60,50,74,78,91,88,119,123,148,169,202,206,270,268,308,351,321,352,398,422,449,405,444,433,425,418,369,351,317,307,268,225,177,147,139,121,104,89,71,58,49,36,38,24,22,20,14,9,12,3,4,4,3,3,3,2,0,3,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"type":"scatter"},{"name":"Ipd=lowpass(Ipd)","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149],"y":[-0.004665732293375797,0.023881154914322186,0.05214023281057586,0.07866820227036907,0.10201573513950934,0.12081372154529332,0.13387226097945978,0.14028696306819313,0.1395440849059319,0.1316141068296061,0.11702324831965039,0.09689423804364633,0.07295062985489657,0.04748192804870102,0.023268922093694345,0.003469865060882497,-0.00853104528081242,-0.009310381831997798,0.004376851314451437,0.035355617684152345,0.08577619170070613,0.15686229507595498,0.2486835608400104,0.3599793358351321,0.48806460413699115,0.6288494062083128,0.77699984952767,0.9262619210680373,1.0699595080852546,1.20166574099434,1.3160318794856292,1.4097402104699688,1.4825271870052887,1.5382015527891244,1.5855610825844397,1.6390928330244356,1.7193289114075903,1.8527284380699696,2.070973823352238,2.409612431460446,2.906046610868183,3.59697312181867,4.5154861707955485,5.688167882470327,7.132573282340605,8.85555259277652,10.852828674151343,13.110160505053111,15.606284266048565,18.317646298860293,21.224740637163258,24.319651635153917,27.614198422077383,31.147907450399785,34.994925898613744,39.26894754582699,44.12526306797323,49.75917685835501,56.40025817371097,64.30220934709666,73.72851369878452,84.93443291482947,98.14631640002855,113.53952297116605,131.2165003190115,151.18668936836767,173.34990383417735,197.48468397676822,223.24285786476133,250.15119273127902,277.620615281316,304.96305210206214,331.4155105589166,356.170594952934,378.41222696377486,397.3549038405006,412.2843912561289,422.5973624522381,427.8372549276189,427.7236133918512,422.1724662029968,411.30582525948705,395.44915610764696,375.11657388822766,350.98450456888213,323.85551043436544,294.6148060479269,264.18259719562894,233.46570870136713,203.31200486724026,174.47083780700706,147.56218444052837,123.05628773774876,101.26459517358367,82.34172949949772,66.29728311934879,53.015508502732935,42.28053519323453,33.80457928503736,27.256691562764644,22.289868471095378,18.564772901866135,15.768824868870496,13.629970827515235,11.92497287988408,10.482530429378688,9.181922290620957,7.9481146249156005,6.744411133461438,5.563732660586929,4.419522448360827,3.3371087172726592,2.346149678012027,1.4745668314624176,0.7441636213900142,0.16794424710992628,-0.2509983501289588,-0.5192609383078414,-0.6518740873505459,-0.6703378476037544,-0.6002711814053145,-0.4689696016999831,-0.3031199726877094,-0.12686409366335483,0.03966063823955047,0.18123907422181645,0.2879499354866724,0.3550378323420448,0.3823718646779449,0.3736023721394861,0.33513795540332986,0.27506187392684495,0.20209302320649472,0.12467525463041455,0.050253247079638505,-0.015233389870566067,-0.06763097331916844,-0.10464197868932552,-0.12571533330487333,-0.13179817207014752,-0.12499560660339278,-0.10818515219678326,-0.08462836303539807,-0.05761504071159487,-0.030166285988913716,-0.004812805746928788,0.01654471892995644,0.03269493613637577,0.04310342425025364,0.047842136059787356,0.04747708019448093,0.0429315193431715,0.035341149533245894,0.02591557860080421,0.01581736893357105,0.006066380777188928,-0.002526453639862498,-0.009395142276595096,-0.014226483351282656,-0.016943962500911378,-0.017673311958808002,-0.01669600593554395,-0.014396950294466535,-0.011212052276895191,-0.007580375515241025,-0.0039043556119017254,-0.0005202255213836184,0.002320486926545974,0.004458666627786962,0.005825717356673321,0.006433909713917551,0.006361185952177891,0.0057327458594886044,0.004701620292809095,0.0034301447050242417,0.0020738311879844873,0.0007686619824411454,-0.000377656658473616,-0.0012903891895267414,-0.0019287009022138778,-0.0022833966651024844,-0.002372226712169946,-0.002233603086491035,-0.0019195652891585945,-0.0014887545795531467,-0.0010000232002505118,-0.0005071388837328291,-5.4866872300439766e-05,0.00032346060795364616,0.0006069295559470594,0.0007867480239314024,0.0008649184193477865,0.0008521767474221746,0.0007655107304734757,0.000625551987689463,0.0004540972514134642,0.0002719576146504696,9.7270801633387e-05,-5.565345373003378e-05,-0.00017694469052427625,-0.0002612797669608847,-0.00030756574748261144,-0.0003183000865023847,-0.00029872153776273793,-0.0002558641432028824,-0.00019761572823500723,-0.00013186424536621932,-6.579292901868212e-05,-5.361299484700082e-06,4.501400950451826e-05,8.258491647916939e-05,0.00010622655750029869,0.00011625481329026725,0.00011414691101208017,0.00010220696367610219,8.321593201609272e-05,6.010000198973638e-05,3.5643799330341165e-05,1.226624999824307e-05,-8.131807018721642e-06,-2.424714707004164e-05,-3.538642330655547e-05,-4.1421796932281067e-05,-4.270377205254462e-05,-3.9946484463283285e-05,-3.410049658614471e-05,-2.6226643001814312e-05,-1.738201588023932e-05,-8.526161595498853e-06,-4.52346743438815e-07,6.254335240654637e-06,1.123295277505663e-05,1.433990758142822e-05,1.5623876907344026e-05,1.5287943545318826e-05,1.3644531119733126e-05,1.1068425669779638e-05,7.952414884142923e-06,4.6690524685428955e-06,1.5408963413256453e-06,-1.179597282612997e-06,-3.320410730845605e-06,-4.791312090106996e-06,-5.577659631912005e-06,-5.7285320268417e-06,-5.341234184221141e-06,-4.5441950493516015e-06,-3.4800658585672118e-06,-2.2904941551626765e-06,-1.1036419348311525e-06,-2.508483395885026e-08,8.6768387480859e-07,1.5272818326415662e-06,1.9354219323320294e-06,2.099473916262167e-06,2.047332847548439e-06,1.8213481609054537e-06,1.4720195454507589e-06,1.0520636227328138e-06,6.113169589743731e-07,1.9278505911354396e-07,-1.7000939374439513e-07,-4.5436860693561527e-07,-6.485604622834987e-07,-7.509548708589885e-07,-7.684079927328432e-07,-7.141698462910047e-07,-6.055853918173555e-07,-4.6183054740236386e-07,-3.0187938109593636e-07,-1.4284385265924913e-07,1.2304629130151503e-09,1.2008453736465165e-07,2.0750198072456748e-07,2.6115909694703084e-07,2.82153122259272e-07,2.7430695947078875e-07,2.433515727439642e-07,1.9608051809052555e-07,1.3955711357226422e-07,8.043601539791664e-08,2.44399651812446e-08,-2.3988520532685673e-08,-6.185986014251134e-08,-8.764970837677086e-08,-1.0117777930178901e-07,-1.0338741076752345e-07,-9.606305040540066e-08,-8.15219582128185e-08,-6.231243304354062e-08,-4.094467058210435e-08,-1.9672882482461793e-08,-3.3943724647907555e-10,1.5715707140228974e-08,2.7683515913482307e-08,3.526068113698756e-08,3.858254990657042e-08,3.8127836811843244e-08,3.460905514844742e-08,2.8861553601352653e-08],"type":"scatter"},{"name":"Ipd=deconv(Rpd)","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149],"y":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,4.0,7.0,10.0,12.0,13.0,15.0,15.0,15.0,14.0,13.0,11.0,9.0,8.0,7.0,7.0,8.0,11.0,15.0,22.0,30.0,41.0,55.0,70.0,88.0,108.0,129.0,152.0,175.0,200.0,224.0,248.0,272.0,294.0,316.0,335.0,352.0,367.0,379.0,388.0,394.0,396.0,395.0,390.0,381.0,369.0,353.0,335.0,313.0,290.0,264.0,237.0,210.0,183.0,156.0,130.0,106.0,85.0,65.0,48.0,34.0,22.0,14.0,7.0,3.0,0.0,0.0,0.0,0.0,2.0,3.0,4.0,5.0,6.0,6.0,5.0,4.0,3.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],"type":"scatter"},{"name":"Rpd","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149],"y":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,2,1,0,2,0,1,0,0,1,2,1,1,2,3,1,2,2,4,4,9,10,11,10,13,14,17,17,19,26,29,34,31,35,44,43,68,68,77,111,98,115,117,149,170,176,178,218,249,257,248,278,276,281,271,288,289,305,315,317,342,274,325,297,284,268,234,272,228,235,197,182,177,160,149,136,103,88,100,81,81,68,54,53,51,50,30,27,21,20,18,12,15,12,7,5,4,8,4,3,3,1,0,1,0,0,2,0,1,0,1,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"type":"scatter"},{"name":"Rpd=conv(Inext)","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149],"y":[-4.547473508864641e-15,0.0,-9.094947017729283e-15,1.8189894035458565e-14,-1.8189894035458565e-14,0.0,-9.094947017729283e-15,9.094947017729283e-15,-1.8189894035458565e-14,0.0,0.0,0.0,0.0,-1.8189894035458565e-14,1.8189894035458565e-14,1.8189894035458565e-14,0.0,1.8189894035458565e-14,-1.8189894035458565e-14,1.8189894035458565e-14,0.0010044631988785112,0.004936816669523978,0.012496926434232591,0.02307288565851195,0.034963056211345246,0.04755426312438431,0.06042101846694095,0.07319879759914329,0.08555723851601214,0.09719444664882758,0.10783859664922602,0.11725228681900263,0.1252376137238025,0.13164084977149287,0.13635603188408824,0.13932702218522536,0.14054778817144326,0.1400608074567208,0.13795364227960363,0.13435385240761208,0.1314314450292977,0.13522928818942545,0.15421230303815264,0.19956345019493937,0.28260602054125683,0.41229514289278996,0.5961101859585051,0.8401354765988026,1.1461512346380618,1.5127799075725676,1.9350039888157318,2.404596704004657,2.9096896574843787,3.4373574963494598,3.9751823709953875,4.511546114481806,5.037725741928625,5.549888865097196,6.050711085599813,6.550674391009259,7.06994443972107,7.637945742093573,8.296482006620588,9.098531788304603,10.106532131894813,11.393503791280045,13.040059224846395,15.132136757475644,17.758841714765254,21.00946819324521,24.97160876224282,29.72563609332622,35.3435204814849,41.88533113377417,49.396185681736824,57.904819233872075,67.41892957133864,77.92519836619495,89.38828081472131,101.74937130038276,114.92649337417053,128.81454089483458,143.28595800779163,158.19300093325566,173.36851351460518,188.6290515687516,203.77836040826128,218.6109532165435,232.91655561767115,246.48344456895327,259.10435364110873,270.5790486173039,280.72117475870624,289.36349304127845,296.3609817496877,301.59394575492485,304.97224667111163,306.4395029905852,305.9739943190551,303.5874174404594,299.3267627081128,293.27245171359556,285.536534346174,276.2602282751813,265.6080256171602,253.76444325633744,240.92892477039481,227.31159289337805,213.124292696704,198.57706366437472,183.8744155596498,169.20810087772358,154.75453205778922,140.67223395134587,127.09891124460793,114.1482691836151,101.90971844876296,90.44992355130039,79.81385979613012,70.02518531253794,61.0890681541453,52.99728478830055,45.728334213474284,39.249376225706854,33.51844810076488,28.4866971380872,24.100522783666356,20.303558140542577,17.03844135316003,14.248344065101119,11.878239029872347,9.875902259766091,8.19265664495935,6.783873523877954,5.609256065627096,4.632933476387954,3.823398023199694,3.153317848100385,2.599257779212199,2.141338151913806,1.7628583868378724,1.449908094286576,1.1909841327719017,0.9766276525374623,0.7990909620117885,0.6520402653648474,0.5302970690081237,0.4296184193609072,0.34651413407084086,0.27809779897960757,0.22196746355008626,0.176111594985752,0.13883585036005922,0.10870649863182434,0.08450677765647908,0.0652030234123736,0.04991799241488714,0.03790936252699069,0.028551906849131795,0.02132226930321974,0.015785620289218514,0.01158373718805251,0.008424244924640334,0.006070877697206925,0.0043346975244548955,0.0030662417028952406,0.0021485816906056244,0.0014912705295182605,0.0010251426623290173,0.0006979146396452052,0.00047052149690443915,0.00031411357572778796,0.00020763307393281138,0.00013588853888450104,8.80482301226948e-05,5.6478865353710716e-05,3.586374961741967e-05,2.254277668271243e-05,1.402553080879443e-05,8.637143082523835e-06,5.264280316623626e-06,3.1754520659887932e-06,1.895612995213014e-06,1.1198286074431962e-06,6.546235636051278e-07,3.786610659517464e-07,2.1672521597793095e-07,1.2272956155356953e-07,6.876237421238329e-08,3.8115010738692944e-08,2.0900965864711906e-08,1.1338186141074403e-08,6.084251253923867e-09,3.2295702112605798e-09,1.6956346371443943e-09,8.805727702565492e-10,4.5224282985145695e-10,2.297463197464822e-10,1.1541942512849346e-10,5.735500963055529e-11,2.8159092835267074e-11,1.36969902087003e-11,6.5779204305727034e-12,3.1440094971912914e-12,1.4711076801177114e-12,6.787104211980477e-13,3.1661784305470066e-13,1.6001422409317456e-13,6.480149750132114e-14,5.0164317144663077e-14,2.2595258997171187e-14,2.9416469260468145e-14,6.8212102632969615e-15,2.398081733190338e-14,1.2887468869848817e-14,2.312816604899126e-14,-1.0658141036401502e-16,1.5560885913146194e-14,2.4087398742267397e-14,2.1600499167107046e-14,1.0587086762825493e-14,1.2150280781497713e-14,2.5579538487363606e-15,1.3500311979441904e-14,1.3322676295501878e-14,2.538413923502958e-14,2.071232074740692e-14,2.149391775674303e-14,1.0720313525780512e-14,2.504663143554353e-14,2.468247828346648e-14,1.63202784619898e-14,-3.796962744218036e-15,1.4206413823103504e-14,2.411182364880915e-14,1.055822096418524e-14,1.1948220191015935e-14,2.283506717049022e-14,-2.0902168884617823e-14,-3.0714319976254955e-15,-1.5916157281026246e-14,1.3642420526593923e-14,-4.547473508864641e-15,-4.547473508864641e-15,-9.094947017729283e-15,4.547473508864641e-15,-1.1368683772161604e-14,-1.3642420526593923e-14,-3.637978807091713e-14,-1.3642420526593923e-14,-5.0022208597511053e-14,-2.2737367544323207e-14,-1.8189894035458565e-14,-1.3642420526593923e-14,-1.3642420526593923e-14,-3.637978807091713e-14,-1.8189894035458565e-14,-1.3642420526593923e-14,-2.7284841053187846e-14,-9.094947017729283e-15,-1.8189894035458565e-14,-2.7284841053187846e-14,-9.094947017729283e-15,-2.2737367544323207e-14,-1.8189894035458565e-14,-1.3642420526593923e-14,-2.2737367544323207e-14,-1.8189894035458565e-14,-2.7284841053187846e-14,-2.2737367544323206e-15,-4.547473508864641e-15,-1.1368683772161604e-14,-4.547473508864641e-15,-2.7284841053187846e-14,-1.8189894035458565e-14,-1.8189894035458565e-14,-3.4106051316484808e-15,-1.9326762412674726e-14,-1.3642420526593923e-14,-1.1368683772161604e-14,1.4779288903810084e-14,-3.183231456205249e-14,-9.094947017729283e-15,-5.115907697472721e-15,2.2737367544323207e-14,-1.2505552149377763e-14,-1.0800249583553523e-14,-5.968558980384841e-15,1.5916157281026246e-14,-5.542233338928782e-15,-6.963318810448982e-15,4.405364961712621e-15,1.0231815394945442e-14,6.927791673660977e-15,-7.549516567451064e-16,-6.430411758628907e-15,1.751487843648647e-14,-2.0818902157770937e-14,3.481659405224491e-15,-1.5205614545266145e-14,2.891908934543608e-14,-7.034373084024992e-15,1.1368683772161603e-15,-3.552713678800501e-15,1.936228954946273e-14,1.497468815614411e-14,-1.673328142715036e-14,8.633094239485218e-15,3.134381643121742e-14,1.474376176702208e-14,2.6476598691260735e-14,7.553957459549566e-15,2.7671198665757403e-14,-2.8377300509419004e-15,2.1362911439837264e-14,-1.055822096418524e-14,1.5336620862171914e-14,-1.1466383398328617e-14,1.635469537575318e-14,7.618905506490137e-15,3.637978807091713e-14,1.8189894035458565e-14,2.7284841053187846e-14,9.094947017729283e-15,3.637978807091713e-14,1.8189894035458565e-14,0.0,1.8189894035458565e-14,3.637978807091713e-14,3.637978807091713e-14,0.0,3.637978807091713e-14,5.456968210637569e-14,0.0,1.8189894035458565e-14,3.637978807091713e-14,5.456968210637569e-14,3.637978807091713e-14,5.456968210637569e-14,1.8189894035458565e-14,3.637978807091713e-14,3.637978807091713e-14,3.637978807091713e-14,3.637978807091713e-14,3.637978807091713e-14,3.637978807091713e-14,0.0,1.8189894035458565e-14,1.8189894035458565e-14,1.8189894035458565e-14,1.8189894035458565e-14,0.0,0.0,2.7284841053187846e-14,1.8189894035458565e-14,1.8189894035458565e-14,1.8189894035458565e-14,2.7284841053187846e-14,3.183231456205249e-14,1.3642420526593923e-14,4.547473508864641e-15,1.8189894035458565e-14,1.8189894035458565e-14,2.2737367544323207e-14,1.3642420526593923e-14,2.2737367544323207e-14,2.2737367544323206e-15,-4.547473508864641e-15,-2.2737367544323206e-15,2.7284841053187846e-14,9.094947017729283e-15,1.6484591469634323e-14,2.842170943040401e-15,2.5011104298755527e-14,1.3642420526593923e-14,1.5631940186722205e-14,-9.663381206337363e-15,2.1600499167107046e-14,1.3073986337985844e-14,2.4726887204451486e-14,-3.836930773104541e-15,-6.252776074688882e-15,-7.531752999057062e-15,4.405364961712621e-15,4.405364961712621e-15,8.384404281969182e-15,2.1671553440683055e-15,1.403321903126198e-14,-1.2576606422953773e-14,3.481659405224491e-15,4.298783551348606e-15,2.8954616482224085e-15,-1.261213355974178e-14,-1.5454304502782179e-15,-4.387601393318619e-15,4.054534485931072e-15,-1.1439738045737614e-14,-2.9132252166164105e-14,-6.932232565759478e-15],"type":"scatter"},{"name":"Rpd=lowpass(Rpd)","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149],"y":[0.005696082743394559,0.0035134430625545377,0.00047444051611502183,-0.0032770187547810983,-0.0074895146895791395,-0.01180796539623484,-0.015789125564385137,-0.018929377957408317,-0.020704243546531616,-0.020617619941838437,-0.018257262610387973,-0.013351598754534337,-0.005821785040275938,0.004177824906085453,0.016237767468178357,0.029696435184495856,0.043672733663497026,0.05713082476742637,0.06897609962248025,0.07817761884618746,0.08390800472244597,0.08568760823708083,0.08351626399576456,0.0779737574203464,0.07027000463537388,0.0622285930850397,0.056193128152237974,0.054854396402546635,0.06100637288447134,0.07724877851559778,0.10566180844706004,0.1474842333245859,0.20282942815541197,0.2704752072672914,0.3477623718675351,0.4306327512059961,0.5138293005068102,0.5912681862463482,0.6565762232026187,0.7037675960416341,0.7280132581923691,0.7264375997637853,0.6988635917856539,0.648422804027594,0.5819516752773938,0.5101092756995386,0.44717246133641575,0.41048953282706185,0.4196013950952602,0.49506862277947267,0.6570734264484797,0.9238969977548478,1.3104034244278062,1.826687407756275,2.4770588378426397,3.2595370725328854,4.166006580048694,5.183140525808793,6.294130827032658,7.481178460654638,8.728607698409789,10.02638606265678,11.373769990284204,12.782760966351319,14.281048528515276,15.914131714488455,17.74634612425833,19.860578728751825,22.356527016817015,25.34745295513388,28.95549419589234,33.305720313566276,38.51924917347144,44.705848689525624,51.95652068401789,60.336582309407646,69.87972733406842,80.5834790968239,92.40635886302296,105.26700233115628,119.0453658807566,133.58606202887617,148.70373166642514,164.19018692743865,179.82285438626226,195.37385071710116,210.61887849098113,225.34507778113004,239.3570395158302,252.4803992060272,264.5627797092474,275.47228921698155,285.09421541097936,293.32688822124516,300.0778320180713,305.2612520455017,308.7976073408952,310.6155750080607,310.6562123672647,308.8786898923025,305.26669000691743,299.83448430129516,292.63179724965164,283.74678274302346,273.3067160569183,261.4762814251134,248.45356915301244,234.46406034056332,219.7529764629859,204.57643505434103,189.19190955699287,173.84854432145372,158.7779069984161,144.1857530129115,130.24532773540574,117.09264720857297,104.82407829578248,93.49637576735591,83.12912428195983,73.70929761460944,65.1974301211293,57.53474413105691,50.650519105549925,44.46902421391482,38.91544933099709,33.92044014606262,29.42304865746953,25.372121044008704,21.72632484437856,18.453136793601715,15.527160855719007,12.928132579851061,10.638911436753867,8.643688287743586,6.926556369817013,5.470520213132774,4.256951771663121,3.2654496412304006,2.4740200263241534,1.8594813698351782,1.3979981300012878,1.0656670303931957,0.8391021635788961,0.695985713622557,0.6155645446745032,0.5790791765321504,0.5701131600681547,0.5748509041781557,0.5822331365181004,0.5840022875125892,0.5746346727305188,0.5511615890452879,0.5128870350895253,0.46101596228562697,0.39821394179107994,0.3281262971252903,0.25489045944545546,0.18267747343263444,0.11529589247670292,0.055883978458730874,0.006705723592739643,-0.030945213101996036,-0.05674020773554694,-0.07122417239657097,-0.0756588921627164,-0.07182517273584851,-0.06180794034551153,-0.04778627055903579,-0.031846425461134614,-0.015831015758033442,-0.0012320283657437602,0.010869751755804376,0.01982098412953865,0.025373380356135535,0.02763089781057878,0.026976097396786445,0.023985509874160336,0.019343192078092406,0.013760279382044554,0.007906499263776068,0.0023575482473133427,-0.0024398260254147523,-0.006185069714908169,-0.008724978090146577,-0.010041489770391713,-0.010229554858604247,-0.009468791934001788,-0.007992550923015594,-0.006057596866460503,-0.003917011877841841,-0.0017981714805166344,0.00011312560324582307,0.0016820328049513469,0.002827834164652432,0.0035217250469061706,0.0037803366912383383,0.003656326932829804,0.0032273905933812557,0.002584947912091038,0.001823578478636392,0.0010320151926144557,0.0002862312119284212,-0.00035512719580932096,-0.0008529627705357317,-0.0011878146515589675,-0.0013581754587943785,-0.0013774971433688063,-0.0012703818183916395,-0.001068440093628624,-0.0008062450180331822,-0.0005177265473527903,-0.00023325194981868537,2.2466522127162498e-05,0.00023159393254482081,0.0003835673760269164,0.0004747721009214403,0.0005076532492444628,0.0004894409702392027,0.00043067022424599186,0.00034366333052687016,0.00024111734500592937,0.00013490421687979435,3.51538413306123e-05,-5.034737622165808e-05,-0.0001164437072573843,-0.00016061216101203714,-0.00018272894172331077,-0.0001846622437387149,-0.0001697580449653105,-0.00014228349904790575,-0.00010688505337023929,-6.810714496702548e-05,-3.0003919958404442e-05,4.137546308059783e-06,3.195723548912313e-05,5.207144467167285e-05,6.402621932329064e-05,6.817582751072252e-05,6.55102022041351e-05,5.7455667118238274e-05,4.567140973241031e-05,3.186062893530114e-05,1.7610673777053115e-05,4.271403462771497e-06,-7.124025652099878e-06,-1.589626455580286e-05,-2.171879311334005e-05,-2.4585585276949107e-05,-2.4755773753206973e-05,-2.2684268406166645e-05,-1.8946976733179967e-05,-1.4168249377113796e-05,-8.956645878023733e-06,-3.8533098137540685e-06,7.04631973804896e-07,4.40499480813438e-06,7.066649211589055e-06,8.632857616569124e-06,9.154657509719565e-06,8.76751107918705e-06,7.664481759448759e-06,6.068940032898549e-06,4.209319520408235e-06,2.2978217072924673e-06,5.142838864450909e-07,-1.004248200877392e-06,-2.1683057011839e-06,-2.9356958825416295e-06,-3.3070287857980914e-06,-3.3181984580794656e-06,-3.031021626862872e-06,-2.523191695158458e-06,-1.878565337855688e-06,-1.178591980657407e-06,-4.954531082055644e-07,1.1277325489527922e-07,6.048435024908359e-07,9.570974161706617e-07,1.1625035622132737e-06,1.2283833758865035e-06,1.1732478126403034e-06,1.023184320987904e-06,8.081959811629599e-07,5.588290787265618e-07,3.0334114813761474e-07,6.556938096084674e-08,-1.3643116611184914e-07,-2.909911361828465e-07,-3.927497592076489e-07,-4.42022279910448e-07,-4.437654255614662e-07,-4.0630412750430634e-07,-3.3997618394335603e-07,-2.5583214082399356e-07,-1.6449928602459021e-07,-7.528532807937828e-08,4.437164900327783e-09,6.955692801359851e-08,1.1728000249312104e-07,1.4695644420362993e-07],"type":"scatter"},{"name":"Rpd=conv(deconv(Rpd))","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149],"y":[-4.547473508864641e-15,0.0,-9.094947017729283e-15,1.8189894035458565e-14,-1.8189894035458565e-14,0.0,-9.094947017729283e-15,9.094947017729283e-15,-1.8189894035458565e-14,0.0,0.0,0.0,0.0,-1.8189894035458565e-14,1.8189894035458565e-14,1.8189894035458565e-14,0.0,1.8189894035458565e-14,-1.8189894035458565e-14,1.8189894035458565e-14,0.0010044631988785112,0.004936816669523978,0.012496926434232591,0.02307288565851195,0.034963056211345246,0.04755426312438431,0.06042101846694095,0.07319879759914329,0.08555723851601214,0.09719444664882758,0.10783859664922602,0.11725228681900263,0.1252376137238025,0.13164084977149287,0.13635603188408824,0.13932702218522536,0.14054778817144326,0.1400608074567208,0.13795364227960363,0.13435385240761208,0.1314314450292977,0.13522928818942545,0.15421230303815264,0.19956345019493937,0.28260602054125683,0.41229514289278996,0.5961101859585051,0.8401354765988026,1.1461512346380618,1.5127799075725676,1.9350039888157318,2.404596704004657,2.9096896574843787,3.4373574963494598,3.9751823709953875,4.511546114481806,5.037725741928625,5.549888865097196,6.050711085599813,6.550674391009259,7.06994443972107,7.637945742093573,8.296482006620588,9.098531788304603,10.106532131894813,11.393503791280045,13.040059224846395,15.132136757475644,17.758841714765254,21.00946819324521,24.97160876224282,29.72563609332622,35.3435204814849,41.88533113377417,49.396185681736824,57.904819233872075,67.41892957133864,77.92519836619495,89.38828081472131,101.74937130038276,114.92649337417053,128.81454089483458,143.28595800779163,158.19300093325566,173.36851351460518,188.6290515687516,203.77836040826128,218.6109532165435,232.91655561767115,246.48344456895327,259.10435364110873,270.5790486173039,280.72117475870624,289.36349304127845,296.3609817496877,301.59394575492485,304.97224667111163,306.4395029905852,305.9739943190551,303.5874174404594,299.3267627081128,293.27245171359556,285.536534346174,276.2602282751813,265.6080256171602,253.76444325633744,240.92892477039481,227.31159289337805,213.124292696704,198.57706366437472,183.8744155596498,169.20810087772358,154.75453205778922,140.67223395134587,127.09891124460793,114.1482691836151,101.90971844876296,90.44992355130039,79.81385979613012,70.02518531253794,61.0890681541453,52.99728478830055,45.728334213474284,39.249376225706854,33.51844810076488,28.4866971380872,24.100522783666356,20.303558140542577,17.03844135316003,14.248344065101119,11.878239029872347,9.875902259766091,8.19265664495935,6.783873523877954,5.609256065627096,4.632933476387954,3.823398023199694,3.153317848100385,2.599257779212199,2.141338151913806,1.7628583868378724,1.449908094286576,1.1909841327719017,0.9766276525374623,0.7990909620117885,0.6520402653648474,0.5302970690081237,0.4296184193609072,0.34651413407084086,0.27809779897960757,0.22196746355008626,0.176111594985752,0.13883585036005922,0.10870649863182434,0.08450677765647908,0.0652030234123736,0.04991799241488714,0.03790936252699069,0.028551906849131795,0.02132226930321974,0.015785620289218514,0.01158373718805251,0.008424244924640334,0.006070877697206925,0.0043346975244548955,0.0030662417028952406,0.0021485816906056244,0.0014912705295182605,0.0010251426623290173,0.0006979146396452052,0.00047052149690443915,0.00031411357572778796,0.00020763307393281138,0.00013588853888450104,8.80482301226948e-05,5.6478865353710716e-05,3.586374961741967e-05,2.254277668271243e-05,1.402553080879443e-05,8.637143082523835e-06,5.264280316623626e-06,3.1754520659887932e-06,1.895612995213014e-06,1.1198286074431962e-06,6.546235636051278e-07,3.786610659517464e-07,2.1672521597793095e-07,1.2272956155356953e-07,6.876237421238329e-08,3.8115010738692944e-08,2.0900965864711906e-08,1.1338186141074403e-08,6.084251253923867e-09,3.2295702112605798e-09,1.6956346371443943e-09,8.805727702565492e-10,4.5224282985145695e-10,2.297463197464822e-10,1.1541942512849346e-10,5.735500963055529e-11,2.8159092835267074e-11,1.36969902087003e-11,6.5779204305727034e-12,3.1440094971912914e-12,1.4711076801177114e-12,6.787104211980477e-13,3.1661784305470066e-13,1.6001422409317456e-13,6.480149750132114e-14,5.0164317144663077e-14,2.2595258997171187e-14,2.9416469260468145e-14,6.8212102632969615e-15,2.398081733190338e-14,1.2887468869848817e-14,2.312816604899126e-14,-1.0658141036401502e-16,1.5560885913146194e-14,2.4087398742267397e-14,2.1600499167107046e-14,1.0587086762825493e-14,1.2150280781497713e-14,2.5579538487363606e-15,1.3500311979441904e-14,1.3322676295501878e-14,2.538413923502958e-14,2.071232074740692e-14,2.149391775674303e-14,1.0720313525780512e-14,2.504663143554353e-14,2.468247828346648e-14,1.63202784619898e-14,-3.796962744218036e-15,1.4206413823103504e-14,2.411182364880915e-14,1.055822096418524e-14,1.1948220191015935e-14,2.283506717049022e-14,-2.0902168884617823e-14,-3.0714319976254955e-15,-1.5916157281026246e-14,1.3642420526593923e-14,-4.547473508864641e-15,-4.547473508864641e-15,-9.094947017729283e-15,4.547473508864641e-15,-1.1368683772161604e-14,-1.3642420526593923e-14,-3.637978807091713e-14,-1.3642420526593923e-14,-5.0022208597511053e-14,-2.2737367544323207e-14,-1.8189894035458565e-14,-1.3642420526593923e-14,-1.3642420526593923e-14,-3.637978807091713e-14,-1.8189894035458565e-14,-1.3642420526593923e-14,-2.7284841053187846e-14,-9.094947017729283e-15,-1.8189894035458565e-14,-2.7284841053187846e-14,-9.094947017729283e-15,-2.2737367544323207e-14,-1.8189894035458565e-14,-1.3642420526593923e-14,-2.2737367544323207e-14,-1.8189894035458565e-14,-2.7284841053187846e-14,-2.2737367544323206e-15,-4.547473508864641e-15,-1.1368683772161604e-14,-4.547473508864641e-15,-2.7284841053187846e-14,-1.8189894035458565e-14,-1.8189894035458565e-14,-3.4106051316484808e-15,-1.9326762412674726e-14,-1.3642420526593923e-14,-1.1368683772161604e-14,1.4779288903810084e-14,-3.183231456205249e-14,-9.094947017729283e-15,-5.115907697472721e-15,2.2737367544323207e-14,-1.2505552149377763e-14,-1.0800249583553523e-14,-5.968558980384841e-15,1.5916157281026246e-14,-5.542233338928782e-15,-6.963318810448982e-15,4.405364961712621e-15,1.0231815394945442e-14,6.927791673660977e-15,-7.549516567451064e-16,-6.430411758628907e-15,1.751487843648647e-14,-2.0818902157770937e-14,3.481659405224491e-15,-1.5205614545266145e-14],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(237,237,237)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(51,51,51)"},"error_y":{"color":"rgb(51,51,51)"},"marker":{"line":{"color":"rgb(237,237,237)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(51,51,51)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(51,51,51)"},"baxis":{"endlinecolor":"rgb(51,51,51)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(51,51,51)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"colorscale":{"sequential":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"sequentialminus":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]]},"colorway":["#F8766D","#A3A500","#00BF7D","#00B0F6","#E76BF3"],"font":{"color":"rgb(51,51,51)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"rgb(237,237,237)","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","paper_bgcolor":"white","plot_bgcolor":"rgb(237,237,237)","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"},"bgcolor":"rgb(237,237,237)","radialaxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"rgb(237,237,237)","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"rgb(237,237,237)","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"rgb(237,237,237)","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","zerolinecolor":"white"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"},"baxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"},"bgcolor":"rgb(237,237,237)","caxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"}},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","title":{"standoff":15},"zerolinecolor":"white"},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","title":{"standoff":15},"zerolinecolor":"white"}}},"title":{"text":"$\\text{Actual } I_{pd} \\text{ vs. deconvolution of } R_{pd}$","x":0.5,"xanchor":"center"},"height":500,"xaxis":{"title":{"text":"Day"}},"yaxis":{"title":{"text":"Count"}}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('20155d4d-1e40-413c-8688-1b827dd6c8d5');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>Again our algorithm works nicely.</p>
</section>
</section>
<section id="discussion" class="level1">
<h1>Discussion</h1>
<p>There are a lot of papers and research done in the field of deconvolution in general but I have found only one using it in epidemic models (link above).</p>
<p>The theory is skipped here but it is required if we want to use more advanced techniques. I may write another blog post with more details.</p>
<p>After doing this you might be left wondering, well what’s the point ?</p>
<p>A few things:</p>
<ul>
<li>If we have daily data of infectious <span class="math inline">\(I_{pd}\)</span> we can then use the deconvolution technique to find an approximation for <span class="math inline">\(E_{pd}\)</span></li>
<li>If we have a close estimate for <span class="math inline">\(E_{pd}\)</span> we can in turn estimate the value of <span class="math inline">\(\beta\)</span> or <span class="math inline">\(R\)</span></li>
<li>We can verify the robusteness of <span class="math inline">\(h_L\)</span> and <span class="math inline">\(h_I\)</span> against real world data and how these vary geographically in a pandemic</li>
</ul>
<p>These points will be studied a bit more in the next blog post.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>