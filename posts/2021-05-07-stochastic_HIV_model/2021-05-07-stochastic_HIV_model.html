<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jeffrey Post">
<meta name="dcterms.date" content="2020-05-07">
<meta name="description" content="Building a new stochastic SEIR model to deal with probability distributions">

<title>HIV modeling – Scattered Thoughts</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-b53751a350365c71b6c909e95f209ed1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-d4be639c637f3db3c684c66cefad7e0c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-ae2d0dcda2edce4ab590422bb373b64f.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script type="text/javascript">

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-166290391-2', 'auto');

ga('send', {
  hitType: 'pageview',
  'anonymizeIp': true,
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_SVG" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Scattered Thoughts</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https:/github.com/jeffufpost"> 
<span class="menu-text"><i class="fa-brands fa-github" aria-label="github"></i></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://renkulab.io/gitlab/jeffrey.post"> 
<span class="menu-text"><i class="fa-brands fa-gitlab" aria-label="gitlab"></i></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="mailto:contact@jeffreypost.dev"> 
<span class="menu-text"><i class="fa-solid fa-envelope" aria-label="envelope"></i></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">HIV modeling</h1>
                  <div>
        <div class="description">
          Building a new stochastic SEIR model to deal with probability distributions
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">probability distributions</div>
                <div class="quarto-category">modeling</div>
                <div class="quarto-category">SEIR</div>
                <div class="quarto-category">epidemiology</div>
                <div class="quarto-category">stochastic</div>
                <div class="quarto-category">HIV</div>
                <div class="quarto-category">AIDS</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Jeffrey Post </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">May 7, 2020</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#motivation-for-write-up" id="toc-motivation-for-write-up" class="nav-link active" data-scroll-target="#motivation-for-write-up">Motivation for write-up</a></li>
  <li><a href="#building-a-stochastic-model" id="toc-building-a-stochastic-model" class="nav-link" data-scroll-target="#building-a-stochastic-model">Building a stochastic model</a>
  <ul>
  <li><a href="#creating-the-initial-population-dataframe" id="toc-creating-the-initial-population-dataframe" class="nav-link" data-scroll-target="#creating-the-initial-population-dataframe">Creating the initial population dataframe</a></li>
  <li><a href="#building-the-model" id="toc-building-the-model" class="nav-link" data-scroll-target="#building-the-model">Building the model</a></li>
  </ul></li>
  <li><a href="#testing-the-model" id="toc-testing-the-model" class="nav-link" data-scroll-target="#testing-the-model">Testing the model</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p><img src="../my_icons/stochastic_SEIR.png" class="img-fluid"></p>
<section id="motivation-for-write-up" class="level2">
<h2 class="anchored" data-anchor-id="motivation-for-write-up">Motivation for write-up</h2>
<p>This is the 4th part of a multi-part series blog post on modeling in epidemiology (May 7th, 2021).</p>
<p>The COVID-19 pandemic has brought a lot of attention to study of epidemiology and more specifically to the various mathematical models that are used to inform public health policies. Everyone has been trying to understand the growth or slowing of new cases and trying to predict the necessary sanitary resources. This blog post attempts to explain the foundations for some of the most used models and enlighten the reader on two key points.</p>
<p>After introducing the concepts of compartmentalization and disease dynamics in the first blog post, the second part looked at a deterministic numerical solution for the SEIR model discussed, and the effects of the parameters <span class="math inline">\(\beta\)</span>, <span class="math inline">\(\sigma\)</span>, and <span class="math inline">\(\gamma\)</span> in parts 1 and 2.</p>
<p>Part 3 made the argument that most models ignore individual-level disease dynamics in favor of averaging population-level <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\gamma\)</span> parameters and showed some big discrepancies between actual COVID-19 probability distributions for those parameters and those used in research.</p>
<p>This 4th part is where I build a numerical SEIR model that takes into account these probability distributions in order to tweak the model as close to COVID-19 data as possible.</p>
</section>
<section id="building-a-stochastic-model" class="level2">
<h2 class="anchored" data-anchor-id="building-a-stochastic-model">Building a stochastic model</h2>
<p>As opposed to the deterministic model from Part 2, this model is going to focus on individual level disease dynamics to model the disease propagation.</p>
<p>The basic idea of this model is to have a dataframe with the number of rows equal to the population size (each individual is a row) and two columns: * State column to describe the state of each individual (S, E, I, or R) * Day column to save the day of transition of the individual into that state</p>
<p>However, the population-level rates of transmission still apply here i.e.&nbsp;a person goes from S → E following three points: 1. the number of contacts the person has per unit time (given by <span class="math inline">\(r\)</span>) 2. the chance a given contact is with an I - infectious individual (the higher thenumber of I, the higher the chance) 3. the chance of an S contracting the disease from a contact with an I (given by <span class="math inline">\(\rho\)</span>)</p>
<p>This is done stochastically.</p>
<p>Once a person becomes E, their progression is unique to them. This progression is calculated in advance for computational reason, but it allows to use the time ditributions we want.</p>
<div id="cell-6" class="cell" data-outputid="7398f02b-ce97-418f-d50a-eca16307f6ca" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#collapse_hide</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install plotly<span class="op">==</span><span class="fl">4.14.3</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> expon</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> gamma</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> weibull_min</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy.random <span class="im">import</span> default_rng</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> default_rng()</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's build a numerical solution</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> seir_model(init, parms, days):</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    S_0, E_0, I_0, R_0 <span class="op">=</span> init</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    Epd, Ipd, Rpd <span class="op">=</span> [<span class="dv">0</span>], [<span class="dv">0</span>], [<span class="dv">0</span>]</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    S, E, I, R <span class="op">=</span> [S_0], [E_0], [I_0], [R_0]</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    dt<span class="op">=</span><span class="fl">0.1</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> np.linspace(<span class="dv">0</span>,days,<span class="bu">int</span>(days<span class="op">/</span>dt))</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    sigma, beta, gam <span class="op">=</span> parms</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> t[<span class="dv">1</span>:]:</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>        next_S <span class="op">=</span> S[<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> beta<span class="op">*</span>S[<span class="op">-</span><span class="dv">1</span>]<span class="op">*</span>I[<span class="op">-</span><span class="dv">1</span>]<span class="op">*</span>dt</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>        Epd.append(beta<span class="op">*</span>S[<span class="op">-</span><span class="dv">1</span>]<span class="op">*</span>I[<span class="op">-</span><span class="dv">1</span>]<span class="op">*</span>dt)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>        next_E <span class="op">=</span> E[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> (beta<span class="op">*</span>S[<span class="op">-</span><span class="dv">1</span>]<span class="op">*</span>I[<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> sigma<span class="op">*</span>E[<span class="op">-</span><span class="dv">1</span>])<span class="op">*</span>dt</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>        Ipd.append(sigma<span class="op">*</span>E[<span class="op">-</span><span class="dv">1</span>]<span class="op">*</span>dt)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>        next_I <span class="op">=</span> I[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> (sigma<span class="op">*</span>E[<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> gam<span class="op">*</span>I[<span class="op">-</span><span class="dv">1</span>])<span class="op">*</span>dt</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        Rpd.append(gam<span class="op">*</span>I[<span class="op">-</span><span class="dv">1</span>]<span class="op">*</span>dt)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>        next_R <span class="op">=</span> R[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> (gam<span class="op">*</span>I[<span class="op">-</span><span class="dv">1</span>])<span class="op">*</span>dt</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>        S.append(next_S)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>        E.append(next_E)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>        I.append(next_I)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>        R.append(next_R)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.stack([S, E, I, R, Epd, Ipd, Rpd]).T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Collecting plotly==4.14.3
  Downloading https://files.pythonhosted.org/packages/1f/f6/bd3c17c8003b6641df1228e80e1acac97ed8402635e46c2571f8e1ef63af/plotly-4.14.3-py2.py3-none-any.whl (13.2MB)
     |████████████████████████████████| 13.2MB 303kB/s 
Requirement already satisfied: retrying&gt;=1.3.3 in /usr/local/lib/python3.7/dist-packages (from plotly==4.14.3) (1.3.3)
Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from plotly==4.14.3) (1.15.0)
Installing collected packages: plotly
  Found existing installation: plotly 4.4.1
    Uninstalling plotly-4.4.1:
      Successfully uninstalled plotly-4.4.1
Successfully installed plotly-4.14.3</code></pre>
</div>
</div>
<section id="creating-the-initial-population-dataframe" class="level3">
<h3 class="anchored" data-anchor-id="creating-the-initial-population-dataframe">Creating the initial population dataframe</h3>
<p>Below is a function to create the initial population dataframe: * <span class="math inline">\(p\)</span> is the population number * <span class="math inline">\(num_E\)</span> is the number of people exposed on day 0 * <span class="math inline">\(num_I\)</span> is the number of infectious on day 0 * <span class="math inline">\(num_R\)</span> is the number of people recovered on day 0</p>
<div id="cell-8" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#collapse_hide</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Need this new function for model below:</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> make_df(p, num_I, num_R):</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  df <span class="op">=</span> pd.DataFrame(np.full((p,<span class="dv">1</span>), <span class="st">'S'</span>).T[<span class="dv">0</span>], columns<span class="op">=</span>[<span class="st">'State'</span>])</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">'Year'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">'Age'</span>] <span class="op">=</span> (np.random.random(p)<span class="op">*</span><span class="dv">35</span><span class="op">+</span><span class="dv">15</span>).astype(<span class="bu">int</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  tochange<span class="op">=</span>df.loc[rng.choice(p, size<span class="op">=</span>num_I<span class="op">+</span>num_R, replace<span class="op">=</span><span class="va">False</span>),<span class="st">'State'</span>].index</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  df.loc[tochange[<span class="dv">0</span>:num_I],<span class="st">'State'</span>] <span class="op">=</span> <span class="st">'I'</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  df.loc[tochange[num_I:num_I<span class="op">+</span>num_R],<span class="st">'State'</span>] <span class="op">=</span> <span class="st">'R'</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="building-the-model" class="level3">
<h3 class="anchored" data-anchor-id="building-the-model">Building the model</h3>
<div id="cell-10" class="cell" data-outputid="c4ffb5fc-5872-44e5-8ff6-92c28721041b" data-execution_count="14">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#np.random.random(size=(p,days))</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#np.log(4)</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>j<span class="op">=</span><span class="dv">11</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>over <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#10/np.cumsum(np.ones(100))</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fl">0.05</span> <span class="op">+</span> (<span class="fl">0.3</span><span class="op">/</span>np.exp((j<span class="op">+</span><span class="dv">1</span><span class="op">-</span>over)<span class="op">/</span><span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>0.29561922592339457</code></pre>
</div>
</div>
<div id="cell-11" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#collapse_hide</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> seir_model_stoch(beta, beta2, p, num_I, num_R, years, T_Infectious, ART, control):</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize population dataframe with data given by user</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> make_df(p, num_I, num_R)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This variable is used to track daily value of beta if it varies over time</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    xxbeta<span class="op">=</span>np.array([],dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize the arrays to return</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Below are numbers of S, I, R total</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    S<span class="op">=</span>np.array([],dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    I<span class="op">=</span>np.array([],dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    R<span class="op">=</span>np.array([],dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Below are the daily additions in S, I, R</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    Spd<span class="op">=</span>np.array([],dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    Ipd<span class="op">=</span>np.array([],dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    Rpd<span class="op">=</span>np.array([],dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    b<span class="op">=</span>beta</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">#b2=beta[0]</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    b2<span class="op">=</span>np.array([],dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    b1<span class="op">=</span>b</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># signal diminshing beta</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    over <span class="op">=</span> <span class="dv">0</span> </span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># signal end of deaths due to ART</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    art1 <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>    art2 <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Stochastic model so use random values to decide on progression</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>    rand <span class="op">=</span> np.random.random(size<span class="op">=</span>(p,years))</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Depending if you want exponential, gamma, or Weibull distribution for T_Infectious</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Uses distributions found on blog part 3</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> T_Infectious <span class="op">==</span> <span class="st">'expon'</span>:</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>      ItoR <span class="op">=</span> expon.rvs(loc<span class="op">=</span><span class="dv">0</span>,scale<span class="op">=</span><span class="dv">10</span>,size<span class="op">=</span>p)</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> T_Infectious <span class="op">==</span> <span class="st">'gamma'</span>:</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>      ItoR <span class="op">=</span> gamma.rvs(<span class="dv">4</span>,loc<span class="op">=</span><span class="dv">3</span>,scale<span class="op">=</span><span class="dv">2</span>,size<span class="op">=</span>p)    </span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>      ItoR <span class="op">=</span> weibull_min.rvs(<span class="fl">2.3</span>, loc<span class="op">=</span><span class="dv">2</span>, scale<span class="op">=</span><span class="fl">20.11</span>, size<span class="op">=</span>p)</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Iterate over every day the simulation is run</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,years<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Record daily beta values</span></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>        xxbeta<span class="op">=</span>np.append(xxbeta, b[j])</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>        <span class="co"># First we get the index of the individuals that will change state today:</span></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Random number tells you which 'S' have been exposed on this day </span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>        <span class="co">#StoE_index = df.loc[(df.State == 'S') &amp; (rand[:,j] &lt; b[j]*len(np.where(df.State=='I')[0])/p)].index</span></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> ART <span class="op">&lt;</span> <span class="dv">2</span>:</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>          StoI_index <span class="op">=</span> df.loc[(df.State <span class="op">==</span> <span class="st">'S'</span>) <span class="op">&amp;</span> (df.Age <span class="op">&lt;</span> <span class="dv">49</span>) <span class="op">&amp;</span> (rand[:,j] <span class="op">&lt;</span> b[j]<span class="op">*</span><span class="bu">len</span>(np.where(df.State<span class="op">==</span><span class="st">'I'</span>)[<span class="dv">0</span>])<span class="op">/</span>(<span class="bu">len</span>(np.where(df.State<span class="op">==</span><span class="st">'I'</span>)[<span class="dv">0</span>])<span class="op">+</span><span class="bu">len</span>(np.where(df.State<span class="op">==</span><span class="st">'S'</span>)[<span class="dv">0</span>])))].index</span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>          StoS_index <span class="op">=</span> df.loc[(df.State <span class="op">==</span> <span class="st">'S'</span>) <span class="op">&amp;</span> (df.Age <span class="op">&lt;</span> <span class="dv">49</span>) <span class="op">&amp;</span> (rand[:,j] <span class="op">&lt;</span> b[j]<span class="op">*</span><span class="bu">len</span>(np.where(df.State<span class="op">==</span><span class="st">'I'</span>)[<span class="dv">0</span>])<span class="op">/</span>(<span class="bu">len</span>(np.where(df.State<span class="op">==</span><span class="st">'I'</span>)[<span class="dv">0</span>])<span class="op">+</span><span class="bu">len</span>(np.where(df.State<span class="op">==</span><span class="st">'S'</span>)[<span class="dv">0</span>])))].index</span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> ART <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> art2 <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>            StoI_index <span class="op">=</span> df.loc[(df.State <span class="op">==</span> <span class="st">'S'</span>) <span class="op">&amp;</span> (df.Age <span class="op">&lt;</span> <span class="dv">49</span>) <span class="op">&amp;</span> (rand[:,j] <span class="op">&lt;</span> b[j]<span class="op">*</span><span class="bu">len</span>(np.where(df.State<span class="op">==</span><span class="st">'I'</span>)[<span class="dv">0</span>])<span class="op">/</span>(<span class="bu">len</span>(np.where(df.State<span class="op">==</span><span class="st">'I'</span>)[<span class="dv">0</span>])<span class="op">+</span><span class="bu">len</span>(np.where(df.State<span class="op">==</span><span class="st">'S'</span>)[<span class="dv">0</span>])))].index</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>            StoS_index <span class="op">=</span> df.loc[(df.State <span class="op">==</span> <span class="st">'S'</span>) <span class="op">&amp;</span> (df.Age <span class="op">&lt;</span> <span class="dv">49</span>) <span class="op">&amp;</span> (rand[:,j] <span class="op">&lt;</span> b[j]<span class="op">*</span><span class="bu">len</span>(np.where(df.State<span class="op">==</span><span class="st">'I'</span>)[<span class="dv">0</span>])<span class="op">/</span>(<span class="bu">len</span>(np.where(df.State<span class="op">==</span><span class="st">'I'</span>)[<span class="dv">0</span>])<span class="op">+</span><span class="bu">len</span>(np.where(df.State<span class="op">==</span><span class="st">'S'</span>)[<span class="dv">0</span>])))].index</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>          <span class="cf">elif</span> art2 <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>            StoI_index <span class="op">=</span> df.loc[(df.State <span class="op">==</span> <span class="st">'S'</span>) <span class="op">&amp;</span> (df.Age <span class="op">&gt;</span> <span class="dv">55</span>)].index</span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>            StoS_index <span class="op">=</span> df.loc[(df.State <span class="op">==</span> <span class="st">'S'</span>) <span class="op">&amp;</span> (df.Age <span class="op">&lt;</span> <span class="dv">49</span>)].index</span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>        StoRem_index <span class="op">=</span> df.loc[(df.State <span class="op">==</span> <span class="st">'S'</span>) <span class="op">&amp;</span> (df.Age <span class="op">==</span> <span class="dv">49</span>)].index</span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>        <span class="co"># For each row, if a person has been a certain number of days in E, they will go to I</span></span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>        <span class="co"># This follows EtoI variable which is either exponential or gamma distributed according to above</span></span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>        <span class="co">#EtoI_index = df.loc[(df.State == 'E') &amp; (j-df.Day &gt;= EtoI)].index</span></span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Similaraly as above</span></span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>        <span class="co"># For each row, if a person has been a certain number of days in I, they will go to R</span></span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>        <span class="co"># This follows EtoI variable which is either exponential or gamma distributed according to above</span></span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>        ItoRem_index <span class="op">=</span> df.loc[(df.State <span class="op">==</span> <span class="st">'I'</span>) <span class="op">&amp;</span> (df.Age <span class="op">==</span> <span class="dv">49</span>)].index</span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> ART <span class="op">==</span> <span class="dv">0</span>: <span class="co">#don't use ART</span></span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a>          ItoR_index <span class="op">=</span> df.loc[(df.State <span class="op">==</span> <span class="st">'I'</span>) <span class="op">&amp;</span> (j<span class="op">-</span>df.Year <span class="op">&gt;=</span> ItoR) <span class="op">&amp;</span> (df.Age <span class="op">&lt;</span> <span class="dv">49</span>)].index</span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a>          ItoI_index <span class="op">=</span> df.loc[(df.State <span class="op">==</span> <span class="st">'I'</span>) <span class="op">&amp;</span> (j<span class="op">-</span>df.Year <span class="op">&lt;</span> ItoR) <span class="op">&amp;</span> (df.Age <span class="op">&lt;</span> <span class="dv">49</span>)].index</span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> ART <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> art2 <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a>            ItoR_index <span class="op">=</span> df.loc[(df.State <span class="op">==</span> <span class="st">'I'</span>) <span class="op">&amp;</span> (j<span class="op">-</span>df.Year <span class="op">&gt;=</span> ItoR) <span class="op">&amp;</span> (df.Age <span class="op">&lt;</span> <span class="dv">49</span>)].index</span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a>            ItoI_index <span class="op">=</span> df.loc[(df.State <span class="op">==</span> <span class="st">'I'</span>) <span class="op">&amp;</span> (j<span class="op">-</span>df.Year <span class="op">&lt;</span> ItoR) <span class="op">&amp;</span> (df.Age <span class="op">&lt;</span> <span class="dv">49</span>)].index</span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a>          <span class="cf">elif</span> art2 <span class="op">==</span><span class="dv">1</span>:</span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a>            ItoR_index <span class="op">=</span> df.loc[(df.State <span class="op">==</span> <span class="st">'I'</span>) <span class="op">&amp;</span> (df.Age <span class="op">&gt;</span> <span class="dv">49</span>)].index</span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a>            ItoI_index <span class="op">=</span> df.loc[(df.State <span class="op">==</span> <span class="st">'I'</span>) <span class="op">&amp;</span> (df.Age <span class="op">&lt;</span> <span class="dv">49</span>)].index            </span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a>        RtoRem_index <span class="op">=</span> df.loc[(df.State <span class="op">==</span> <span class="st">'R'</span>) <span class="op">&amp;</span> (df.Age <span class="op">==</span> <span class="dv">49</span>)].index</span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a>        RtoR_index <span class="op">=</span> df.loc[(df.State <span class="op">==</span> <span class="st">'R'</span>) <span class="op">&amp;</span> (df.Age <span class="op">&lt;</span> <span class="dv">49</span>)].index</span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Use indexes collected above to populate per day values</span></span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a>        <span class="co">#Epd = np.append(Epd,len(StoE_index))</span></span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a>        <span class="co">#Ipd = np.append(Ipd,len(EtoI_index))</span></span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a>        Ipd <span class="op">=</span> np.append(Ipd,<span class="bu">len</span>(StoI_index))</span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a>        Rpd <span class="op">=</span> np.append(Rpd,<span class="bu">len</span>(ItoR_index))</span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Now we use the indexes collected above randomly to change the actual population dataframe to the new states</span></span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a>        df.iloc[ItoRem_index] <span class="op">=</span> [<span class="st">'S'</span>, j, <span class="dv">15</span>]</span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a>        df.loc[ItoR_index, [<span class="st">'State'</span>,<span class="st">'Year'</span>]] <span class="op">=</span> [<span class="st">'S'</span>, j]</span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a>        df.loc[ItoR_index, <span class="st">'Age'</span>] <span class="op">=</span> df.loc[ItoR_index, <span class="st">'Age'</span>] <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb6-100"><a href="#cb6-100" aria-hidden="true" tabindex="-1"></a>        df.loc[ItoI_index, <span class="st">'Age'</span>] <span class="op">=</span> df.loc[ItoI_index, <span class="st">'Age'</span>] <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb6-101"><a href="#cb6-101" aria-hidden="true" tabindex="-1"></a>        df.iloc[StoRem_index] <span class="op">=</span> [<span class="st">'S'</span>, j, <span class="dv">15</span>]</span>
<span id="cb6-102"><a href="#cb6-102" aria-hidden="true" tabindex="-1"></a>        df.loc[StoI_index, [<span class="st">'State'</span>,<span class="st">'Year'</span>]] <span class="op">=</span> [<span class="st">'I'</span>, j]</span>
<span id="cb6-103"><a href="#cb6-103" aria-hidden="true" tabindex="-1"></a>        df.loc[StoI_index, <span class="st">'Age'</span>] <span class="op">=</span> df.loc[StoI_index, <span class="st">'Age'</span>] <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb6-104"><a href="#cb6-104" aria-hidden="true" tabindex="-1"></a>        df.loc[StoS_index, <span class="st">'Age'</span>] <span class="op">=</span> df.loc[StoS_index, <span class="st">'Age'</span>] <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb6-105"><a href="#cb6-105" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-106"><a href="#cb6-106" aria-hidden="true" tabindex="-1"></a>        df.iloc[RtoRem_index] <span class="op">=</span> [<span class="st">'S'</span>, j, <span class="dv">15</span>]</span>
<span id="cb6-107"><a href="#cb6-107" aria-hidden="true" tabindex="-1"></a>        df.loc[RtoR_index, <span class="st">'Age'</span>] <span class="op">=</span> df.loc[RtoR_index, <span class="st">'Age'</span>] <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb6-108"><a href="#cb6-108" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-109"><a href="#cb6-109" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-110"><a href="#cb6-110" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Append the S, I, and R arrays</span></span>
<span id="cb6-111"><a href="#cb6-111" aria-hidden="true" tabindex="-1"></a>        S<span class="op">=</span>np.append(S,<span class="bu">len</span>(np.where(df.State<span class="op">==</span><span class="st">'S'</span>)[<span class="dv">0</span>]))</span>
<span id="cb6-112"><a href="#cb6-112" aria-hidden="true" tabindex="-1"></a>        I<span class="op">=</span>np.append(I,<span class="bu">len</span>(np.where(df.State<span class="op">==</span><span class="st">'I'</span>)[<span class="dv">0</span>]))</span>
<span id="cb6-113"><a href="#cb6-113" aria-hidden="true" tabindex="-1"></a>        R<span class="op">=</span>np.append(R,<span class="bu">len</span>(np.where(df.State<span class="op">==</span><span class="st">'R'</span>)[<span class="dv">0</span>]))</span>
<span id="cb6-114"><a href="#cb6-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-115"><a href="#cb6-115" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Code below for control measures to reduce beta values</span></span>
<span id="cb6-116"><a href="#cb6-116" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> control <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb6-117"><a href="#cb6-117" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (I[<span class="op">-</span><span class="dv">1</span>]<span class="op">/</span>p <span class="op">&gt;</span> <span class="fl">0.015</span>):</span>
<span id="cb6-118"><a href="#cb6-118" aria-hidden="true" tabindex="-1"></a>            art1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb6-119"><a href="#cb6-119" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> over <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb6-120"><a href="#cb6-120" aria-hidden="true" tabindex="-1"></a>              over <span class="op">=</span> j</span>
<span id="cb6-121"><a href="#cb6-121" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-122"><a href="#cb6-122" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> art1 <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb6-123"><a href="#cb6-123" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> j <span class="op">&gt;</span> over <span class="op">+</span> <span class="dv">15</span>:    </span>
<span id="cb6-124"><a href="#cb6-124" aria-hidden="true" tabindex="-1"></a>            <span class="co">#if Ipd[-2] &gt; Ipd[-1]:</span></span>
<span id="cb6-125"><a href="#cb6-125" aria-hidden="true" tabindex="-1"></a>              art2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb6-126"><a href="#cb6-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-127"><a href="#cb6-127" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> over <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb6-128"><a href="#cb6-128" aria-hidden="true" tabindex="-1"></a>            <span class="co">#b = beta2+(b1/np.exp((j+3-over)/15))</span></span>
<span id="cb6-129"><a href="#cb6-129" aria-hidden="true" tabindex="-1"></a>            b <span class="op">=</span> beta2<span class="op">+</span>(b1<span class="op">/</span>np.exp((j<span class="op">+</span><span class="dv">1</span><span class="op">-</span>over)<span class="op">/</span><span class="dv">10</span>))</span>
<span id="cb6-130"><a href="#cb6-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-131"><a href="#cb6-131" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> control <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb6-132"><a href="#cb6-132" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (I[<span class="op">-</span><span class="dv">1</span>]<span class="op">/</span>p <span class="op">&gt;</span> <span class="fl">0.3</span>):</span>
<span id="cb6-133"><a href="#cb6-133" aria-hidden="true" tabindex="-1"></a>            art1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb6-134"><a href="#cb6-134" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> over <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb6-135"><a href="#cb6-135" aria-hidden="true" tabindex="-1"></a>              over <span class="op">=</span> j</span>
<span id="cb6-136"><a href="#cb6-136" aria-hidden="true" tabindex="-1"></a>              <span class="co">#print(over)</span></span>
<span id="cb6-137"><a href="#cb6-137" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-138"><a href="#cb6-138" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> art1 <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb6-139"><a href="#cb6-139" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> j <span class="op">&gt;</span> over <span class="op">+</span> <span class="dv">15</span>:    </span>
<span id="cb6-140"><a href="#cb6-140" aria-hidden="true" tabindex="-1"></a>            <span class="co">#if Ipd[-2] &gt; Ipd[-1]:</span></span>
<span id="cb6-141"><a href="#cb6-141" aria-hidden="true" tabindex="-1"></a>              art2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb6-142"><a href="#cb6-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-143"><a href="#cb6-143" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> over <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb6-144"><a href="#cb6-144" aria-hidden="true" tabindex="-1"></a>            <span class="co">#b = beta2+(b1/np.exp((j+3-over)/15))</span></span>
<span id="cb6-145"><a href="#cb6-145" aria-hidden="true" tabindex="-1"></a>            b <span class="op">=</span> beta2<span class="op">+</span>(b1<span class="op">/</span>np.exp((j<span class="op">+</span><span class="dv">1</span><span class="op">-</span>over)<span class="op">/</span><span class="dv">10</span>))</span>
<span id="cb6-146"><a href="#cb6-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-147"><a href="#cb6-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-148"><a href="#cb6-148" aria-hidden="true" tabindex="-1"></a>        xxbeta2 <span class="op">=</span> ((S[j<span class="op">-</span><span class="dv">1</span>]<span class="op">+</span>I[j<span class="op">-</span><span class="dv">1</span>])<span class="op">/</span>I[j<span class="op">-</span><span class="dv">1</span>])<span class="op">*</span>Ipd[j]<span class="op">/</span>S[j<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb6-149"><a href="#cb6-149" aria-hidden="true" tabindex="-1"></a>        <span class="co">#xxbeta2 = 0.5</span></span>
<span id="cb6-150"><a href="#cb6-150" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(xxbeta2)</span></span>
<span id="cb6-151"><a href="#cb6-151" aria-hidden="true" tabindex="-1"></a>        b2 <span class="op">=</span> np.append(b2, xxbeta2)</span>
<span id="cb6-152"><a href="#cb6-152" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb6-153"><a href="#cb6-153" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Epd[0]+=num_E</span></span>
<span id="cb6-154"><a href="#cb6-154" aria-hidden="true" tabindex="-1"></a>    Ipd[<span class="dv">0</span>]<span class="op">+=</span>num_I</span>
<span id="cb6-155"><a href="#cb6-155" aria-hidden="true" tabindex="-1"></a>    Rpd[<span class="dv">0</span>]<span class="op">+=</span>num_R</span>
<span id="cb6-156"><a href="#cb6-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-157"><a href="#cb6-157" aria-hidden="true" tabindex="-1"></a>    <span class="co">#return S,E,I,R, Epd, Ipd, Rpd, xxbeta</span></span>
<span id="cb6-158"><a href="#cb6-158" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> S, I, R, Spd, Ipd, Rpd, xxbeta, b2, over</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="testing-the-model" class="level2">
<h2 class="anchored" data-anchor-id="testing-the-model">Testing the model</h2>
<div id="cell-13" class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#collapse_hide</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Define parameters for stochastic model</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>days <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>num_E <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>num_I <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>num_R <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>beta_stoch <span class="op">=</span> <span class="fl">0.3</span><span class="op">*</span>np.ones(days)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>beta_stoch2 <span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Run 3 stochastic simulations</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>results_stoch1 <span class="op">=</span> seir_model_stoch(beta_stoch,beta_stoch2, p, num_I, num_R, years, <span class="st">'gamma'</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>results_stoch2 <span class="op">=</span> seir_model_stoch(beta_stoch, beta_stoch2, p, num_I, num_R, years, <span class="st">'gamma'</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>results_stoch3 <span class="op">=</span> seir_model_stoch(beta_stoch, beta_stoch2, p, num_I, num_R, years, <span class="st">'gamma'</span>, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>results_stoch4 <span class="op">=</span> seir_model_stoch(beta_stoch, beta_stoch2, p, num_I, num_R, years, <span class="st">'gamma'</span>, <span class="dv">0</span>, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-14" class="cell" data-outputid="9e7b0837-af39-4954-c37f-a36bc9695dae" data-execution_count="59">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>results_stoch1[<span class="dv">8</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>26</code></pre>
</div>
</div>
<div id="cell-15" class="cell" data-outputid="fbb17ebc-1431-45a6-8247-ad5dd4c56b8e" data-execution_count="60">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#collapse_hide</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure(data<span class="op">=</span>[    </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'Beta_stoch1'</span>, x<span class="op">=</span>np.arange(<span class="bu">len</span>(results_stoch1[<span class="dv">0</span>])), y<span class="op">=</span>results_stoch1[<span class="dv">6</span>], line<span class="op">=</span>{<span class="st">'dash'</span>:<span class="st">'dot'</span>,<span class="st">'color'</span>:<span class="st">'yellow'</span>}, legendgroup<span class="op">=</span><span class="st">"stoch1"</span>),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'Beta_meas1'</span>, x<span class="op">=</span>np.arange(<span class="bu">len</span>(results_stoch1[<span class="dv">0</span>])), y<span class="op">=</span>results_stoch1[<span class="dv">7</span>], line<span class="op">=</span>{<span class="st">'dash'</span>:<span class="st">'dot'</span>,<span class="st">'color'</span>:<span class="st">'yellow'</span>}, legendgroup<span class="op">=</span><span class="st">"stoch1"</span>),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'I_stoch1'</span>, x<span class="op">=</span>np.arange(<span class="bu">len</span>(results_stoch1[<span class="dv">0</span>])), y<span class="op">=</span>results_stoch1[<span class="dv">1</span>]<span class="op">/</span>p, line<span class="op">=</span>{<span class="st">'dash'</span>:<span class="st">'dot'</span>, <span class="st">'color'</span>:<span class="st">'red'</span>}, legendgroup<span class="op">=</span><span class="st">"stoch1"</span>),</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    go.Bar(name<span class="op">=</span><span class="st">'Ip_stoch1'</span>, x<span class="op">=</span>np.arange(<span class="bu">len</span>(results_stoch1[<span class="dv">0</span>])), y<span class="op">=</span>results_stoch1[<span class="dv">4</span>]<span class="op">*</span><span class="dv">10</span><span class="op">/</span>p, legendgroup<span class="op">=</span><span class="st">"stoch1"</span>),</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'R_stoch1'</span>, x<span class="op">=</span>np.arange(<span class="bu">len</span>(results_stoch1[<span class="dv">0</span>])), y<span class="op">=</span>results_stoch1[<span class="dv">2</span>]<span class="op">/</span>p, line<span class="op">=</span>{<span class="st">'dash'</span>:<span class="st">'dot'</span>, <span class="st">'color'</span>:<span class="st">'green'</span>}, legendgroup<span class="op">=</span><span class="st">"stoch1"</span>),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'Beta_stoch2'</span>, x<span class="op">=</span>np.arange(<span class="bu">len</span>(results_stoch2[<span class="dv">0</span>])), y<span class="op">=</span>results_stoch2[<span class="dv">6</span>], line<span class="op">=</span>{<span class="st">'dash'</span>:<span class="st">'dot'</span>,<span class="st">'color'</span>:<span class="st">'yellow'</span>}, legendgroup<span class="op">=</span><span class="st">"stoch2"</span>),</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'Beta_meas2'</span>, x<span class="op">=</span>np.arange(<span class="bu">len</span>(results_stoch2[<span class="dv">0</span>])), y<span class="op">=</span>results_stoch2[<span class="dv">7</span>], line<span class="op">=</span>{<span class="st">'dash'</span>:<span class="st">'dot'</span>,<span class="st">'color'</span>:<span class="st">'yellow'</span>}, legendgroup<span class="op">=</span><span class="st">"stoch2"</span>),</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'I_stoch2'</span>, x<span class="op">=</span>np.arange(<span class="bu">len</span>(results_stoch2[<span class="dv">0</span>])), y<span class="op">=</span>results_stoch2[<span class="dv">1</span>]<span class="op">/</span>p, line<span class="op">=</span>{<span class="st">'dash'</span>:<span class="st">'dot'</span>, <span class="st">'color'</span>:<span class="st">'red'</span>}, legendgroup<span class="op">=</span><span class="st">"stoch2"</span>),</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    go.Bar(name<span class="op">=</span><span class="st">'Ip_stoch2'</span>, x<span class="op">=</span>np.arange(<span class="bu">len</span>(results_stoch2[<span class="dv">0</span>])), y<span class="op">=</span>results_stoch2[<span class="dv">4</span>]<span class="op">*</span><span class="dv">10</span><span class="op">/</span>p, legendgroup<span class="op">=</span><span class="st">"stoch2"</span>),</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'R_stoch2'</span>, x<span class="op">=</span>np.arange(<span class="bu">len</span>(results_stoch2[<span class="dv">0</span>])), y<span class="op">=</span>results_stoch2[<span class="dv">2</span>]<span class="op">/</span>p, line<span class="op">=</span>{<span class="st">'dash'</span>:<span class="st">'dot'</span>, <span class="st">'color'</span>:<span class="st">'green'</span>}, legendgroup<span class="op">=</span><span class="st">"stoch2"</span>),</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'Beta_stoch3'</span>, x<span class="op">=</span>np.arange(<span class="bu">len</span>(results_stoch3[<span class="dv">0</span>])), y<span class="op">=</span>results_stoch3[<span class="dv">6</span>], line<span class="op">=</span>{<span class="st">'dash'</span>:<span class="st">'dot'</span>, <span class="st">'color'</span>:<span class="st">'yellow'</span>}, legendgroup<span class="op">=</span><span class="st">"stoch3"</span>),</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'Beta_meas3'</span>, x<span class="op">=</span>np.arange(<span class="bu">len</span>(results_stoch3[<span class="dv">0</span>])), y<span class="op">=</span>results_stoch3[<span class="dv">7</span>], line<span class="op">=</span>{<span class="st">'dash'</span>:<span class="st">'dot'</span>,<span class="st">'color'</span>:<span class="st">'yellow'</span>}, legendgroup<span class="op">=</span><span class="st">"stoch3"</span>),</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'I_stoch3'</span>, x<span class="op">=</span>np.arange(<span class="bu">len</span>(results_stoch3[<span class="dv">0</span>])), y<span class="op">=</span>results_stoch3[<span class="dv">1</span>]<span class="op">/</span>p, line<span class="op">=</span>{<span class="st">'dash'</span>:<span class="st">'dot'</span>, <span class="st">'color'</span>:<span class="st">'red'</span>}, legendgroup<span class="op">=</span><span class="st">"stoch3"</span>),</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    go.Bar(name<span class="op">=</span><span class="st">'Ip_stoch3'</span>, x<span class="op">=</span>np.arange(<span class="bu">len</span>(results_stoch3[<span class="dv">0</span>])), y<span class="op">=</span>results_stoch3[<span class="dv">4</span>]<span class="op">*</span><span class="dv">10</span><span class="op">/</span>p, legendgroup<span class="op">=</span><span class="st">"stoch3"</span>),</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'R_stoch3'</span>, x<span class="op">=</span>np.arange(<span class="bu">len</span>(results_stoch3[<span class="dv">0</span>])), y<span class="op">=</span>results_stoch3[<span class="dv">2</span>]<span class="op">/</span>p, line<span class="op">=</span>{<span class="st">'dash'</span>:<span class="st">'dot'</span>, <span class="st">'color'</span>:<span class="st">'green'</span>}, legendgroup<span class="op">=</span><span class="st">"stoch3"</span>),</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'Beta_stoch4'</span>, x<span class="op">=</span>np.arange(<span class="bu">len</span>(results_stoch4[<span class="dv">0</span>])), y<span class="op">=</span>results_stoch4[<span class="dv">6</span>], line<span class="op">=</span>{<span class="st">'dash'</span>:<span class="st">'dot'</span>, <span class="st">'color'</span>:<span class="st">'yellow'</span>}, legendgroup<span class="op">=</span><span class="st">"stoch4"</span>),</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'Beta_meas4'</span>, x<span class="op">=</span>np.arange(<span class="bu">len</span>(results_stoch4[<span class="dv">0</span>])), y<span class="op">=</span>results_stoch4[<span class="dv">7</span>], line<span class="op">=</span>{<span class="st">'dash'</span>:<span class="st">'dot'</span>,<span class="st">'color'</span>:<span class="st">'yellow'</span>}, legendgroup<span class="op">=</span><span class="st">"stoch4"</span>),</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'I_stoch4'</span>, x<span class="op">=</span>np.arange(<span class="bu">len</span>(results_stoch4[<span class="dv">0</span>])), y<span class="op">=</span>results_stoch4[<span class="dv">1</span>]<span class="op">/</span>p, line<span class="op">=</span>{<span class="st">'dash'</span>:<span class="st">'dot'</span>, <span class="st">'color'</span>:<span class="st">'red'</span>}, legendgroup<span class="op">=</span><span class="st">"stoch4"</span>),</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    go.Bar(name<span class="op">=</span><span class="st">'Ip_stoch4'</span>, x<span class="op">=</span>np.arange(<span class="bu">len</span>(results_stoch4[<span class="dv">0</span>])), y<span class="op">=</span>results_stoch4[<span class="dv">4</span>]<span class="op">*</span><span class="dv">10</span><span class="op">/</span>p, legendgroup<span class="op">=</span><span class="st">"stoch4"</span>),</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    go.Scatter(name<span class="op">=</span><span class="st">'R_stoch4'</span>, x<span class="op">=</span>np.arange(<span class="bu">len</span>(results_stoch4[<span class="dv">0</span>])), y<span class="op">=</span>results_stoch4[<span class="dv">2</span>]<span class="op">/</span>p, line<span class="op">=</span>{<span class="st">'dash'</span>:<span class="st">'dot'</span>, <span class="st">'color'</span>:<span class="st">'green'</span>}, legendgroup<span class="op">=</span><span class="st">"stoch4"</span>)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>    xaxis_title <span class="op">=</span> <span class="st">'Day'</span>,</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>    yaxis_title <span class="op">=</span> <span class="st">'Proportion of population'</span>,</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span>{</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">'text'</span>:<span class="vs">r'$\text{Effect of stochasticity on Deterministic SEIR model}$'</span>,</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">'x'</span>:<span class="fl">0.5</span>,</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>        <span class="st">'xanchor'</span>:<span class="st">'center'</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<meta charset="utf-8">

    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>                <div id="62db6d9a-5eea-4b36-82bb-33f726461efd" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("62db6d9a-5eea-4b36-82bb-33f726461efd")) {                    Plotly.newPlot(                        "62db6d9a-5eea-4b36-82bb-33f726461efd",                        [{"legendgroup": "stoch1", "line": {"color": "yellow", "dash": "dot"}, "name": "Beta_stoch1", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98], "y": [0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.32145122541078786, 0.29561922592339457, 0.27224546620451534, 0.2510960138106918, 0.23195919791379, 0.21464349082820794, 0.19897559113742286, 0.18479868923516646, 0.17197089792217973, 0.1603638323514327, 0.14986132510942385, 0.14035826357366063, 0.13175953791020378, 0.12397908918248195, 0.11693904804452895, 0.11056895539839662, 0.1048050572158204, 0.09958966646647596, 0.09487058576679053, 0.0906005849709838, 0.08673692847589456, 0.08324094750870016, 0.08007765311684113, 0.07721538598682376, 0.07462549958716964, 0.07228207346430016, 0.07016165382192494, 0.06824301878756539, 0.06650696601692217, 0.06493612051035919, 0.06351476071806735, 0.062228661193509865, 0.061064950220372005, 0.060011980988097825, 0.059059215026695554, 0.05819711673418777, 0.057417057941101815, 0.056711231556849685, 0.05607257343374132, 0.05549469166662026, 0.05497180262052838, 0.054498673046143316, 0.05407056770366028, 0.05368320197092053, 0.0533326989614727, 0.05301555072339008, 0.052728583130508745, 0.05246892411470601, 0.05223397492127731, 0.05202138409972564, 0.05182902396965469, 0.051654969326228234, 0.05149747817207307, 0.0513549742827838, 0.051226031431539226, 0.05110935911494488, 0.051003789637241385, 0.05090826642361275, 0.050821833445630515, 0.05074362565299991, 0.050672860315845746, 0.05060882919088872, 0.050550891433108674, 0.05049846718195218, 0.050451031757893276, 0.05040811041126437, 0.050369273570802044, 0.05033413254435344, 0.050302335628714556, 0.05027356458966636, 0.05024753147697977, 0.050223975742513007]}, {"legendgroup": "stoch1", "line": {"color": "yellow", "dash": "dot"}, "name": "Beta_meas1", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98], "y": [0.0, 0.0, 0.0, 0.0, 2.000200020002, 0.33343336334233603, 0.5002000800320128, 0.1667667267026883, 0.1429572129061772, 0.1429572129061772, 0.2859144258123544, 0.12510008006405124, 0.37530024019215374, 0.3640368041208966, 0.14305742324969242, 0.250400641025641, 0.15819530792716688, 0.20040080160320642, 0.40080160320641284, 0.4827850009841387, 0.25100401606425704, 0.3140072347266881, 0.3815231792673368, 0.24242145863715764, 0.3294455219320386, 0.34887453076375613, 0.29888425811366504, 0.39652489983615813, 0.30477772025441524, 0.24812615130534205, 0.2583244354916664, 0.23602013041397465, 0.24107907792233668, 0.21870763077812214, 0.19405951728993898, 0.16317606999622636, 0.1780682774394691, 0.15295686477361692, 0.11900082973055594, 0.11425245412684625, 0.1513607018194174, 0.11282670945694509, 0.1156602380663348, 0.09629578057889364, 0.09494933180631314, 0.10060188529905637, 0.10601744095893667, 0.0694315937297837, 0.07386771347769196, 0.06848291324138868, 0.08476837719079633, 0.06141449873486132, 0.06208464913225746, 0.06101741475964527, 0.05222721587707362, 0.07057532416128579, 0.08778960558748496, 0.05846143101890847, 0.0681453543732946, 0.0600029189655285, 0.0641641546400125, 0.060634551955189554, 0.056187396203818976, 0.04702928813049174, 0.05424091645452442, 0.04516926588056295, 0.07498207540559486, 0.039536370165855074, 0.061424787023511174, 0.07928604967828952, 0.04685645875284507, 0.04323957038398283, 0.04770423375074538, 0.06699862250832123, 0.04780121251189908, 0.050392267810427174, 0.047437014591625686, 0.0682708029670491, 0.05689233580587425, 0.05114326842465751, 0.07327510405064776, 0.051917948873600156, 0.07616866789819376, 0.0552835255093982, 0.04039614071430072, 0.045843189619101436, 0.050410340168975463, 0.07501623880934226, 0.06509557766683562, 0.06050571541309629, 0.059285959898976726, 0.021879501707476313, 0.04488298109169773, 0.026814935382709466, 0.06940720233911526, 0.05112474437627812, 0.04627146822607685, 0.04258653584082857, 0.057564144445707656]}, {"legendgroup": "stoch1", "line": {"color": "red", "dash": "dot"}, "name": "I_stoch1", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98], "y": [0.0001, 0.0001, 0.0001, 0.0001, 0.0003, 0.0004, 0.0006, 0.0007, 0.0007, 0.0007, 0.0008, 0.0008, 0.0011, 0.0014, 0.0016, 0.0019, 0.002, 0.002, 0.0027, 0.004, 0.0048, 0.0058, 0.0079, 0.0095, 0.0116, 0.0146, 0.0185, 0.0249, 0.0312, 0.0374, 0.0448, 0.053, 0.0619, 0.0704, 0.0792, 0.0867, 0.0954, 0.102, 0.1057, 0.109, 0.1129, 0.1142, 0.1177, 0.1155, 0.1145, 0.1139, 0.1119, 0.106, 0.1025, 0.0981, 0.0954, 0.0903, 0.0841, 0.079, 0.0734, 0.0698, 0.0679, 0.0643, 0.0603, 0.0579, 0.0559, 0.0526, 0.0492, 0.0464, 0.044, 0.0403, 0.0395, 0.0372, 0.0353, 0.0354, 0.0335, 0.0325, 0.0308, 0.0302, 0.0286, 0.0282, 0.0271, 0.0271, 0.0261, 0.0252, 0.0257, 0.0256, 0.026, 0.0254, 0.0246, 0.0244, 0.0232, 0.0236, 0.0237, 0.0242, 0.0234, 0.0228, 0.0229, 0.0221, 0.022, 0.0221, 0.0216, 0.0213, 0.0218]}, {"legendgroup": "stoch1", "name": "Ip_stoch1", "type": "bar", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98], "y": [0.001, 0.0, 0.0, 0.0, 0.002, 0.001, 0.002, 0.001, 0.001, 0.001, 0.002, 0.001, 0.003, 0.004, 0.002, 0.004, 0.003, 0.004, 0.008, 0.013, 0.01, 0.015, 0.022, 0.019, 0.031, 0.04, 0.043, 0.072, 0.074, 0.075, 0.093, 0.101, 0.121, 0.127, 0.127, 0.119, 0.141, 0.132, 0.109, 0.108, 0.147, 0.113, 0.117, 0.1, 0.097, 0.102, 0.107, 0.069, 0.07, 0.063, 0.075, 0.053, 0.051, 0.047, 0.038, 0.048, 0.057, 0.037, 0.041, 0.034, 0.035, 0.032, 0.028, 0.022, 0.024, 0.019, 0.029, 0.015, 0.022, 0.027, 0.016, 0.014, 0.015, 0.02, 0.014, 0.014, 0.013, 0.018, 0.015, 0.013, 0.018, 0.013, 0.019, 0.014, 0.01, 0.011, 0.012, 0.017, 0.015, 0.014, 0.014, 0.005, 0.01, 0.006, 0.015, 0.011, 0.01, 0.009, 0.012]}, {"legendgroup": "stoch1", "line": {"color": "green", "dash": "dot"}, "name": "R_stoch1", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98], "y": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, {"legendgroup": "stoch2", "line": {"color": "yellow", "dash": "dot"}, "name": "Beta_stoch2", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98], "y": [0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]}, {"legendgroup": "stoch2", "line": {"color": "yellow", "dash": "dot"}, "name": "Beta_meas2", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98], "y": [0.0, 1.000100010001, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null]}, {"legendgroup": "stoch2", "line": {"color": "red", "dash": "dot"}, "name": "I_stoch2", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98], "y": [0.0001, 0.0002, 0.0002, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, {"legendgroup": "stoch2", "name": "Ip_stoch2", "type": "bar", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98], "y": [0.001, 0.001, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, {"legendgroup": "stoch2", "line": {"color": "green", "dash": "dot"}, "name": "R_stoch2", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98], "y": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, {"legendgroup": "stoch3", "line": {"color": "yellow", "dash": "dot"}, "name": "Beta_stoch3", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98], "y": [0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.32145122541078786, 0.29561922592339457, 0.27224546620451534, 0.2510960138106918, 0.23195919791379, 0.21464349082820794, 0.19897559113742286, 0.18479868923516646, 0.17197089792217973, 0.1603638323514327, 0.14986132510942385, 0.14035826357366063, 0.13175953791020378, 0.12397908918248195, 0.11693904804452895, 0.11056895539839662, 0.1048050572158204, 0.09958966646647596, 0.09487058576679053, 0.0906005849709838, 0.08673692847589456, 0.08324094750870016, 0.08007765311684113, 0.07721538598682376, 0.07462549958716964, 0.07228207346430016, 0.07016165382192494, 0.06824301878756539, 0.06650696601692217, 0.06493612051035919, 0.06351476071806735, 0.062228661193509865, 0.061064950220372005, 0.060011980988097825, 0.059059215026695554, 0.05819711673418777, 0.057417057941101815, 0.056711231556849685, 0.05607257343374132, 0.05549469166662026, 0.05497180262052838, 0.054498673046143316, 0.05407056770366028, 0.05368320197092053, 0.0533326989614727, 0.05301555072339008, 0.052728583130508745, 0.05246892411470601, 0.05223397492127731, 0.05202138409972564, 0.05182902396965469, 0.051654969326228234, 0.05149747817207307, 0.0513549742827838, 0.051226031431539226, 0.05110935911494488, 0.051003789637241385, 0.05090826642361275]}, {"legendgroup": "stoch3", "line": {"color": "yellow", "dash": "dot"}, "name": "Beta_meas3", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98], "y": [0.0, 1.000100010001, 0.5001000200040008, 0.0, 0.33343336334233603, 0.0, 0.0, 0.0, 0.2501000400160064, 0.2001000500250125, 0.5002000800320128, 0.0, 0.2001000500250125, 0.7503001200480192, 0.5718288516247088, 0.7280736082417932, 0.21092707723622248, 0.31888336157728825, 0.3458304946413565, 0.2905778801551157, 0.2992789514975705, 0.4773928892329149, 0.3073987182703043, 0.26262626262626265, 0.3153223424135104, 0.31860007128676593, 0.3186174551386623, 0.25085897941213114, 0.2725355968653451, 0.24757781516364602, 0.31635802661343215, 0.31675762856274153, 0.28260659896266943, 0.28858618177560313, 0.3030058177117001, 0.2821716827872646, 0.2965679028339373, 0.3232282860600567, 0.32845769171664896, 0.29953821823292925, 0.3233418101144846, 0.30541811740272434, 0.30767591306847725, 0.27514808600622964, 0.2569561337737722, 0.24360015590409978, 0.20704930662557783, 0.20853462157809982, 0.17639870855155104, 0.15916078507125025, 0.15657119677723483, 0.15301174377150076, 0.1320019061075242, 0.13980187390592017, 0.13514809335000588, 0.10932767971557311, 0.11372595968698015, 0.09829356103977857, 0.09761746592251332, 0.09614134525777351, 0.09611806964014652, 0.08685865277770488, 0.08799134511359538, 0.07397336879288967, 0.07456590603401293, 0.06993234452250845, 0.06994489877352474, 0.07928860840445048, 0.06974084302731051, 0.059995061051748254, 0.062088666800427246, 0.06811032468261993, 0.05601068742874759, 0.05824936880983957, 0.06691066756773031, 0.05318795734890943, 0.06595070237064139, 0.047547636451848244, 0.06414473133769467, 0.05337644625149133, 0.05346322917904242, 0.06768553913839385, 0.05551343168428066, 0.0564454349967448, 0.050566827236067785, 0.055390686805417075, 0.053475989447850376, 0.060231550536259684, 0.05729448125805848, 0.05425850784947443, 0.05652358075470991, 0.04496309240057477, 0.036267363000036267, 0.05265715527993296, 0.054418152883371144, 0.051103425155967656, 0.05260391968484863, 0.04279580590727368, 0.05737813418050147]}, {"legendgroup": "stoch3", "line": {"color": "red", "dash": "dot"}, "name": "I_stoch3", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98], "y": [0.0001, 0.0002, 0.0003, 0.0003, 0.0004, 0.0004, 0.0004, 0.0004, 0.0005, 0.0004, 0.0006, 0.0005, 0.0004, 0.0007, 0.0011, 0.0019, 0.0022, 0.0029, 0.0038, 0.0047, 0.0059, 0.0082, 0.01, 0.0122, 0.0153, 0.0192, 0.0241, 0.0291, 0.0356, 0.0419, 0.0523, 0.0651, 0.0786, 0.0952, 0.1163, 0.1381, 0.1667, 0.2033, 0.2443, 0.2858, 0.3366, 0.3829, 0.429, 0.4695, 0.4996, 0.528, 0.54, 0.5476, 0.5427, 0.5302, 0.5186, 0.5019, 0.481, 0.4628, 0.4449, 0.4198, 0.3955, 0.3718, 0.3545, 0.3346, 0.3137, 0.295, 0.2796, 0.2615, 0.244, 0.2277, 0.2154, 0.2034, 0.1918, 0.1809, 0.172, 0.1619, 0.1518, 0.1451, 0.1399, 0.1329, 0.1278, 0.1226, 0.1191, 0.114, 0.1095, 0.1069, 0.1049, 0.1037, 0.1026, 0.0997, 0.0975, 0.0966, 0.0958, 0.0937, 0.0932, 0.091, 0.0874, 0.0865, 0.0856, 0.0852, 0.0842, 0.0816, 0.0815]}, {"legendgroup": "stoch3", "name": "Ip_stoch3", "type": "bar", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98], "y": [0.001, 0.001, 0.001, 0.0, 0.001, 0.0, 0.0, 0.0, 0.001, 0.001, 0.002, 0.0, 0.001, 0.003, 0.004, 0.008, 0.004, 0.007, 0.01, 0.011, 0.014, 0.028, 0.025, 0.026, 0.038, 0.048, 0.06, 0.059, 0.077, 0.085, 0.127, 0.157, 0.172, 0.209, 0.261, 0.29, 0.353, 0.449, 0.532, 0.553, 0.66, 0.682, 0.727, 0.674, 0.64, 0.609, 0.516, 0.518, 0.437, 0.395, 0.39, 0.382, 0.33, 0.349, 0.336, 0.27, 0.277, 0.235, 0.228, 0.22, 0.214, 0.187, 0.183, 0.149, 0.144, 0.129, 0.123, 0.134, 0.113, 0.093, 0.092, 0.097, 0.076, 0.075, 0.083, 0.064, 0.076, 0.053, 0.069, 0.056, 0.054, 0.066, 0.053, 0.053, 0.047, 0.051, 0.048, 0.053, 0.05, 0.047, 0.048, 0.038, 0.03, 0.042, 0.043, 0.04, 0.041, 0.033, 0.043]}, {"legendgroup": "stoch3", "line": {"color": "green", "dash": "dot"}, "name": "R_stoch3", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98], "y": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, {"legendgroup": "stoch4", "line": {"color": "yellow", "dash": "dot"}, "name": "Beta_stoch4", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98], "y": [0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]}, {"legendgroup": "stoch4", "line": {"color": "yellow", "dash": "dot"}, "name": "Beta_meas4", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98], "y": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null]}, {"legendgroup": "stoch4", "line": {"color": "red", "dash": "dot"}, "name": "I_stoch4", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98], "y": [0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, {"legendgroup": "stoch4", "name": "Ip_stoch4", "type": "bar", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98], "y": [0.001, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, {"legendgroup": "stoch4", "line": {"color": "green", "dash": "dot"}, "name": "R_stoch4", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98], "y": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}],                        {"template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "autotypenumbers": "strict", "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}, "title": {"text": "$\\text{Effect of stochasticity on Deterministic SEIR model}$", "x": 0.5, "xanchor": "center"}, "xaxis": {"title": {"text": "Day"}}, "yaxis": {"title": {"text": "Proportion of population"}}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('62db6d9a-5eea-4b36-82bb-33f726461efd');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>


</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = true;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/jeffreypost\.dev\/scattered-thoughts");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>